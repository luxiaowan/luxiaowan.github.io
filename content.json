{"meta":{"title":"ä¸²ä¸€ä¸²","subtitle":"æ–­èˆç¦»","description":null,"author":"cc","url":"http://luxiaowan.github.io","root":"/"},"pages":[{"title":"å‹æƒ…é“¾æ¥","date":"2019-10-21T15:42:43.000Z","updated":"2019-10-21T15:57:01.607Z","comments":true,"path":"links/index.html","permalink":"http://luxiaowan.github.io/links/index.html","excerpt":"","text":"æœ¬äººè¿˜æ²¡å‹é“¾ï¼Œå­¤ç‹¬å°å®¢"},{"title":"æ¨èä¹¦å•","date":"2019-10-21T15:38:29.000Z","updated":"2019-10-21T15:56:47.928Z","comments":true,"path":"books/index.html","permalink":"http://luxiaowan.github.io/books/index.html","excerpt":"","text":"ä¹¦å è´­ä¹°åœ°å€ JavaScriptæƒå¨æŒ‡å—ï¼ˆç¬¬6ç‰ˆï¼‰ JavaScripté«˜çº§ç¨‹åºè®¾è®¡ Javaç¼–ç¨‹æ€æƒ³ï¼ˆç¬¬4ç‰ˆï¼‰ javaå¹¶å‘ç¼–ç¨‹å®æˆ˜ Nettyæƒå¨æŒ‡å—ï¼ˆç¬¬2ç‰ˆï¼‰ Spring Bootå®æˆ˜ Springå¾®æœåŠ¡å®æˆ˜ Word Excel PPT 2016å…¥é—¨ä¸æé«˜ ç¼–ç¨‹ç ç‘ï¼ˆç¬¬2ç‰ˆï¼‰ æ“ä½œç³»ç»ŸçœŸè±¡è¿˜åŸ å¤§å‹ç½‘ç«™ç³»ç»Ÿä¸Javaä¸­é—´ä»¶å®è·µ é«˜æ€§èƒ½JavaScript é«˜æ€§èƒ½MySQLï¼ˆç¬¬3ç‰ˆï¼‰ æœºå™¨å­¦ä¹  æç®€æ€ç»´ æŠ€æœ¯è¿è¥ äººæ€§çš„å¼±ç‚¹ è®¾è®¡æ¨¡å¼è§£æï¼ˆç¬¬2ç‰ˆï¼‰ è®¾è®¡æ¨¡å¼ä¹‹ç¦… æ·±åº¦æ€ç»´ æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº æ·±å…¥æµ…å‡ºNode.js æ·±å…¥æµ…å‡ºReactå’ŒRedux ç§»åŠ¨Webå‰ç«¯é«˜æ•ˆå¼€å‘å®æˆ˜ äº¿çº§æµé‡ç½‘ç«™æ¶æ„æ ¸å¿ƒæŠ€æœ¯ åŸåˆ™ æ€æ ·ç®¡ç²¾åŠ›å°±æ€æ ·è¿‡ä¸€ç”Ÿ é‡æ„æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ Excelé«˜æ•ˆåŠå…¬ï¼šæ•°æ®å¤„ç†ä¸åˆ†æï¼ˆä¿®è®¢ç‰ˆï¼‰ é¡¹ç›®ç®¡ç†è‰ºæœ¯ å‘¨é¸¿ç¥è‡ªè¿° æˆ‘çš„äº’è”ç½‘æ–¹æ³•è®º å¥‡ç‚¹ä¸´è¿‘ é«˜æ•ˆèƒ½äººå£«çš„ä¸ƒä¸ªä¹ æƒ¯ ä¸‰æ¿æ–§ï¼šé˜¿é‡Œå·´å·´ç®¡ç†ä¹‹é“ æ˜é‡‘ç§»åŠ¨äº’è”ï¼šè·¨å¢ƒç”µå•†å¦‚ä½•æŒ‘æˆ˜æµ·å¤–å¸‚åœº å¾®ä¿¡æ€ç»´ ç³»ç»Ÿä¹‹ç¾:å†³ç­–è€…çš„ç³»ç»Ÿæ€è€ƒ æ€è€ƒï¼Œå¿«ä¸æ…¢ åˆ›æ–°è€…çš„çª˜å¢ƒ å¾®æœåŠ¡è®¾è®¡ Scrumæ•æ·è½¯ä»¶å¼€å‘ ç®¡ç†çš„å®è·µ"},{"title":"å…³äºæœ¬äºº","date":"2019-10-21T15:26:09.000Z","updated":"2019-10-21T15:28:30.066Z","comments":true,"path":"about/index.html","permalink":"http://luxiaowan.github.io/about/index.html","excerpt":"","text":"ä¸²ä¸€ä¸² æµªäºº éå¸¸æ‡’ï¼Œå¶å°”å†™ä¸€ä¸‹ æ–‡ç¬”å¾ˆçƒ‚ï¼Œå†™çš„ä¸å¥½ å‡‘åˆçœ‹å§"},{"title":"åˆ†ç±»","date":"2019-10-21T15:29:38.000Z","updated":"2019-10-21T15:32:44.295Z","comments":true,"path":"categories/index.html","permalink":"http://luxiaowan.github.io/categories/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2019-10-21T15:35:35.000Z","updated":"2019-10-21T15:35:54.071Z","comments":true,"path":"tags/index.html","permalink":"http://luxiaowan.github.io/tags/index.html","excerpt":"","text":""},{"title":"ä¸ªäººé¡¹ç›®","date":"2019-10-21T15:54:25.000Z","updated":"2019-10-21T15:57:51.353Z","comments":true,"path":"repository/index.html","permalink":"http://luxiaowan.github.io/repository/index.html","excerpt":"","text":"https://github.com/luxiaowan"}],"posts":[{"title":"æ…ç”¨ArrayListä¸­çš„SubList","slug":"æ…ç”¨ArrayListä¸­çš„SubList","date":"2019-11-10T17:11:00.000Z","updated":"2019-11-24T16:18:53.293Z","comments":true,"path":"2019/11/11/æ…ç”¨ArrayListä¸­çš„SubList/","link":"","permalink":"http://luxiaowan.github.io/2019/11/11/æ…ç”¨ArrayListä¸­çš„SubList/","excerpt":"","text":"åŒåä¸€äº†ï¼Œå¤§å®¶éƒ½çœäº†å¤šå°‘é’±å•Šï¼Ÿ é¢˜å¤–è¯ï¼šæ­¤å¤„äº¤ç»™å¤§å®¶ä¸€ä¸ªæŸ¥çœ‹å•†å“å†å²ä»·æ ¼çš„å°æ–¹æ³•ï¼š åœ¨å•†å“é“¾æ¥çš„åŸŸåååŠ ä¸Šä¸‰ä¸ªvå°±èƒ½æŸ¥çœ‹åˆ°è¯¥å•†å“çš„å†å²ä»·æ ¼å•¦ ğŸŒ° http://shop.taobao.com/xxxx â†“ http://shop.taobaovvv.com/xxx æ­¥å…¥æ­£é¢˜ï¼Œä¸ºä»€ä¹ˆè¯´æˆ‘ä»¬åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­è¦æ…ç”¨ArrayListçš„subListå‘¢ï¼Ÿå…¶å®è¿™ä¹Ÿæ˜¯é˜¿é‡Œå†›è§„ä¸­çš„ä¸€æ¡ï¼ŒåŸå› å…¶å®å¾ˆç®€å•ï¼šä¸ç¨³å®šï¼ä¹Ÿè®¸çœ‹åˆ°è¿™é‡Œä¼šè§‰å¾—&quot;å°±æ˜¯åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„æ–°çš„SubListçš„å®ä¾‹ï¼Œæ€ä¹ˆä¼šä¸ç¨³å®šï¼&quot;ï¼Œå¦‚æœä½ æ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œè¿™ç¯‡æ–‡ç« çœŸçš„èƒ½å¤Ÿå¸®åŠ©åˆ°ä½ ï¼Œä¸”å¾€ä¸‹çœ‹ï¼š 1. å®¢è§‚æ‚¨ä¸Šä¸Šçœ¼ï¼Œçœ‹çœ‹SubListçš„setæ–¹æ³•ï¼š 1234567891011121314151617public static void main(String[] args) &#123; List&lt;String&gt; sourceList = new ArrayList&lt;String&gt;() &#123; &#123; add(\"H\"); add(\"E\"); add(\"L\"); add(\"L\"); add(\"O\"); add(\"W\"); add(\"O\"); add(\"R\"); add(\"L\"); add(\"D\"); &#125; &#125;; List&lt;String&gt; subList = sourceList.subList(2, 5); System.out.println(\"sourceList: \" + sourceList); System.out.println(\"sourceList.subList(2, 5)å¾—åˆ°: \" + subList); subList.set(1, \"cc\"); System.out.println(\"sourceList: \" + sourceList); System.out.println(\"subList: \" + subList); &#125;&#125; ä¸Šé¢ä»£ç çš„æ‰§è¡Œç»“æœæ˜¯ä»€ä¹ˆï¼Ÿå…ˆä¸è¦çœ‹ä¸‹é¢çš„ç­”æ¡ˆï¼Œè‡ªå·±æƒ³ä¸€æƒ³ã€‚ ç­”æ¡ˆ 1234sourceList: [H, E, L, L, O, W, O, R, L, D]subList: [L, L, O]sourceList: [H, E, L, cc, O, W, O, R, L, D]subList: [L, cc, O] å“¦å¼~ï¼ç­”æ¡ˆå’Œä½ è‡ªå·±æƒ³çš„æœ‰æ²¡æœ‰å‡ºå…¥ï¼Ÿå¥‡å¦™å§ï¼Œä¸ºä»€ä¹ˆä¿®æ”¹äº†subListä¸­çš„å…ƒç´ ï¼Œä¼šå½±å“åˆ°sourceListï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸‹ArrayListçš„subListæ–¹æ³•éƒ½åšäº†äº›ä»€ä¹ˆï¼š JDKæºç  12345678/** * Returns a view of the portion of this list between the specified * &#123;@code fromIndex&#125;, inclusive, and &#123;@code toIndex&#125;, exclusive. */public List&lt;E&gt; subList(int fromIndex, int toIndex) &#123; subListRangeCheck(fromIndex, toIndex, size); return new SubList(this, 0, fromIndex, toIndex);&#125; é¦–å…ˆæ˜¯æ£€æŸ¥æˆ‘ä»¬çš„fromIndexå’ŒtoIndexæ˜¯å¦åˆæ³•ï¼Œç„¶åè°ƒç”¨ArrayListçš„å†…éƒ¨ç±»SubListåˆ›å»ºä¸€ä¸ªSubListçš„å®ä¾‹ã€‚å¥½åƒè¿˜çœŸå¦‚æˆ‘ä»¬ä¹‹å‰æƒ³çš„ä¸€æ ·ï¼Œåˆ›å»ºäº†ä¸€ä¸ªç‹¬ç«‹çš„SubListçš„å¯¹è±¡ï¼Œæ²¡ä»€ä¹ˆä¸å¯¹çš„ï¼Œé‚£æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹SubListçš„æ„é€ å™¨ä¸­éƒ½åšäº†äº›ä»€ä¹ˆå§ã€‚ 1234567SubList(AbstractList&lt;E&gt; parent, int offset, int fromIndex, int toIndex) &#123; this.parent = parent; this.parentOffset = fromIndex; this.offset = offset + fromIndex; this.size = toIndex - fromIndex; this.modCount = ArrayList.this.modCount;&#125; è¿™æ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼ŸArrayListçš„å®ä¾‹å¯¹è±¡(ä¹Ÿå°±æ˜¯parent)ç«Ÿç„¶ä½œä¸ºå‚æ•°ä¼ åˆ°äº†SubListä¸­ï¼ŒSubListçš„åç§»é‡ä¸º0+fromIndexï¼Œå¤§å°sizeä¸ºtoIndex - fromIndexï¼ˆä¹Ÿå°±æ˜¯å’ŒStringçš„substringæ–¹æ³•ä¸€æ ·ï¼ŒfromIndexåˆ°(toIndex -1)çš„æ•°æ®é›†ï¼‰ï¼Œä¿®æ”¹æ¬¡æ•°modCountå’ŒArrayListçš„modCountç›¸ç­‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŒœæµ‹ä¸€ä¸‹ï¼šSubListå®ä¾‹çš„å˜åŠ¨ï¼Œæ˜¯å¦å’ŒArrayListæœ‰å…³å‘¢ï¼Ÿ æˆ‘ä»¬çœ‹åˆ°subListæ–¹æ³•çš„æ³¨é‡Šä¸­æœ‰è¿™ä¹ˆä¸€å¥è¯ï¼šReturns a view of the portion of this listã€‚éš¾é“SubListä»…ä»…æ˜¯ArrayListçš„ä¸€ä¸ªè¢«fromIndexå’ŒtoIndexçš„åŒºé—´è§†å›¾ï¼Ÿ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒsubListè°ƒç”¨äº†å®ƒçš„setæ–¹æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªsetæ–¹æ³•å†…éƒ¨é€»è¾‘æ˜¯ä»€ä¹ˆï¼š 12345678910public E set(int index, E e) &#123; rangeCheck(index);// ä¸‹æ ‡æ ¡éªŒ checkForComodification();// æ ¡éªŒåˆæ³•æ€§ // ***é‡ç‚¹ // æ ¹æ®åç§»é‡å’Œä¸‹æ ‡ï¼Œè·å–ArrayListå¯¹è±¡çš„elementDataæ•°ç»„ä¸­ä¸‹æ ‡ä¸º(offset + index)çš„å…ƒç´  // offsetæ˜¯ä»€ä¹ˆï¼Ÿä»æ„é€ å™¨ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°offsetå°±æ˜¯0 + fromIndexï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æˆªå–çš„èµ·å§‹ä¸‹æ ‡ï¼Œä¹Ÿå°±æ˜¯SubListçš„setæ–¹æ³•æ˜¯ç›´æ¥åœ¨åŸArrayListå®ä¾‹çš„å†…éƒ¨æ•°ç»„ä¸Šè¿›è¡Œçš„æ“ä½œ E oldValue = ArrayList.this.elementData(offset + index); ArrayList.this.elementData[offset + index] = e; return oldValue;&#125; çœ‹åˆ°è¿™é‡Œå°±ä¸€ç›®äº†ç„¶äº†ï¼Œæ€ªä¸å¾—æˆ‘ä»¬ä¿®æ”¹äº†SubListçš„å…ƒç´ ä¼šå½±å“åˆ°åˆ›å»ºå®ƒçš„å¯¹è±¡çš„å€¼ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨SubListçš„æ—¶å€™ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹SubListé‡Œé¢çš„å€¼ï¼Œä¸€å®šè¦æ³¨æ„ä¸€ä¸‹æ˜¯å¦ä¼šå½±å“åˆ°åŸListä¸­çš„æ•°æ®æ‰€æ¶‰åŠçš„ä¸šåŠ¡ï¼Œå¦åˆ™è¿™ä¸ªå‘ä¸€æ—¦è¸©ä¸Šäº†ï¼Œä¸å¤ªå®¹æ˜“æ’æŸ¥å•Šã€‚ 2. å®¢è§‚å†ä¸Šçœ¼ï¼Œçœ‹çœ‹SubListçš„addæ–¹æ³• 1234567891011121314151617public static void main(String[] args) &#123; List&lt;String&gt; sourceList = new ArrayList&lt;String&gt;() &#123; &#123; add(\"H\"); add(\"E\"); add(\"L\"); add(\"L\"); add(\"O\"); add(\"W\"); add(\"O\"); add(\"R\"); add(\"L\"); add(\"D\"); &#125; &#125;; List&lt;String&gt; subList = sourceList.subList(2, 5); System.out.println(\"sourceList: \" + sourceList); System.out.println(\"sourceList.subList(2, 5)å¾—åˆ°: \" + subList); subList.add(\"cc\"); System.out.println(\"sourceList: \" + sourceList); System.out.println(\"subList: \" + subList); &#125;&#125; ä¸Šé¢ä»£ç çš„æ‰§è¡Œç»“æœåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬ç¨å¾®æ€è€ƒä¸€ä¸‹ï¼Œå¤§è‡´èƒ½æ­£ç¡®çš„åˆ†æå‡ºç»“æœï¼š ç­”æ¡ˆ 1234sourceList: [H, E, L, L, O, W, O, R, L, D]subList: [L, L, O]sourceList: [H, E, L, L, O, cc, W, O, R, L, D]subList: [L, L, O, cc] æˆ‘ä»¬å‘subListä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼ŒåŸåˆ—è¡¨sourceListåœ¨toIndexçš„ä½ç½®æ’å…¥äº†subListä¸­addçš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨SubListä¸­æ–°å¢ä¸€ä¸ªå…ƒç´ ï¼ŒåŒæ—¶ä¼šå°†è¿™ä¸ªå…ƒç´ æ·»åŠ åˆ°åŸListä¸­ã€‚ JDKæºç  æˆ‘ä»¬æŸ¥çœ‹SubListçš„æºç ï¼Œå‘ç°å¹¶æ²¡æœ‰add(E e)æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬è°ƒç”¨çš„add(â€œccâ€)æ˜¯è°ƒç”¨åˆ°å“ªé‡Œå»äº†å‘¢ï¼Ÿæˆ‘ä»¬æŸ¥çœ‹SubListç±»çš„å£°æ˜ï¼Œå¯ä»¥çœ‹åˆ°å®ƒæ˜¯ç»§æ‰¿äº†AbstractListæŠ½è±¡ç±»ï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥æ˜¯è°ƒç”¨äº†è¶…ç±»é‡Œçš„add(E e)æ–¹æ³•ï¼Œ 12345/** AbstractList.java */public boolean add(E e) &#123; add(size(), e); return true;&#125; è¿™é‡Œå¯ä»¥çœ‹åˆ°æ˜¯è°ƒç”¨äº†add(int index, E element)æ–¹æ³•è¿›è¡Œæ•°æ®æ–°å¢çš„ï¼Œç„¶è€ŒSubListé‡Œé¢å®ç°äº†è¿™ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸‹SubListä¸­çš„è¿™ä¸ªæ–¹æ³•å®ç°ï¼š 123456789101112public void add(int index, E e) &#123; // æ ¡éªŒä¸‹æ ‡æ˜¯å¦è¶Šç•Œ rangeCheckForAdd(index); // æ ¡éªŒåŸListæ˜¯å¦æœ‰è¿‡ä¿®æ”¹ checkForComodification(); // parentå³æ˜¯åœ¨æ„é€ å™¨ä¸­æ³¨å…¥çš„åŸList parent.add(parentOffset + index, e); // åŒæ­¥åˆ—è¡¨ä¿®æ”¹æ¬¡æ•° this.modCount = parent.modCount; // æœ¬åˆ—è¡¨çš„é•¿åº¦+1 this.size++;&#125; ç”±SubListçš„æºç å¯ä»¥çœ‹å‡ºï¼ŒSubListå®ä¾‹çš„addæ–¹æ³•å®é™…ä¸Šå°±æ˜¯åœ¨ä¿®æ”¹åŸListï¼ŒåŒ…æ‹¬SubListä¸­æ‰€æœ‰çš„æ–¹æ³•å‡æ˜¯åœ¨parentåˆ—è¡¨ä¸Šè¿›è¡Œæ“ä½œã€‚ 3. å¥‡è‘©æ“ä½œï¼Œæœ€å‘çš„å‘ ä»”ç»†åˆ†æå¦‚ä¸‹ä»£ç ï¼š 12345678910111213141516public static void main(String[] args) &#123; List&lt;String&gt; sourceList = new ArrayList&lt;String&gt;() &#123; &#123; add(\"H\"); add(\"E\"); add(\"L\"); add(\"L\"); add(\"O\"); add(\"W\"); add(\"O\"); add(\"R\"); add(\"L\"); add(\"D\"); &#125; &#125;; List&lt;String&gt; subList = sourceList.subList(2, 5); System.out.println(\"sourceList: \" + sourceList); System.out.println(\"subList: \" + subList); sourceList.add(\"cc\"); System.out.println(\"sourceList: \" + sourceList); System.out.println(\"subList: \" + subList);&#125; è¿™æ®µä»£ç çš„æ‰§è¡Œç»“æœæ˜¯ä»€ä¹ˆï¼Ÿåœ¨ä¸æ‰§è¡Œè¿™æ®µä»£ç çš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¸æ˜¯ä»¥ä¸ºæ˜¯ä¸‹é¢çš„ç»“æœï¼Ÿ 1234sourceList: [H, E, L, L, O, W, O, R, L, D]subList: [L, L, O]sourceList: [H, E, L, L, O, W, O, R, L, D, cc]subList: [L, L, O] å¦‚æœä½ è¯´å¯¹ï¼Œå°±æ˜¯è¿™ä¸ªï¼Œé‚£ä½ å¯å°±è¯´é”™å’¯ï¼Œå®é™…ä¸Šåœ¨æ‰§è¡Œåˆ°System.out.println(&quot;sourceList: &quot; + sourceList);è¿™ä¸€å¥ä»£ç çš„æ—¶å€™æ•´ä¸ªç¨‹åºçš„è¾“å‡ºéƒ½æ˜¯æ­£å¸¸çš„ï¼Œä½†åœ¨æ‰§è¡Œæœ€åä¸€å¥ä»£ç çš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥é”™äº†ï¼Œé”™è¯¯ä¿¡æ¯æ˜¯ï¼š 123456789Exception in thread \"main\" java.util.ConcurrentModificationException at java.util.ArrayList$SubList.checkForComodification(ArrayList.java:1239) at java.util.ArrayList$SubList.listIterator(ArrayList.java:1099) at java.util.AbstractList.listIterator(AbstractList.java:299) at java.util.ArrayList$SubList.iterator(ArrayList.java:1095) at java.util.AbstractCollection.toString(AbstractCollection.java:454) at java.lang.String.valueOf(String.java:2994) at java.lang.StringBuilder.append(StringBuilder.java:131) at cc.kevinlu.sublist.SubListTest.main(SubListTest.java:31) å“¦å¼~ï¼ç«Ÿç„¶æŠ¥é”™äº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯åœ¨ArrayList$SubList.checkForComodificatioæ–¹æ³•ä¸­æŠ¥çš„é”™ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼š 12345private void checkForComodification() &#123; // æ¯”è¾ƒåŸåˆ—è¡¨ä¿®æ”¹æ¬¡æ•°å’ŒSubListçš„ä¿®æ”¹æ¬¡æ•°æ˜¯å¦ç›¸ç­‰ if (ArrayList.this.modCount != this.modCount) throw new ConcurrentModificationException();&#125; è¿™é‡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè¯´æ˜è¿™ä¸¤ä¸ªæ•°æ˜¯ä¸ç›¸ç­‰çš„ï¼Œé‚£ä¸ºä»€ä¹ˆä¼šä¸ç›¸ç­‰å‘¢ï¼Ÿæˆ‘ä»¬çœ‹SubListçš„addæ–¹æ³•ä¸­æœ‰åŒæ­¥ä¸»ã€'å­â€™åˆ—è¡¨çš„è¯­å¥this.modCount = parent.modCount;ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨ä¿®æ”¹subListçš„æ—¶å€™ï¼Œä¼šåŒæ­¥æ›´æ–°ä¸»åˆ—è¡¨çš„modCountï¼Œä»¥ä¿è¯ä¸»ã€'å­â€™åˆ—è¡¨å§‹ç»ˆæ˜¯ä¸€è‡´çš„ã€‚ ä½†æ˜¯æˆ‘ä»¬åœ¨ä¿®æ”¹ä¸»Listçš„æ—¶å€™æ˜¯ä¸ä¼šå»åŒæ­¥SubListçš„modCountçš„ï¼Œæˆ‘ä»¬è¾“å‡ºSubListçš„å®ä¾‹å®é™…ä¸Šå°±æ˜¯è°ƒç”¨iteratoræ–¹æ³•ï¼Œæœ€ç»ˆæ˜¯è°ƒç”¨äº†SubListçš„public ListIterator&lt;E&gt; listIterator(final int index)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç¬¬ä¸€å¥å°±æ˜¯è°ƒç”¨checkForComodificationæ–¹æ³•æ£€æŸ¥modCountï¼Œè¿™é‡Œè‡ªç„¶å°±ä¼šæŠ¥é”™å’¯ï¼ 4. å¡«å‘ æ—¢ç„¶æœ‰å‘ï¼Œå°±æœ‰å¡«å‘çš„åŠæ³•ï¼Œä¸å¯èƒ½ä¸€ç›´æŠŠå‘æ”¾åœ¨é‚£ï¼Œæ˜¯å§ã€‚ å¦‚æœæ—¢æƒ³ä¿®æ”¹subListï¼Œåˆä¸æƒ³å½±å“åˆ°åŸlistã€‚é‚£ä¹ˆå¯ä»¥åˆ›å»ºä¸€ä¸ªæœºé‡subListçš„æ‹·è´: 123451.åˆ›å»ºæ–°çš„Listï¼š subList = Lists.newArrayList(subList);2.lambdaè¡¨è¾¾å¼ï¼š sourceList.stream().skip(fromIndex).limit(size).collect(Collectors.toList()); 5. æ€»ç»“ å¹¶ä¸æ˜¯è¯´ä½¿ç”¨SubListä¸€å®šä¸å¦¥ï¼Œæ–‡ç« å¼€å¤´æˆ‘ä»¬ä¹Ÿè¯´çš„æ˜¯æ…ç”¨ï¼Œæ‰€ä»¥ï¼Œæ ¹æ®å…·ä½“ä¸šåŠ¡è¿›è¡Œé€‰æ‹©å§ã€‚","categories":[{"name":"Java","slug":"Java","permalink":"http://luxiaowan.github.io/categories/Java/"}],"tags":[]},{"title":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨::zsetç¯‡","slug":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”zsetç¯‡","date":"2019-11-08T04:55:00.000Z","updated":"2019-11-21T16:05:02.245Z","comments":true,"path":"2019/11/08/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”zsetç¯‡/","link":"","permalink":"http://luxiaowan.github.io/2019/11/08/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”zsetç¯‡/","excerpt":"","text":"Redisæœ‰6å¤§åŸºæœ¬ç±»å‹ï¼Œåˆ†åˆ«æ˜¯å­—ç¬¦ä¸²(String)ã€åˆ—è¡¨(List)ã€é›†åˆ(set)ã€å“ˆå¸Œç»“æ„(hash)ã€æœ‰åºé›†åˆ(zset)å’ŒåŸºæ•°(HyperLogLog) redisåœ¨çº¿ä½“éªŒåœ°å€ï¼šhttp://try.redis.io/ æœ‰åºé›†åˆ(ZSet) ä»‹ç»: Redisçš„æœ‰åºé›†åˆå’Œé›†åˆä¸€æ ·æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²é›†åˆï¼Œä½†è¯¥é›†åˆæ˜¯æœ‰åºçš„ï¼Œä¸”é›†åˆå†…çš„å…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯é›†åˆå†…ä¸ä¼šå‡ºç°é‡å¤å…ƒç´ ï¼Œä¸é›†åˆå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œæœ‰åºé›†åˆä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªdoubleç±»å‹çš„scoreå±æ€§ï¼ŒRedisé€šè¿‡scoreçš„å¤§å°å¯¹å…ƒç´ è¿›è¡Œæ’åºçš„ã€‚æœ‰åºé›†åˆä¸­å…ƒç´ ä¸èƒ½é‡å¤ï¼Œä½†æ˜¯å…ƒç´ çš„scoreå€¼å¯ä»¥é‡å¤ã€‚ å¸¸ç”¨äºåšæ’è¡Œæ¦œåŠŸèƒ½ã€‚ Redisä¸­çš„é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨æ¥å®ç°çš„ï¼Œæ‰€ä»¥è·å–é›†åˆä¸­å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚ åˆ›å»ºç¼“å­˜ åˆ›å»ºä¸€ä¸ªé›†åˆç¼“å­˜ï¼Œä¸ºé›†åˆæ–°å¢å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šzadd key score member [score member ...] ğŸŒ° 12345678zadd zk1 1 c 1 cc 1 ccc 2 cccc---åˆ›å»ºæœ‰åºé›†åˆzk1ï¼Œå…ƒç´ ä¸ºï¼škey: c, score: 1key: cc, score: 1key: ccc, score: 1key: cccc, score: 2 åˆ›å»ºä¸€ä¸ªå…ƒç´ æˆ–ä¿®æ”¹å…ƒç´ çš„scoreå€¼ï¼ˆä¸€æ¬¡åªèƒ½ä¿®æ”¹ä¸€ä¸ªå…ƒç´ ï¼‰ å‘½ä»¤æ ¼å¼ï¼šzincrby key increment member ğŸŒ° 123456zincrby zk1 1 cc---1. ä¸ºé›†åˆzk1çš„å…ƒç´ ccçš„scoreè¿›è¡Œ+1æ“ä½œ2. è‹¥é›†åˆzk1ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º3. è‹¥å…ƒç´ ccä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼Œä¸”ccçš„scoreä¸º1 æŸ¥è¯¢ç¼“å­˜ æŸ¥è¯¢ç¼“å­˜ä¸­å…ƒç´ ä¸ªæ•° å‘½ä»¤æ ¼å¼ï¼šzcard key ğŸŒ° 1234zcard zk1---æŸ¥è¯¢é›†åˆzk1å†…çš„å…ƒç´ æ€»ä¸ªæ•° æŸ¥è¯¢é›†åˆæŒ‡å®šèŒƒå›´çš„å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šzrange key start stop [withscores] ğŸŒ° 12345678910111213141. è¿”å›å…ƒç´ åç§°zrange zk1 0 1---è¿”å›é›†åˆzk1ä¸­ä»ä¸‹æ ‡0åˆ°ä¸‹æ ‡1çš„å…ƒç´ åç§°ï¼Œstartå’Œstopéƒ½æ˜¯ä»0å¼€å§‹2. è¿”å›å…ƒç´ å’Œå…ƒç´ scorezrange zk1 0 -1 withscores---è¿”å›é›†åˆzk1ä¸­å…¨éƒ¨å…ƒç´ çš„åç§°å’Œåˆ†æ•°member1score1member2score2â˜…å¸¸ç”¨äºæŸ¥è¯¢æ’è¡Œæ¦œåŠåˆ†æ•° æŸ¥è¯¢é›†åˆä¸­æŸå…ƒç´ çš„ä¸‹æ ‡ï¼ˆä¸‹æ ‡ä»0å¼€å§‹ï¼‰ å‘½ä»¤æ ¼å¼ï¼šzrank key member ğŸŒ° 1234zrank zk1 c---è¿”å›å…ƒç´ cåœ¨é›†åˆzk1ä¸­çš„ä¸‹æ ‡ æŸ¥è¯¢é›†åˆä¸­æŸå…ƒç´ çš„åˆ†æ•° å‘½ä»¤æ ¼å¼ï¼šzscore key member ğŸŒ° 12345zscore zk1 c---æŸ¥è¯¢é›†åˆzk1ä¸­å…ƒç´ cçš„åˆ†æ•°â˜…å¸¸ç”¨äºç‚¹èµæ•°ç±»åˆ«æŸ¥è¯¢ç­‰ æŸ¥è¯¢é›†åˆä¸­æŒ‡å®šèŒƒå›´çš„å…ƒç´ ï¼ŒæŒ‰ç…§scoreä»å¤§åˆ°å°æ’åº å‘½ä»¤æ ¼å¼ï¼šzrevrange key start stop [withscores] ğŸŒ° 1234zrevrange zk1 0 3 withscore---è¿”å›é›†åˆzk1ä¸­ä»1~4ä½å…ƒç´ ï¼ŒæŒ‰ç…§scoreä»å¤§åˆ°å° æŸ¥è¯¢é›†åˆä¸­æŸå…ƒç´ çš„æ’å å‘½ä»¤æ ¼å¼ï¼šzrevrank key member ğŸŒ° 12345zrevrank zk1 c---è¿”å›å…ƒç´ cåœ¨é›†åˆzk1ä¸­çš„æ’åâ˜…å¸¸ç”¨äºåæ¬¡æŸ¥è¯¢ æŸ¥è¯¢æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„å…ƒç´ ï¼Œå¯åˆ†é¡µ å‘½ä»¤æ ¼å¼ï¼šzrevrangebyscore key maxScore minScore [withscores] [limit offset count] ğŸŒ° 1234zrevrangebyscore zk1 3 2 withscores limit 0 1---åˆ†é¡µè¿”å›é›†åˆzk1ä¸­åˆ†æ•°ä»2~3çš„å…ƒç´  æŸ¥è¯¢æŒ‡å®šæˆå‘˜åŒºé—´å†…çš„æˆå‘˜ å‘½ä»¤æ ¼å¼ï¼šzrangebylex key minChar maxChar [limit offset count] ğŸŒ° 1234zrangebylex zk1 - (c1 limit 0 12---è¿”å›ä»ç¬¬ä¸€ä¸ªå…ƒç´ åˆ°å…ƒç´ c1ä¹‹é—´çš„ä½ç½® æŒ‡ä»¤ æ˜¯å¦å¿…é¡» è¯´æ˜ ZRANGEBYLEX æ˜¯ æŒ‡ä»¤ key æ˜¯ æœ‰åºé›†åˆé”®åç§° minChar æ˜¯ å­—å…¸ä¸­æ’åºä½ç½®è¾ƒå°çš„æˆå‘˜,å¿…é¡»ä»¥â€[â€œ(åŒ…å«)å¼€å¤´,æˆ–è€…ä»¥â€(â€œ(ä¸åŒ…å«)å¼€å¤´,å¯ä½¿ç”¨â€-â€œä»£æ›¿ï¼Œ&quot;-&quot;è¡¨ç¤ºå–æœ€å°å€¼ maxChar æ˜¯ å­—å…¸ä¸­æ’åºä½ç½®è¾ƒå¤§çš„æˆå‘˜,å¿…é¡»ä»¥â€[â€œ(åŒ…å«)å¼€å¤´,æˆ–è€…ä»¥â€(â€œ(ä¸åŒ…å«)å¼€å¤´,å¯ä½¿ç”¨â€+â€ä»£æ›¿ï¼Œ&quot;+&quot;è¡¨ç¤ºå–æœ€å¤§å€¼ limit å¦ è¿”å›ç»“æœæ˜¯å¦åˆ†é¡µ,æŒ‡ä»¤ä¸­åŒ…å«LIMITåoffsetã€countå¿…é¡»è¾“å…¥ offset å¦ è¿”å›ç»“æœèµ·å§‹ä½ç½® count å¦ è¿”å›ç»“æœæ•°é‡ æŸ¥è¯¢æŒ‡å®šåˆ†æ•°åŒºé—´å†…çš„å…ƒç´ æ•° å‘½ä»¤æ ¼å¼ï¼šzcount key min max ğŸŒ° 12345zcount zk1 1 2---è¿”å›scoreå€¼ä¸º1~2çš„æ‰€æœ‰å…ƒç´ æ€»æ•°â˜…è®¡ç®—æ’è¡Œæ¦œä¸­æŸä¸€åˆ†æ•°åŒºé—´çš„æ•°é‡ æŸ¥è¯¢æŒ‡å®šå…ƒç´ åŒºé—´å†…çš„å…ƒç´ æ€»æ•° å‘½ä»¤æ ¼å¼ï¼šzlexcount key min max ğŸŒ° 1234zlexcount zk1 (c [cccc---æŸ¥è¯¢c~ccccä¹‹é—´çš„å…ƒç´ æ€»æ•°ï¼Œä¸åŒ…æ‹¬cï¼Œä½†åŒ…æ‹¬cccc ç§»é™¤ç¼“å­˜å…ƒç´  ç§»é™¤é›†åˆä¸­æŒ‡å®šçš„å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šzrem key member [member ...] ğŸŒ° 1234zrem zk1 cc c1---ç§»é™¤é›†åˆzk1ä¸­çš„å…ƒç´ ccã€c1 ç§»é™¤æŒ‡å®šå…ƒç´ åŒºé—´çš„æ‰€æœ‰æˆå‘˜ å‘½ä»¤æ ¼å¼ï¼šzremrangebylex key min max ğŸŒ° 1234zremrangebylex zk1 [c (ccc---ç§»é™¤é›†åˆzk1ä¸­å…ƒç´ cåˆ°å…ƒç´ cccä¹‹é—´çš„æ‰€æœ‰æˆå‘˜ï¼ŒåŒ…æ‹¬cï¼Œä½†ä¸åŒ…æ‹¬ccc ç§»é™¤æŒ‡å®šæ’ååŒºé—´æ‰€æœ‰æˆå‘˜ å‘½ä»¤æ ¼å¼ï¼šzremrangebyrank key start stop ğŸŒ° 1234zremrangebyrank zk1 0 1---ç§»é™¤é›†åˆzk1ä¸­0~1ä¸‹æ ‡çš„æ‰€æœ‰å…ƒç´  ç§»é™¤æŒ‡å®šåˆ†æ•°åŒºé—´æ‰€æœ‰æˆå‘˜ å‘½ä»¤æ ¼å¼ï¼šzremrangebyscore key min max ğŸŒ° 1234zremrangebyscore zk1 0 1---ç§»é™¤é›†åˆzk1ä¸­scoreå€¼ä¸º0~1çš„æ‰€æœ‰å…ƒç´  ç‰¹æ®Šæ“ä½œ è®¡ç®—å¤šä¸ªé›†åˆçš„å¹¶é›†ï¼Œå¹¶å­˜å…¥æ–°çš„é›†åˆ å‘½ä»¤æ ¼å¼ï¼šzunionstore destinationKey numkeys key[key ...] ğŸŒ° 1234zunionstore zku 2 zk1 zk2---åˆå¹¶é›†åˆzk1å’Œzk2ï¼Œå°†å¹¶é›†å­˜å…¥zkuï¼Œé›†åˆzkuä¸­å…ƒç´ çš„scoreä¸ºæ‰€æœ‰å‚ä¸è®¡ç®—çš„é›†åˆä¸­ç›¸åŒçš„å…ƒç´ çš„scoreä¹‹å’Œ","categories":[{"name":"Redis","slug":"Redis","permalink":"http://luxiaowan.github.io/categories/Redis/"}],"tags":[]},{"title":"Javaå‘½ä»¤::jstat","slug":"Javaå‘½ä»¤â€”jstat","date":"2019-11-08T04:00:00.000Z","updated":"2019-11-10T15:57:22.417Z","comments":true,"path":"2019/11/08/Javaå‘½ä»¤â€”jstat/","link":"","permalink":"http://luxiaowan.github.io/2019/11/08/Javaå‘½ä»¤â€”jstat/","excerpt":"","text":"jstatæ˜¯ç”¨äºç›‘æ§è™šæ‹Ÿæœºè¿è¡ŒçŠ¶æ€ä¿¡æ¯çš„å‘½ä»¤ï¼Œå¯ä»¥æ˜¾ç¤ºè™šæ‹Ÿæœºè¿›ç¨‹ä¸­çš„ç±»è£…è½½ã€å†…å­˜ä½¿ç”¨ã€GCæƒ…å†µã€JITç¼–è¯‘ç­‰è¿è¡ŒçŠ¶æ€æ•°æ®ï¼Œèƒ½å¤Ÿåœ¨Linuxä¸Šå¿«é€Ÿå®šä½è™šæ‹Ÿæœºæ€§èƒ½é—®é¢˜ã€‚ jstatå‘½ä»¤åœ¨jdkçš„binç›®å½•ä¸‹ï¼Œç›®å½•ä¸­è¿˜æœ‰å¾ˆå¤šå®ç”¨çš„å‘½ä»¤ *ä»¥ä¸‹åˆ†ææ˜¯åŸºäºjdk1.8+ jstatå‘½ä»¤æ ¼å¼ï¼š 123456789jstat -&lt;option&gt; &lt;pid&gt; [&lt;interval&gt; [&lt;count&gt;]]--- option: éœ€è¦æŸ¥çœ‹çš„è™šæ‹Ÿæœºä¿¡æ¯ pid: Javaç¨‹åºè¿›ç¨‹å· æœ¬åœ°è™šæ‹Ÿæœº: pid è¿œç¨‹è™šæ‹Ÿæœº: [protocol:][//] lvmid [@hostname[:port]/servername] interval: ç›‘æ§é—´éš”æ—¶é—´ï¼Œå¯é€‰ï¼Œé»˜è®¤ç«‹åˆ»æ‰§è¡Œä¸€æ¬¡ count: ç›‘æ§æ¬¡æ•°ï¼Œå¯é€‰ï¼Œé»˜è®¤æ— é™æ¬¡ option è¯´æ˜ class æŸ¥çœ‹ç±»è£…è½½ã€å¸è½½æ•°é‡ã€æ€»ç©ºé—´åŠç±»è£…è½½æ‰€è€—æ—¶é—´ gc æŸ¥çœ‹Javaå †çŠ¶å†µï¼ŒåŒ…æ‹¬Edenã€survivorã€è€å¹´ä»£ã€æ°¸ä¹…ä»£çš„å®¹é‡ gcutil ç±»ä¼¼äºgcï¼Œä¸»è¦è¾“å‡ºå„åŒºåŸŸç©ºé—´ä½¿ç”¨å æ¯” gccause åŒgcï¼Œä¼šå¤šè¾“å‡ºæ¯æ¬¡gcçš„åŸå›  gccapacity åŒgcï¼Œä½†è¾“å‡ºçš„ä¸»è¦æ˜¯Javaå †å„ä¸ªåŒºåŸŸä½¿ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´ gcnew æŸ¥çœ‹æ–°ç”Ÿä»£çš„ä½¿ç”¨æƒ…å†µ gcnewcapacity åŒgcnewï¼Œè¾“å‡ºå†…å®¹ä¸»è¦å…³æ³¨æ–°ç”Ÿä»£çš„æœ€å¤§ã€æœ€å°ç©ºé—´ gcold æŸ¥çœ‹è€å¹´ä»£çš„ä½¿ç”¨æƒ…å†µ gcoldcapacity åŒgcoldï¼Œè¾“å‡ºå†…å®¹ä¸»è¦å…³æ³¨è€å¹´ä»£çš„æœ€å¤§ã€æœ€å°ç©ºé—´ gcpermcapacity è¾“å‡ºæ°¸ä¹…ä»£ä½¿ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´ compiler è¾“å‡ºJITç¼–è¯‘å™¨ç¼–è¯‘è¿‡çš„æ–¹æ³•ã€è€—æ—¶ç­‰ä¿¡æ¯ printcompilation è¾“å‡ºå·²ç»è¢«JITç¼–è¯‘çš„æ–¹æ³• ğŸŒ° jstat -class : æ˜¾ç¤ºåŠ è½½classçš„æ•°é‡åŠæ‰€å ç©ºé—´ç­‰ä¿¡æ¯ 12345678910[root@master0 ~]# jstat -class 19080Loaded Bytes Unloaded Bytes Time 11512 22276.9 268 421.6 18.41 ---Loaded: è£…è½½ç±»çš„æ•°é‡Bytes: è£…è½½ç±»æ‰€å ç”¨çš„å­—èŠ‚æ•°Unloaded: å¸è½½ç±»çš„æ•°é‡Bytes: å¸è½½ç±»æ‰€å ç”¨çš„å­—èŠ‚æ•°Time: è£…è½½å’Œå¸è½½ç±»æ‰€èŠ±è´¹çš„æ—¶é—´ jstat -gc : æ˜¾ç¤ºgcçš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹gcçš„æ¬¡æ•°å’Œæ—¶é—´ 1234567891011121314151617181920212223ï¼Œç­‰äºYGCT + FGCT[root@master0 ~]# jstat -gc 19080 1000 1 S0C S1C S0U S1U EC EU OC OU MC MU CCSC CCSU YGC YGCT FGC FGCT GCT 6656.0 6656.0 0.0 3761.4 94208.0 51469.2 73728.0 50832.0 - - - - 20207 92.896 37 7.833 100.729---[å®¹é‡ä¸ºå­—èŠ‚]S0C: å¹´è½»ä»£ç¬¬ä¸€ä¸ªsurvivoråŒºçš„æ€»å®¹é‡ï¼ˆsurvivor 0 capacityï¼‰S1C: å¹´è½»ä»£ç¬¬äºŒä¸ªsurvivoråŒºçš„æ€»å®¹é‡ï¼ˆsurvivor 1 capacityï¼‰S0U: å¹´è½»ä»£ç¬¬ä¸€ä¸ªsurvivoråŒºçš„å·²ä½¿ç”¨å®¹é‡ï¼ˆsurvivor 0 usingï¼‰S1U: å¹´è½»ä»£ç¬¬äºŒä¸ªsurvivoråŒºçš„å·²ä½¿ç”¨å®¹é‡ï¼ˆsurvivor 1 usingï¼‰EC: å¹´è½»ä»£EdenåŒºçš„æ€»å®¹é‡ï¼ˆEden capacityï¼‰EU: å¹´è½»ä»£EdenåŒºçš„å·²ä½¿ç”¨å®¹é‡ï¼ˆEden usingï¼‰OC: è€å¹´ä»£çš„æ€»å®¹é‡ï¼ˆOld capacityï¼‰OU: è€å¹´ä»£å·²ä½¿ç”¨çš„å®¹é‡ï¼ˆOld usingï¼‰MC: Metaspaceçš„æ€»å®¹é‡, jdk1.8+MU: Metaspaceå·²ä½¿ç”¨çš„å®¹é‡, jdk1.8+CCSC:å‹ç¼©ç±»ç©ºé—´å®¹é‡, jdk1.8+CCSU:å‹ç¼©ç±»ç©ºé—´å·²ä½¿ç”¨çš„å®¹é‡, jdk1.8+YGC: æœåŠ¡å¯åŠ¨è‡³ä»Šå¹´è½»ä»£gcçš„æ¬¡æ•°ï¼ˆyoung gcï¼‰YGCT: æœåŠ¡å¯åŠ¨è‡³ä»Šå¹´è½»ä»£gcä½¿ç”¨çš„æ—¶é—´ï¼Œç§’ï¼ˆyoung gc timeï¼‰FGC: æœåŠ¡å¯åŠ¨è‡³ä»Šfullgcçš„æ¬¡æ•°FGCT: æœåŠ¡å¯åŠ¨è‡³ä»Šfullgcä½¿ç”¨çš„æ—¶é—´ï¼Œç§’GCT: æœåŠ¡å¯åŠ¨è‡³ä»Šgcç”¨çš„æ€»æ—¶é—´ï¼Œç§’ï¼Œç­‰äºYGCT + FGCT jstat -gcutil : ç»Ÿè®¡gcä¿¡æ¯ 123456789101112131415161718[root@master0 ~]# jstat -gcutil 19080 1000 3 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 48.90 20.83 69.35 - - 20221 93.006 37 7.833 100.838 0.00 48.90 20.83 69.35 - - 20221 93.006 37 7.833 100.838 0.00 48.90 20.83 69.35 - - 20221 93.006 37 7.833 100.838---S0: å¹´è½»ä»£ç¬¬ä¸€ä¸ªsurvivorå·²ä½¿ç”¨å®¹é‡æ¯”ä¾‹S1: å¹´è½»ä»£ç¬¬äºŒä¸ªsurvivorå·²ä½¿ç”¨å®¹é‡æ¯”ä¾‹E: å¹´è½»ä»£EdenåŒºå·²ä½¿ç”¨å®¹é‡æ¯”ä¾‹O: è€å¹´ä»£å·²ä½¿ç”¨å®¹é‡æ¯”ä¾‹M: å…ƒç©ºé—´å·²ä½¿ç”¨å®¹é‡æ¯”ä¾‹CCS: å‹ç¼©ç±»ç©ºé—´å·²ä½¿ç”¨å®¹é‡æ¯”ä¾‹YGC: æœåŠ¡å¯åŠ¨è‡³ä»Šå¹´è½»ä»£gcæ¬¡æ•°YGCT: æœåŠ¡å¯åŠ¨è‡³ä»Šå¹´è½»ä»£gcæ‰€å ç”¨æ—¶é—´ï¼Œç§’FGC: æœåŠ¡å¯åŠ¨è‡³ä»Šfullgcæ¬¡æ•°FGCT: æœåŠ¡å¯åŠ¨è‡³ä»Šfullgcæ‰€å ç”¨æ—¶é—´ï¼Œç§’GCT: æœåŠ¡å¯åŠ¨è‡³ä»Šgcæ€»å ç”¨æ—¶é—´ï¼Œç§’ï¼Œç­‰äºYGCT + FGCT jstat -gccause : æŸ¥çœ‹gcåŸå›  12345678[root@master0 ~]# jstat -gccause 19080 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT LGCC GCC 57.32 0.00 13.35 69.36 - - 20222 93.015 37 7.833 100.848 Allocation Failure No GC ---ä¸Šè¿°å¯ä»¥çœ‹åˆ°æ¯”-gcutilå¤šå¤„äº†ä¸€ä¸ªLGCCå’ŒGCCLGCC: æœ€è¿‘ä¸€æ¬¡gcå‘ç”Ÿçš„åŸå› ï¼ˆlast gc causeï¼‰GCC: å½“å‰gcå‘ç”Ÿçš„åŸå›  jstat -gccapacity : æŸ¥çœ‹è™šæ‹Ÿæœºä¸­å¯¹è±¡çš„ä½¿ç”¨å’Œå®¹é‡å¤§å° 12345678910[root@master0 ~]# jstat -gccapacity 19080 NGCMN NGCMX NGC S0C S1C EC OGCMN OGCMX OGC OC MCMN MCMX MC CCSMN CCSMX CCSC YGC FGC 20480.0 323584.0 112640.0 7680.0 6656.0 96768.0 40448.0 647168.0 73728.0 73728.0 - - - - - - 20223 37---[å®¹é‡å•ä½ä¸ºå­—èŠ‚]NGCå¼€å¤´çš„è¡¨ç¤ºï¼šæ–°ç”Ÿä»£ç©ºé—´å®¹é‡OGCå¼€å¤´çš„è¡¨ç¤ºï¼šè€å¹´ä»£ç©ºé—´å®¹é‡MCå¼€å¤´çš„è¡¨ç¤ºï¼šå…ƒç©ºé—´å®¹é‡ï¼ˆMetaspace capacityï¼‰CCSå¼€å¤´çš„è¡¨ç¤ºï¼šç±»å‹ç¼©ç©ºé—´ jstat -gcnew : æŸ¥çœ‹æ–°ç”Ÿä»£gcæƒ…å†µ 123456789[root@master0 ~]# jstat -gcnew 19080 S0C S1C S0U S1U TT MTT DSS EC EU YGC YGCT 7680.0 6656.0 0.0 6354.4 15 15 7680.0 96768.0 95634.9 20223 93.023---[å®¹é‡å•ä½ä¸ºå­—èŠ‚]TT: è€å¹´åŒ–é˜ˆå€¼ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå¯¹è±¡æŒæœ‰æ¬¡æ•°ï¼Œå°±æ˜¯åœ¨è¢«ç§»åŠ¨åˆ°è€å¹´ä»£ä¹‹å‰ï¼Œåœ¨æ–°ç”Ÿä»£ä¸­å­˜æ´»çš„æ¬¡æ•°MTT: æœ€å¤§è€å¹´åŒ–é˜ˆå€¼DSS: SurvivoråŒºæ‰€éœ€ç©ºé—´å¤§å° jstat -gcnewcapacity : æŸ¥çœ‹æ–°ç”Ÿä»£ç©ºé—´å®¹é‡ 123456789101112[root@master0 ~]# jstat -gcnewcapacity 19080 NGCMN NGCMX NGC S0CMX S0C S1CMX S1C ECMX EC YGC FGC 20480.0 323584.0 112128.0 107520.0 7168.0 107520.0 7168.0 322560.0 97280.0 20225 37---[å®¹é‡å•ä½ä¸ºå­—èŠ‚]MNè¡¨ç¤ºï¼šæœ€å°MXè¡¨ç¤ºï¼šæœ€å¤§NGCå¼€å¤´è¡¨ç¤ºï¼šæ–°ç”Ÿä»£ç©ºé—´æ€»å®¹é‡S0Cå¼€å¤´ï¼šæ–°ç”Ÿä»£ç¬¬ä¸€ä¸ªsurvivoråŒºå®¹é‡S1Cå¼€å¤´ï¼šæ–°ç”Ÿä»£ç¬¬äºŒä¸ªsurvivoråŒºå®¹é‡ECå¼€å¤´ï¼šæ–°ç”Ÿä»£EdenåŒºå®¹é‡ jstat -gcold : æŸ¥çœ‹è€å¹´ä»£gcæƒ…å†µ 1234567[root@master0 ~]# jstat -gcold 19080 1000 MC MU CCSC CCSU OC OU YGC FGC FGCT GCT - - - - 73728.0 51144.0 20234 37 7.833 100.943 - - - - 73728.0 51144.0 20234 37 7.833 100.943---[å®¹é‡å•ä½ä¸ºå­—èŠ‚] jstat -gcoldcapacity : æŸ¥çœ‹è€å¹´ä»£å®¹é‡ 1234[root@master0 ~]# jstat -gcoldcapacity 19080 100 2 OGCMN OGCMX OGC OC YGC FGC FGCT GCT 40448.0 647168.0 73728.0 73728.0 20235 37 7.833 100.949 40448.0 647168.0 73728.0 73728.0 20235 37 7.833 100.949 jstat -gcpermcapacity : æŸ¥çœ‹permä¸­å¯¹è±¡çš„ä¿¡æ¯å’Œå®¹é‡ 1jdk1.8+ä»¥ä¸Šå»é™¤äº†è¯¥å‘½ä»¤ï¼Œå¦‚æœä½ å½“å‰ä½¿ç”¨çš„æ˜¯jdk1.7-ï¼Œé‚£ä¹ˆè‡ªè¡Œè°·æ­Œå§ jstat -compiler : æŸ¥çœ‹è™šæ‹Ÿæœºå®æ—¶ç¼–è¯‘çš„ä¿¡æ¯ 1234567891011[root@master0 ~]# jstat -compiler 19080Compiled Failed Invalid Time FailedType FailedMethod 2737 0 0 41.90 0 ---Compiled: ç¼–è¯‘ä»»åŠ¡æ‰§è¡Œæ•°é‡Failed: ç¼–è¯‘ä»»åŠ¡æ‰§è¡Œå¤±è´¥æ•°é‡Invalid: ç¼–è¯‘ä»»åŠ¡æ‰§è¡Œå¤±æ•ˆæ•°é‡Time: ç¼–è¯‘ä»»åŠ¡æ¶ˆè€—çš„æ—¶é—´FailedType: æœ€åä¸€ä¸ªç¼–è¯‘å¤±è´¥ä»»åŠ¡çš„ç±»å‹FailedMethod: æœ€åä¸€ä¸ªç¼–è¯‘å¤±è´¥çš„ä»»åŠ¡æ‰€åœ¨ç±»åŠæ–¹æ³• jstat -printcompilation : æŸ¥çœ‹è™šæ‹Ÿæœºå·²ç»ç¼–è¯‘è¿‡çš„æ–¹æ³• 123456789[root@master0 ~]# jstat -printcompilation 19080Compiled Size Type Method 2737 1562 1 sun/misc/FloatingDecimal dtoa---Compiled: ç¼–è¯‘ä»»åŠ¡çš„æ•°é‡Size: æ–¹æ³•ç”Ÿæˆå­—èŠ‚ç çš„å¤§å°ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰Type: ç¼–è¯‘ç±»å‹Method: ç±»åå’Œæ–¹æ³•åç”¨æ¥æ ‡è¯†ç¼–è¯‘çš„æ–¹æ³•","categories":[{"name":"Java","slug":"Java","permalink":"http://luxiaowan.github.io/categories/Java/"}],"tags":[]},{"title":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨::listç¯‡","slug":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”listç¯‡","date":"2019-10-31T04:55:00.000Z","updated":"2019-10-31T17:23:56.890Z","comments":true,"path":"2019/10/31/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”listç¯‡/","link":"","permalink":"http://luxiaowan.github.io/2019/10/31/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”listç¯‡/","excerpt":"","text":"Redisæœ‰6å¤§åŸºæœ¬ç±»å‹ï¼Œåˆ†åˆ«æ˜¯å­—ç¬¦ä¸²(String)ã€åˆ—è¡¨(List)ã€é›†åˆ(set)ã€å“ˆå¸Œç»“æ„(hash)ã€æœ‰åºé›†åˆ(zset)å’ŒåŸºæ•°(HyperLogLog) redisåœ¨çº¿ä½“éªŒåœ°å€ï¼šhttp://try.redis.io/ åˆ—è¡¨(List) ä»‹ç»: Redisçš„åˆ—è¡¨å°±æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾€åˆ—è¡¨çš„å¤´éƒ¨å’Œå°¾éƒ¨æ·»åŠ æ–°æ•°æ®ï¼Œè¦å¯ä»¥æ ¹æ®ä¸‹æ ‡ä¿®æ”¹ä¸‹æ ‡å¯¹åº”çš„å€¼ï¼Œåˆ—è¡¨æ˜¯æŒ‰ç…§æ’å…¥é¡ºåºæœ‰åºçš„ï¼ˆæŒ‰æ’å…¥é¡ºåºå€’åºï¼Œç±»ä¼¼äºæ ˆï¼‰ï¼Œå¹¶ä¸”åˆ—è¡¨å¯ä»¥å‡ºç°é‡å¤æ•°æ®ã€‚å¯ä»¥åšæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯å¯èƒ½éœ€è¦æ¶ˆæ¯å»é‡(åé¢æœ‰æ›´ç‰›çš„)ã€‚ åˆ›å»ºç¼“å­˜ åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ç¼“å­˜ å‘½ä»¤æ ¼å¼ï¼šlpush key value [value ...] ğŸŒ° 1234lpush c1 1 2 3 4 5 6 7 8 9---å°†1~9æ”¾å…¥c1åˆ—è¡¨ä¸­ï¼Œæ­¤æ—¶åˆ—è¡¨ä¸­å­˜å‚¨é¡ºåºä¸º9 8 7 6 5 4 3 2 1 å‘åˆ—è¡¨å·¦ä¾§æ–°å¢å€¼ å‘½ä»¤æ ¼å¼ï¼šlpush key value [value ...] ğŸŒ° 1234lpush c1 10---å°†10æ”¾å…¥åˆ°c1åˆ—è¡¨å¤´éƒ¨ï¼Œæ­¤æ—¶åˆ—è¡¨ä¸­å­˜å‚¨é¡ºåºä¸º10 9 8 7 6 5 4 3 2 1 å‘åˆ—è¡¨å³ä¾§æ–°å¢å€¼ å‘½ä»¤æ ¼å¼ï¼šrpush key value [value ...] ğŸŒ° 1234rpush c1 0---å°†0æ”¾å…¥åˆ°c1åˆ—è¡¨å°¾éƒ¨ï¼Œæ­¤æ—¶åˆ—è¡¨ä¸­å­˜å‚¨é¡ºåºä¸º10 9 8 7 6 5 4 3 2 1 0 ä»¥ä¸Šä¸¤ä¸ªå‘½ä»¤å¾ˆå®¹æ˜“ç†è§£ï¼Œlpushâ€”&gt;left push, rpushâ€”&gt;right push åœ¨åˆ—è¡¨æŒ‡å®šå…ƒç´ å‰/åæ’å…¥æ•°æ® å‘½ä»¤æ ¼å¼ï¼šlinsert key BEFORE|AFTER pivot value ğŸŒ° 123456789101112131415161718192021221) linsert c1 after 0 -1---å°†-1æ’å…¥åˆ°å…ƒç´ å€¼0ä¹‹å‰ï¼Œæ­¤æ—¶åˆ—è¡¨ä¸­å­˜å‚¨é¡ºåºä¸º10 9 8 7 6 5 4 3 2 1 0 -12)linsert c1 before 0 1---å°†1æ’å…¥åˆ°å…ƒç´ å€¼0ä¹‹å‰ï¼Œæ­¤æ—¶åˆ—è¡¨ä¸­å­˜å‚¨é¡ºåºä¸º10 9 8 7 6 5 4 3 2 1 1 0 -13)linsert c1 before 1 3---å°†3æ’å…¥åˆ°å…ƒç´ å€¼1ä¹‹å‰ï¼Œæ­¤æ—¶åˆ—è¡¨ä¸­å­˜å‚¨é¡ºåºä¸º10 9 8 7 6 5 4 3 2 3 1 1 0 -14)linsert c1 after 1 4---å°†4æ’å…¥åˆ°å…ƒç´ å€¼1ä¹‹åï¼Œæ­¤æ—¶åˆ—è¡¨ä¸­å­˜å‚¨é¡ºåºä¸º10 9 8 7 6 5 4 3 2 3 1 4 1 0 -15)linsert c1 after 99 100---å¤±è´¥** ç”±3ã€4æ“ä½œå¯ä»¥å¾—å‡ºç»“è®ºï¼Œå½“æ‰§è¡ŒlinsertæŒ‡ä»¤æ—¶ï¼Œåˆ—è¡¨æ˜¯ä»å¤´éƒ¨å¼€å§‹è¿›è¡Œéå†ï¼Œç›´åˆ°æŸ¥è¯¢åˆ°ä¸pivotå…ƒç´ ç›¸åŒçš„å€¼æ—¶åœæ­¢ï¼Œæ ¹æ®AFTERã€BEFOREé€‰æ‹©æ˜¯æ’å…¥åˆ°å…ƒç´ åè¿˜æ˜¯å…ƒç´ å‰ï¼Œæ‰€ä»¥åˆ’é‡ç‚¹ï¼šè‹¥åˆ—è¡¨ä¸­å­˜åœ¨pivotçš„é‡å¤å…ƒç´ ï¼Œlinsertåªä¼šä»¥ç¬¬ä¸€ä¸ªéå†åˆ°çš„å…ƒç´ ä¸ºå‡†** ç”±5å¯ä»¥å¾—å‡ºç»“è®ºï¼Œè‹¥æŒ‡å®šçš„pivotå…ƒç´ ä¸å­˜åœ¨äºåˆ—è¡¨ä¸­ï¼Œåˆ™ä¸è¿›è¡Œä»»ä½•è®¾ç½® é€šè¿‡ç´¢å¼•ä¸‹æ ‡è®¾ç½®å€¼ å‘½ä»¤æ ¼å¼ï¼šlset key index value ğŸŒ° 12345671)lset c1 0 21---å°†ä¸‹æ ‡ä¸º0çš„å…ƒç´ ä¿®æ”¹ä¸º21ï¼Œæ­¤æ—¶åˆ—è¡¨ä¸­å­˜å‚¨é¡ºåºä¸º21 9 8 7 6 5 4 3 2 3 1 4 1 0 -12)lset c1 99 99---ERR index out of range,è¯´æ˜é€šè¿‡lsetå‘½ä»¤ï¼Œä¸èƒ½è¶Šç•Œä¿®æ”¹å…ƒç´  å‘å·²å­˜åœ¨çš„åˆ—è¡¨å¤´éƒ¨æ·»åŠ å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šlpushx key value [value ...] ğŸŒ° 12345671)lpushx c1 22 23 24---å°†22ã€23ã€24æ·»åŠ åˆ°åˆ—è¡¨c1å¤´éƒ¨ï¼Œåˆ—è¡¨å˜ä¸ºï¼š24 23 22 21 9 8 7 6 5 4 3 2 3 1 4 1 0 -12)lpushx c2 1 2 3---å› ä¸ºåˆ—è¡¨c2ä¸å­˜åœ¨ï¼Œæ‰€ä»¥è®¾ç½®å¤±è´¥ï¼Œæ­¤æ—¶ä½¿ç”¨lrangeæŸ¥çœ‹c2ä¼šè¿”å›ç©º å‘å·²å­˜åœ¨çš„åˆ—è¡¨å°¾éƒ¨æ·»åŠ å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šrpushx key value [value ...] ğŸŒ° 12345671)rpushx c1 -2 -3---å°†-2ã€-3æ·»åŠ åˆ°åˆ—è¡¨c1å°¾éƒ¨ï¼Œåˆ—è¡¨å˜ä¸ºï¼š24 23 22 21 9 8 7 6 5 4 3 2 3 1 4 1 0 -1 -2 -32)rpushx c2 1 2 3---å› ä¸ºåˆ—è¡¨c2ä¸å­˜åœ¨ï¼Œæ‰€ä»¥è®¾ç½®å¤±è´¥ï¼Œæ­¤æ—¶ä½¿ç”¨lrangeæŸ¥çœ‹c2ä¼šè¿”å›ç©º æˆªå–åˆ—è¡¨ å‘½ä»¤æ ¼å¼ï¼šltrim key start end ğŸŒ° 123ltrim c1 4 16---åˆ—è¡¨ä¸‹æ ‡ä»0å¼€å§‹ï¼Œæˆªå–5~17ä½çš„å…ƒç´ ï¼Œåˆ—è¡¨c1å˜ä¸ºï¼š9 8 7 6 5 4 3 2 3 1 4 1 0 æŸ¥çœ‹ç¼“å­˜ æŸ¥çœ‹åˆ—è¡¨å†…æ‰€æœ‰å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šlrange key 0 -1 ğŸŒ° 1234lrange c1 0 -1---è·å–åˆ—è¡¨c1çš„æ‰€æœ‰å…ƒç´  æŸ¥çœ‹åˆ—è¡¨æŸä¸€èŒƒå›´å†…çš„å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šlrange key start end ğŸŒ° 1234lrange c1 1 3---æŸ¥çœ‹åˆ—è¡¨c1ä¸­å¼Ÿ2~4ä½ä¸Šçš„å…ƒç´  å¼¹å‡ºåˆ—è¡¨å¤´éƒ¨å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šlpop key ğŸŒ° 1234lpop c1---å¼¹å‡ºåˆ—è¡¨c1çš„å¤´éƒ¨å…ƒç´ 9ï¼Œæ­¤æ—¶åˆ—è¡¨c1å˜ä¸ºï¼š8 7 6 5 4 3 2 3 1 4 1 0ï¼Œå¤´éƒ¨çš„9å·²ç»æ²¡æœ‰äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆé€‚åˆåšæ¶ˆæ¯é˜Ÿåˆ— å¼¹å‡ºåˆ—è¡¨å°¾éƒ¨å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šrpop key ğŸŒ° 1234rpop c1---å¼¹å‡ºc1çš„å°¾éƒ¨å…ƒç´ 0ï¼Œæ­¤æ—¶åˆ—è¡¨c1å˜ä¸ºï¼š8 7 6 5 4 3 2 3 1 4 1ï¼Œå°¾éƒ¨çš„0å·²ç»æ²¡æœ‰äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆé€‚åˆåšæ¶ˆæ¯é˜Ÿåˆ—ğŸ‘€ å¼¹å‡ºåˆ—è¡¨å¤´éƒ¨å…ƒç´ ï¼Œè‹¥å½“å‰åˆ—è¡¨å†…æ— å…ƒç´ ï¼Œåˆ™é˜»å¡ï¼Œç›´åˆ°è·å–åˆ°æˆ–è¾¾åˆ°è¶…æ—¶æ—¶é—´ å‘½ä»¤æ ¼å¼ï¼šblpop key [key ...] timeout timeoutå•ä½ä¸º***ç§’*** ğŸŒ° 12345blpop c1 c2 c3 10---å¼¹å‡ºåˆ—è¡¨c1æˆ–åˆ—è¡¨c2/c3çš„å¤´éƒ¨å…ƒç´ ï¼Œåªè¦c1ã€c2ã€c3æœ‰ä¸€ä¸ªåˆ—è¡¨ä¸­æœ‰å…ƒç´ è¢«å¼¹å‡ºï¼Œåˆ™ç»“æŸé˜»å¡è‹¥c1ã€c2ã€c3å‡æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³å¼¹å‡ºæ¡ä»¶çš„åˆ—è¡¨ï¼Œç„¶åç»“æŸé˜»å¡ å¼¹å‡ºåˆ—è¡¨å°¾éƒ¨å…ƒç´ ï¼Œè‹¥å½“å‰åˆ—è¡¨å†…æ— å…ƒç´ ï¼Œåˆ™é˜»å¡ï¼Œç›´åˆ°è·å–åˆ°æˆ–è¾¾åˆ°è¶…æ—¶æ—¶é—´ å‘½ä»¤æ ¼å¼ï¼šbrpop key [key ...] timeout timeoutå•ä½ä¸º***ç§’*** ğŸŒ° 12345blpop c1 c2 c3 10---å¼¹å‡ºåˆ—è¡¨c1æˆ–åˆ—è¡¨c2/c3çš„å°¾éƒ¨å…ƒç´ ï¼Œåªè¦c1ã€c2ã€c3æœ‰ä¸€ä¸ªåˆ—è¡¨ä¸­æœ‰å…ƒç´ è¢«å¼¹å‡ºï¼Œåˆ™ç»“æŸé˜»å¡è‹¥c1ã€c2ã€c3å‡æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³å¼¹å‡ºæ¡ä»¶çš„åˆ—è¡¨ï¼Œç„¶åç»“æŸé˜»å¡ è·å–åˆ—è¡¨æŒ‡å®šä½ç½®çš„å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šlindex key index ğŸŒ° 12345671)lindex c1 2---è¿”å›åˆ—è¡¨c1ä¸­ä¸‹æ ‡ä¸º2çš„å…ƒç´ ï¼Œä»…ä»…è¿”å›æ•°æ®ï¼Œä¸å¼¹å‡ºï¼Œæ—¶é—´å¤æ‚åº¦O(1)2)lindex c1 -1---è¿”å›åˆ—è¡¨æœ€åä¸€ä¸ªå…ƒç´ ã€‚åˆ—è¡¨å…ƒç´ ä¸‹æ ‡-1ä»£è¡¨åˆ—è¡¨ä¸­æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥åˆ—è¡¨æ˜¯å¯ä»¥é€šè¿‡è´Ÿæ•°ä¸‹æ ‡ä»åå¾€å‰éå† å¼¹å‡ºä¸€ä¸ªåˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ åˆ°å¦å¤–ä¸€ä¸ªåˆ—è¡¨å¤´éƒ¨ï¼Œå¹¶è¿”å›è¿™ä¸ªå…ƒç´ â€”â€”æ— é˜»å¡ å‘½ä»¤æ ¼å¼ï¼šrpoplpush source_key destination_key ğŸŒ° 1234rpoplpush c1 c2---å¼¹å‡ºåˆ—è¡¨c1çš„å°¾éƒ¨å…ƒç´ æ’å…¥åˆ°åˆ—è¡¨c2çš„å¤´éƒ¨ï¼Œè‹¥c1ä¸ºç©ºï¼Œåˆ™è¿”å›nilï¼Œä½†ä¸æ’å…¥åˆ°c2ä¸­ï¼Œæ˜¯ä¸æ˜¯æ›´é€‚åˆåšé˜Ÿåˆ— å¼¹å‡ºä¸€ä¸ªåˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ åˆ°å¦å¤–ä¸€ä¸ªåˆ—è¡¨å¤´éƒ¨ï¼Œå¹¶è¿”å›è¿™ä¸ªå…ƒç´ â€”â€”é˜»å¡ å‘½ä»¤æ ¼å¼ï¼šbrpoplpush source_key destination_key timeout timeoutå•ä½ä¸º***ç§’*** ğŸŒ° 1234brpoplpush c3 c2 10---å¼¹å‡ºåˆ—è¡¨c3çš„å°¾éƒ¨å…ƒç´ æ’å…¥åˆ°åˆ—è¡¨c2çš„å¤´éƒ¨ï¼Œè‹¥c3ä¸ºç©ºï¼Œåˆ™é˜»å¡ç­‰åˆ°åˆ—è¡¨c3ä¸­æœ‰å€¼ï¼Œå¦åˆ™ç­‰åˆ°äº†10ç§’åç»“æŸé˜»å¡è¿”å›nilï¼Œæ˜¯ä¸æ˜¯æ›´é€‚åˆåšé˜»å¡é˜Ÿåˆ— å…¶ä»–å‘½ä»¤ åˆ é™¤æŒ‡å®šèŒƒå›´å†…ç­‰äºæŸä¸ªå€¼çš„æ‰€æœ‰å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šlrem key index element ğŸŒ° 1234567891011121314151)lrem c1 -2 3---ç§»é™¤åˆ—è¡¨c1ä¸­ï¼Œä»å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ åˆ°åˆ—è¡¨å¤´éƒ¨èŒƒå›´å†…æ‰€æœ‰çš„32)lrem c1 3 2---ç§»é™¤åˆ—è¡¨c1ä¸­ï¼Œä»ç¬¬å››ä½å…ƒç´ åˆ°å°¾éƒ¨èŒƒå›´å†…æ‰€æœ‰çš„23)lrem c1 0 1---ç§»é™¤åˆ—è¡¨c1ä¸­æ‰€æœ‰çš„14)lrem c1 -1 4---ç§»é™¤åˆ—è¡¨c1ä¸­æ‰€æœ‰çš„4 æŸ¥çœ‹åˆ—è¡¨é•¿åº¦ å‘½ä»¤æ ¼å¼ï¼šllen key ğŸŒ° 1234llen c1---æŸ¥çœ‹åˆ—è¡¨c1çš„æ€»é•¿åº¦ï¼Œè‹¥c1ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›0ï¼Œä¸ä¼šæŠ¥é”™ï¼Œè®°ä½ï¼Œè‹¥åˆ—è¡¨ä¸å­˜åœ¨ä¹Ÿä¸ä¼šæŠ¥é”™","categories":[{"name":"Redis","slug":"Redis","permalink":"http://luxiaowan.github.io/categories/Redis/"}],"tags":[]},{"title":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨::setç¯‡","slug":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”setç¯‡","date":"2019-10-31T04:55:00.000Z","updated":"2019-11-10T15:57:22.418Z","comments":true,"path":"2019/10/31/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”setç¯‡/","link":"","permalink":"http://luxiaowan.github.io/2019/10/31/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”setç¯‡/","excerpt":"","text":"Redisæœ‰6å¤§åŸºæœ¬ç±»å‹ï¼Œåˆ†åˆ«æ˜¯å­—ç¬¦ä¸²(String)ã€åˆ—è¡¨(List)ã€é›†åˆ(set)ã€å“ˆå¸Œç»“æ„(hash)ã€æœ‰åºé›†åˆ(zset)å’ŒåŸºæ•°(HyperLogLog) redisåœ¨çº¿ä½“éªŒåœ°å€ï¼šhttp://try.redis.io/ é›†åˆ(Set) ä»‹ç»: Redisçš„é›†åˆå°±æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²é›†åˆï¼Œè¯¥é›†åˆæ˜¯æ— åºçš„ï¼Œä¸”é›†åˆå†…çš„å…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯é›†åˆå†…ä¸ä¼šå‡ºç°é‡å¤å…ƒç´ ã€‚Redisä¸­çš„é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨æ¥å®ç°çš„ï¼Œæ‰€ä»¥è·å–é›†åˆä¸­å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚ åˆ›å»ºç¼“å­˜ åˆ›å»ºä¸€ä¸ªé›†åˆç¼“å­˜ï¼Œä¸ºé›†åˆæ–°å¢å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šsadd key member [member ...] ğŸŒ° 1234sadd s1 1 2 3 0 -1 redis mongodb zookeeper---åˆ›å»ºé›†åˆs1,å…ƒç´ ä¸ºï¼š1 2 3 0 -1 redis mongodb zookeeper ç§»é™¤å…ƒç´  éšæœºç§»é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›è¿™ä¸ªå…ƒç´  å‘½ä»¤æ ¼å¼ï¼šspop key ğŸŒ° 1234spop s1---ç§»é™¤ä¹‹åï¼Œé›†åˆs1ä¸­å°±æ²¡æœ‰è¿™ä¸ªå…ƒç´ äº† æŒ‡å®šç§»é™¤é›†åˆä¸­ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  å‘½ä»¤æ ¼å¼ï¼šsrem key member [member ...] ğŸŒ° 1234srem s1 -1 0 99---å°†å…ƒç´ -1ã€0ã€99ä»é›†åˆs1ä¸­ç§»é™¤ï¼Œä»…ç§»é™¤é›†åˆä¸­å­˜åœ¨çš„å…ƒç´  æŸ¥è¯¢é›†åˆ æŸ¥è¯¢é›†åˆä¸­å…ƒç´ ä¸ªæ•° å‘½ä»¤æ ¼å¼ï¼šscard key ğŸŒ° 1234scard s1---è¿”å›é›†åˆs1ä¸­å…ƒç´ æ€»ä¸ªæ•° è¿”å›é›†åˆä¸­æ‰€æœ‰å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šsmembers key ğŸŒ° 1234smembers s1---è¿”å›é›†åˆs1ä¸­æ‰€æœ‰çš„å…ƒç´  éšæœºè¿”å›é›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  å‘½ä»¤æ ¼å¼ï¼šsrandmember key [count] ğŸŒ° 1234srandmember s1 10---éšæœºè¿”å›é›†åˆs1ä¸­çš„10ä¸ªå…ƒç´ ï¼Œè‹¥ä¸æŒ‡å®šæ•°é‡ï¼Œåˆ™é»˜è®¤è¿”å›ä¸€ä¸ªå…ƒç´  è¿­ä»£é›†åˆä¸­çš„å…ƒç´  å‘½ä»¤æ ¼å¼ï¼šsscan key cursor [MATCH pattern] [COUNT count] ğŸŒ° 1234sscan s1 0 match re* count 1---è¿­ä»£é›†åˆä¸­reå¼€å¤´çš„æ‰€æœ‰å…ƒç´ ï¼Œæ¯æ¬¡è¿”å›1ä¸ª åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ å‘½ä»¤æ ¼å¼ï¼šsismember key member ğŸŒ° 1234sismember s1 99---è‹¥99å­˜åœ¨äºs1ä¸­ï¼Œåˆ™è¿”å›1ï¼Œä¸å­˜åœ¨åˆ™è¿”å›0 å¤šé›†åˆä¹‹é—´æ“ä½œ æŸ¥çœ‹å¤šä¸ªé›†åˆçš„å·®é›† å‘½ä»¤æ ¼å¼ï¼šsdiff key [key ...] ğŸŒ° 1234sdiff s1 s2 s3---è¿”å›é›†åˆs1ç›¸å¯¹äºs2ã€s3çš„å·®é›†ï¼Œä¹Ÿå°±æ˜¯åªè¿”å›s1ä¸­æ‰€æœ‰ä¸å­˜åœ¨äºs2ã€s3ä¸­çš„æ‰€æœ‰å…ƒç´  å¤šä¸ªé›†åˆçš„å·®é›†å­˜å‚¨åˆ°æŒ‡å®šé›†åˆä¸­ å‘½ä»¤æ ¼å¼ï¼šsdiffstore destination key [key ...] ğŸŒ° 1234sdiffstore ds1 s1 s2 s3---å°†s1ä¸­ä¸å­˜åœ¨äºs2ã€s3ä¸­çš„å…ƒç´ å­˜å‚¨åˆ°é›†åˆds1ä¸­ æŸ¥çœ‹å¤šä¸ªé›†åˆçš„å¹¶é›†ï¼Œå»é‡ å‘½ä»¤æ ¼å¼ï¼šsunion key [key ...] ğŸŒ° 1234sunion s1 s2 s3---å°†é›†åˆs1ã€s2ã€s3çš„å…ƒç´ åˆå¹¶å»é‡åè¿”å›ï¼Œæ‰€æœ‰å…ƒç´ å‡å”¯ä¸€ å¤šä¸ªé›†åˆçš„å¹¶é›†å­˜å‚¨åˆ°æŒ‡å®šé›†åˆä¸­ å‘½ä»¤æ ¼å¼ï¼šsunionstore destination key [key ...] ğŸŒ° 1234sunionstore us1 s1 s2 s3---é›†åˆs1ã€s2ã€s3çš„å¹¶é›†å­˜å‚¨åˆ°é›†åˆus1ä¸­ï¼Œå¹¶è¿”å›é›†åˆus1ä¸­çš„å…ƒç´ ä¸ªæ•° å°†ä¸€ä¸ªé›†åˆä¸­çš„æŸå…ƒç´ ç§»åŠ¨åˆ°å¦ä¸€ä¸ªé›†åˆä¸­ å‘½ä»¤æ ¼å¼ï¼šsmove source destination member ğŸŒ° 1234smove s1 s2 -2---å°†s1ä¸­çš„å…ƒç´ -2ç§»åŠ¨åˆ°é›†åˆs2ä¸­ï¼Œè‹¥s2ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨åˆ›å»º æŸ¥çœ‹å¤šä¸ªé›†åˆçš„äº¤é›† å‘½ä»¤æ ¼å¼ï¼šsinter key [key ...]ï¼ˆintersectionï¼‰ ğŸŒ° 123456sinter s1 s3---è¿”å›é›†åˆs1å’Œé›†åˆs3çš„äº¤é›†ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªé›†åˆä¸­éƒ½å­˜åœ¨çš„æ•°æ®å®é™…åº”ç”¨ï¼šæŸ¥çœ‹ä¸¤ä¸ªäººçš„å…±åŒå¥½å‹ï¼›å¾®ä¿¡é‡ŒæŸ¥çœ‹å’Œå¥½å‹çš„å…±åŒç¾¤ å¤šä¸ªé›†åˆçš„äº¤é›†å­˜å‚¨åˆ°æŒ‡å®šé›†åˆä¸­ å‘½ä»¤æ ¼å¼ï¼šsinterstore destination key [key ...] ğŸŒ° 1234sinterstore is1 s1 s3---å°†s1å’Œs3çš„äº¤é›†å…ƒç´ å­˜å‚¨åˆ°é›†åˆis1ä¸­","categories":[{"name":"Redis","slug":"Redis","permalink":"http://luxiaowan.github.io/categories/Redis/"}],"tags":[]},{"title":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨::hashç¯‡","slug":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”hashç¯‡","date":"2019-10-30T15:55:00.000Z","updated":"2019-10-31T16:05:56.510Z","comments":true,"path":"2019/10/30/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”hashç¯‡/","link":"","permalink":"http://luxiaowan.github.io/2019/10/30/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”hashç¯‡/","excerpt":"","text":"Redisæœ‰6å¤§åŸºæœ¬ç±»å‹ï¼Œåˆ†åˆ«æ˜¯å­—ç¬¦ä¸²(String)ã€åˆ—è¡¨(List)ã€é›†åˆ(set)ã€å“ˆå¸Œç»“æ„(hash)ã€æœ‰åºé›†åˆ(zset)å’ŒåŸºæ•°(HyperLogLog) redisåœ¨çº¿ä½“éªŒåœ°å€ï¼šhttp://try.redis.io/ å“ˆå¸Œ(Hash) ä»‹ç»: Redis hash æ˜¯ä¸€ä¸ªå­˜å‚¨å¤šä¸ªé”®å€¼å¯¹çš„æ˜ å°„è¡¨ï¼Œé€‚ç”¨äºå­˜å‚¨å¯¹è±¡çš„å±æ€§ï¼Œæ¯”å¦‚å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€ç”¨æˆ·Sessionä¿¡æ¯ç­‰ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨çš„é¢‘ç‡æ¯”è¾ƒå¤šï¼Œä¹‹å‰ä¸»è¦ç”¨äºå­˜å‚¨ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€ç”¨æˆ·ä¸´æ—¶è®¢å•ä¿¡æ¯ã€äº§å“ä¿¡æ¯ç­‰ã€‚ åˆ›å»ºç¼“å­˜ åˆ›å»ºä¸€ä¸ªç¼“å­˜ å‘½ä»¤æ ¼å¼ï¼šhset key field value ğŸŒ° 1234hset cc name 'cc'---å°†ccçš„nameå±æ€§çš„å€¼è®¾ç½®ä¸ºcc æ‰¹é‡åˆ›å»ºç¼“å­˜ å‘½ä»¤æ ¼å¼ï¼šhmset key filed value [field value ...] ğŸŒ° 1234hmset cc name 'cc' age 19 avatar 'a.png' status 1---è®¾ç½®ccå¯¹è±¡çš„nameã€ageã€avatarã€statuså±æ€§çš„å€¼ è®¾ç½®ä¸€ä¸ªkeyä¸å­˜åœ¨fieldçš„valueï¼Œè‹¥fieldå·²å­˜åœ¨åˆ™ä¸è®¾ç½® å‘½ä»¤æ ¼å¼ï¼šhsetnx key field value ğŸŒ° 1234hsetnx cc name 'yy'---è‹¥å¯¹è±¡ccçš„nameå±æ€§ä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®ccçš„nameå±æ€§å€¼ä¸ºyy æŸ¥çœ‹ç¼“å­˜ æŸ¥çœ‹keyä¸‹æ‰€æœ‰å±æ€§+å€¼ å‘½ä»¤æ ¼å¼ï¼šhgetall key ğŸŒ° 12345678hgetall cc---è·å–å¯¹è±¡ccçš„æ‰€æœ‰å±æ€§ï¼Œè¿”å›æ•°æ®æ ¼å¼ï¼š field1 value1 field2 value2 æŸ¥çœ‹keyä¸‹æ‰€æœ‰çš„å€¼ å‘½ä»¤æ ¼å¼ï¼šhvals key ğŸŒ° 12345hvals cc---è¿”å›ccå¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„å€¼ï¼Œä»…è¿”å›å€¼ï¼Œä¸è¿”å›å±æ€§åç§°ç­‰åŒäº â€hmget key æ‰€æœ‰fieldâ€œ å‘½ä»¤ æŸ¥çœ‹keyä¸‹æ‰€æœ‰çš„fieldåç§° å‘½ä»¤æ ¼å¼ï¼šhkeys key ğŸŒ° 1234hkeys cc---è¿”å›å¯¹è±¡ccçš„æ‰€æœ‰å±æ€§å æŸ¥çœ‹keyçš„æŸä¸€fieldçš„å€¼ å‘½ä»¤æ ¼å¼ï¼šhget key field ğŸŒ° 1234hget cc name---è¿”å›å¯¹è±¡ccçš„nameå±æ€§çš„å€¼ï¼Œè‹¥å¯¹è±¡æ— æ­¤å±æ€§ï¼Œåˆ™è¿”å›nil æŸ¥çœ‹keyçš„å¤šä¸ªfieldçš„å€¼ å‘½ä»¤æ ¼å¼ï¼šhmget key field [field ...] ğŸŒ° 1234hmget cc name age status---è¿”å›å¯¹è±¡ccçš„nameã€ageã€statuså±æ€§ è¿­ä»£å¯¹è±¡çš„æ‰€æœ‰å±æ€§(é€‚ç”¨äºå¤§å¯¹è±¡) å‘½ä»¤æ ¼å¼ï¼šhscan key course [MATCH pattern] [COUNT num] ğŸŒ° 1hscan cc 0 MATCH *e COUNT 1 æŸ¥çœ‹å¯¹è±¡çš„å±æ€§æ•° å‘½ä»¤æ ¼å¼ï¼šhlen key ğŸŒ° 1234hlen cc---è¿”å›å¯¹è±¡ccçš„å±æ€§æ•°é‡ å…¶ä»–å‘½ä»¤ åˆ é™¤ä¸€ä¸ª/å¤šä¸ªå±æ€§ å‘½ä»¤æ ¼å¼ï¼šhdel key field [field ...] ğŸŒ° 1234hdel cc name age---åˆ é™¤å¯¹è±¡ccçš„nameã€ageå±æ€§ æŸ¥çœ‹å¯¹è±¡å±æ€§æ˜¯å¦å­˜åœ¨ å‘½ä»¤æ ¼å¼ï¼šhexists key field ğŸŒ° 1234hexists cc name---å¯¹è±¡ccè‹¥å­˜åœ¨å±æ€§nameï¼Œåˆ™è¿”å›1ï¼Œä¸å­˜åœ¨åˆ™è¿”å›0","categories":[{"name":"Redis","slug":"Redis","permalink":"http://luxiaowan.github.io/categories/Redis/"}],"tags":[]},{"title":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨::stringç¯‡","slug":"RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”stringç¯‡","date":"2019-10-29T15:55:00.000Z","updated":"2019-10-30T16:43:50.550Z","comments":true,"path":"2019/10/29/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”stringç¯‡/","link":"","permalink":"http://luxiaowan.github.io/2019/10/29/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”stringç¯‡/","excerpt":"","text":"Redisæœ‰6å¤§åŸºæœ¬ç±»å‹ï¼Œåˆ†åˆ«æ˜¯å­—ç¬¦ä¸²(String)ã€åˆ—è¡¨(List)ã€é›†åˆ(set)ã€å“ˆå¸Œç»“æ„(hash)ã€æœ‰åºé›†åˆ(zset)å’ŒåŸºæ•°(HyperLogLog) redisåœ¨çº¿ä½“éªŒåœ°å€ï¼šhttp://try.redis.io/ å­—ç¬¦ä¸²(String) ä»‹ç»: å­—ç¬¦ä¸²æ˜¯Redisä¸­æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œæ•°æ®ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å­˜å‚¨äºå†…å­˜ä¸­ï¼Œæ‰€ä»¥Redisçš„å­—ç¬¦ä¸²å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„æ•°æ®ï¼Œæ¯”å¦‚JPEGå›¾åƒã€åºåˆ—åŒ–çš„Rubyå¯¹è±¡ç­‰ã€‚ å­—ç¬¦ä¸²æœ€å¤§å¯å­˜å‚¨512MBçš„æ•°æ®ï¼Œä½†ä¸€èˆ¬ä¸€ä¸ªå­—ç¬¦ä¸²å®¹é‡è¿‡å¤§ï¼Œä¼šç›´æ¥å½±å“å­˜å‚¨å’ŒæŸ¥è¯¢çš„æ•ˆç‡ã€‚å­—ç¬¦ä¸²æœ‰ä¸¤ç§ç¼–ç æ–¹å¼ï¼šrawå’Œembstrï¼Œæ ¹æ®å­—ç¬¦ä¸²é•¿åº¦è‡ªåŠ¨é€‰æ‹©ä½¿ç”¨å“ªä¸€ç§ç¼–ç ï¼Œç›®å‰æœ€æ–°ç‰ˆçš„é•¿åº¦æ˜¯44ä¸ªå­—èŠ‚ï¼Œå­—ç¬¦ä¸²é•¿åº¦å°äºç­‰äº44ä¸ªå­—èŠ‚ï¼Œåˆ™ä½¿ç”¨embstrç¼–ç ï¼Œå¤§äº44ä¸ªå­—èŠ‚åˆ™ä½¿ç”¨rawç¼–ç ï¼Œä¸¤ç§ç¼–ç æ–¹å¼è¿™é‡Œå°±ä¸ä½œè¯¦è§£ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è°·æ­Œä¸€ä¸‹ã€‚ åˆ›å»ºç¼“å­˜ åˆ›å»ºä¸€ä¸ªç¼“å­˜ å‘½ä»¤æ ¼å¼ï¼šset key value ğŸŒ° 1234set cc 'niubility'---åˆ›å»ºä¸€ä¸ªkeyä¸ºccï¼Œå€¼ä¸ºniubilityçš„ç¼“å­˜ æ‰¹é‡åˆ›å»ºç¼“å­˜ å‘½ä»¤æ ¼å¼ï¼šmset key value [key value ...] ğŸŒ° 1234mset cc1 1 cc2 2 cc3 3---åˆ›å»ºä¸‰ä¸ªç¼“å­˜ï¼Œkey:valueåˆ†åˆ«ä¸ºcc1:1, cc2:2, cc3:3 å‘½ä»¤æ ¼å¼ï¼šmsetnx key value [key value ...] ğŸŒ° 12345msetnx cc1 11 cc2 22 cc5 5 cc6 6---æ­¤å‘½ä»¤åªä¼šå°†å°šä¸å­˜åœ¨çš„keyå€¼åˆ›å»ºåˆ°ç¼“å­˜ä¸­ï¼Œå·²ç»å­˜åœ¨çš„keyåˆ™å¿½ç•¥* cc1ã€cc2å·²å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œæ‰€ä»¥ä¸ä¼šåˆ›å»º/æ›´æ–°æˆåŠŸï¼Œcc5ã€cc6ä¸å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œä¼šåˆ›å»º åˆ›å»ºä¸€ä¸ªå¸¦è¿‡æœŸæ—¶é—´çš„ç¼“å­˜ å‘½ä»¤æ ¼å¼ï¼šsetex key time value ğŸŒ° 1234setex cc1 10 234---è®¾ç½®key:valueä¸ºcc1:234ä¸”è¿‡æœŸæ—¶é—´ä¸º10ç§’çš„ç¼“å­˜ è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨keyçš„valueï¼Œè‹¥keyå·²å­˜åœ¨åˆ™ä¸è®¾ç½® å‘½ä»¤æ ¼å¼ï¼šsetnx key value ğŸŒ° 1234setnx cc5 12---è‹¥cc5çš„keyä¸å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™åˆ›å»ºkey:valueä¸ºcc5:12çš„ç¼“å­˜ï¼Œå¦åˆ™ä¸æ‰§è¡Œåˆ›å»º ç»„åˆåˆ›å»ºä¸€ä¸ªç¼“å­˜(ç¼“å­˜è¿‡æœŸæ—¶é—´ã€æ˜¯å¦è¦†ç›–) å‘½ä»¤æ ¼å¼ï¼šset key value [EX|PX time] [NX|XX] è§£æï¼š 1234567 EXï¼šè¡¨æ˜è¿‡æœŸæ—¶é—´ä¸ºç§’ PXï¼šè¡¨æ˜è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’ NXï¼šè‹¥keyä¸å­˜åœ¨åˆ™æ‰§è¡Œï¼Œå¦åˆ™ä¸æ‰§è¡Œï¼Œä¸XXç›¸å XXï¼šè‹¥keyå­˜åœ¨åˆ™æ‰§è¡Œï¼Œå¦åˆ™ä¸æ‰§è¡Œï¼Œä¸NXç›¸å ğŸŒ° 1234 set cc1 123 EX 20 XX --- è‹¥cc1å·²å­˜åœ¨åˆ™åˆ›å»ºè¿‡æœŸæ—¶é—´ä¸º20ç§’çš„key:value = cc1:123 å°†keyè®¾ç½®ä¸ºæ–°å€¼çš„åŒæ—¶è¿”å›åŸå€¼ å‘½ä»¤æ ¼å¼ï¼šgetset key value ğŸŒ° 1234getset cc1 1---è‹¥keyä¸å­˜åœ¨ï¼Œåˆ™è¿”å›nil è¯»å–ç¼“å­˜ è¯»å–ä¸€ä¸ªkeyçš„ç¼“å­˜å€¼ å‘½ä»¤æ ¼å¼ï¼šget key ğŸŒ° 1234get cc1---è¯»å–key=cc1çš„å€¼ æ‰¹é‡è¯»å–ä¸€æ‰¹æ•°æ® å‘½ä»¤æ ¼å¼ï¼šmget key [key ...] ğŸŒ° 1mget cc1 cc2 cc3 æˆªå–å­—ç¬¦ä¸²å¹¶è¿”å› å‘½ä»¤æ ¼å¼ï¼šgetrange key start end ğŸŒ° 1234getrange cc1 1 12---å­—ç¬¦ä¸²ä¸‹æ ‡ä»¥0å¼€å§‹ï¼Œè‹¥startè¶…å‡ºå­—ç¬¦ä¸²é•¿åº¦æˆ–keyä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² å…¶ä»–æ“ä½œ å°†valueåŠ 1( valueå¿…é¡»ä¸ºæ•´æ•° )[ å¯ç”¨äºé˜…è¯»é‡ã€ç‚¹èµæ•°ç­‰ç®€å•ç»Ÿè®¡ç±»çš„åŠŸèƒ½åº”ç”¨ ] å‘½ä»¤æ ¼å¼ï¼šincr key ğŸŒ° 1234incr cc1---æ¯æ¬¡è°ƒç”¨å‡å¯¹valueè¿›è¡Œ+1æ“ä½œ ç»™valueåŠ ä¸ŠæŸä¸ªæ•°( numå¿…é¡»ä¸ºæ•´æ•° ) å‘½ä»¤æ ¼å¼ï¼šincrby key num ğŸŒ° 1234incrby cc1 100---ç»™cc1çš„å€¼åŠ ä¸Š100 ç»™valueåŠ ä¸ŠæŸä¸ªæµ®ç‚¹æ•° å‘½ä»¤æ ¼å¼ï¼šincrbyfloat key num ğŸŒ° 1incrbyfloat cc1 0.2 ç»™valueå‡1 å‘½ä»¤æ ¼å¼ï¼šdecr key ğŸŒ° 1234decr cc1---æ¯æ¬¡è°ƒç”¨å‡å¯¹valueè¿›è¡Œ-1æ“ä½œ ç»™valueå‡å»æŸä¸ªæ•°( numå¿…é¡»ä¸ºæ•´æ•° ) å‘½ä»¤æ ¼å¼ï¼šdescby key num ğŸŒ° 1234decrby cc1 100---ç»™cc1çš„å€¼å‡å»100 æŸ¥çœ‹valueçš„é•¿åº¦ å‘½ä»¤æ ¼å¼ï¼šstrlen key ğŸŒ° 1strlen cc1 ç›®å‰å…ˆæ•´ç†è¿™äº›ï¼Œéƒ½æ˜¯ä¸€äº›åŸºç¡€çš„å‘½ä»¤ï¼Œéšåå†å†™ä¸€ç¯‡Javaä¸­ä½¿ç”¨Jedisæ“ä½œå­—ç¬¦ä¸²çš„éšç¬”ã€‚","categories":[{"name":"Redis","slug":"Redis","permalink":"http://luxiaowan.github.io/categories/Redis/"}],"tags":[]},{"title":"Redisæ•°æ®åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„","slug":"Redisæ•°æ®åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„","date":"2019-10-29T08:50:00.000Z","updated":"2019-10-29T15:02:17.269Z","comments":true,"path":"2019/10/29/Redisæ•°æ®åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„/","link":"","permalink":"http://luxiaowan.github.io/2019/10/29/Redisæ•°æ®åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„/","excerpt":"","text":"","categories":[{"name":"Redis","slug":"Redis","permalink":"http://luxiaowan.github.io/categories/Redis/"}],"tags":[]},{"title":"MySQLç´¢å¼•ä»€ä¹ˆæ—¶å€™ç”¨hash","slug":"MySQLç´¢å¼•ä»€ä¹ˆæ—¶å€™ç”¨hash","date":"2019-10-28T11:06:00.000Z","updated":"2019-10-29T14:10:04.447Z","comments":true,"path":"2019/10/28/MySQLç´¢å¼•ä»€ä¹ˆæ—¶å€™ç”¨hash/","link":"","permalink":"http://luxiaowan.github.io/2019/10/28/MySQLç´¢å¼•ä»€ä¹ˆæ—¶å€™ç”¨hash/","excerpt":"","text":"MySQLç´¢å¼•æ˜¯åœ¨é¢è¯•ä¸­å¸¸è¢«é—®åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå¸¸ç”¨çš„ä¸¤ç§ç´¢å¼•æ–¹æ³•æœ‰Hashå’ŒB+Treeï¼Œæ ‘çš„ç»“æ„æˆ‘ä»¬æ”¹å¤©å†æ‰¯ï¼Œä»Šå¤©è¯´æ”¶Hashã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨hash Hashç´¢å¼•å¯ä»¥æ ¹æ®æ•°æ®çš„hashå€¼ç›´æ¥å®šä½åˆ°ç´¢å¼•æ•°æ®çš„å­˜å‚¨ä½ç½®ï¼Œå°±ç›¸å½“äºæˆ‘çŸ¥é“äº†æ•°ç»„çš„ä¸‹æ ‡ï¼Œç„¶åæ ¹æ®ä¸‹æ ‡å»å–æ•°æ®ï¼Œè¿™ä¸ªæ•ˆç‡å¯ä»¥è¯´æ˜¯æœ€é«˜çš„äº†ï¼Œä½¿ç”¨hashå°±æ˜¯ä¸ºäº†å¦‚æ­¤ã€‚ æ”¯æŒhashçš„å­˜å‚¨å¼•æ“ ç›®å‰æ”¯æŒhashçš„å¼•æ“æœ‰MEMORY(è¿™é‡Œéœ€è¦è°·æ­Œ)ï¼Œå…¶ä»–çš„å¼•æ“éƒ½é€šè¿‡å„è‡ªçš„æ–¹å¼å»æ”¯æŒhashæ–¹æ³•ã€‚å¦‚InnoDBæœ‰ä¸€å¥—è‡ªé€‚åº”hashç®—æ³•ï¼Œå†…éƒ¨å®ç°è¿˜æ˜¯é‡‡ç”¨äº†BTçš„æ–¹å¼ï¼Œå¯ä»¥ç†è§£ä¸ºBTç´¢å¼•çš„ç´¢å¼• InnoDBä¸­hashç´¢å¼•æ”¯æŒçš„å¼€å¯/å…³é—­ hashç´¢å¼•è™½ç„¶éå¸¸å¿«é€Ÿï¼Œä½†æ˜¯åœ¨InnoDBä¸­ç¡®å®æ”¯æŒçš„ä¸æ˜¯å¾ˆå¥½ï¼Œå¹¶ä¸”ç´¢å¼•çš„å…·ä½“åˆ›å»ºæ˜¯ç”±å¼•æ“å†³å®šçš„(åˆ›å»ºåå­˜åœ¨äºå†…å­˜ä¸­)ï¼ŒéDBAå¯æ§ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹å»ºè®®å…³é—­hashæ”¯æŒï¼Œä½¿ç”¨BTä¹Ÿèƒ½å¤Ÿæ»¡è¶³æ€§èƒ½è¦æ±‚ã€‚ â€‹ set global innodb_adaptive_hash_index=off/on hashçš„ä½¿ç”¨åœºæ™¯ hashä½¿ç”¨åœºæ™¯æ¯”è¾ƒå±€é™ hashç´¢å¼•ä»…é€‚ç”¨äºâ€˜=â€™ã€â€˜&lt;=&gt;â€™å’Œâ€˜inâ€™æ“ä½œï¼Œæ‰€ä»¥hashä»…ä»…é€‚ç”¨äºç²¾ç¡®æŸ¥æ‰¾ã€‚ ä¸é€‚ç”¨äºæŸ¥è¯¢æ’åºï¼Œå› ä¸ºhashåçš„æ•°æ®å¹¶ä¸ä¼šåƒåŸæ•°æ®ä¸€æ ·ä¿æŒæœ‰åºã€‚ ä¸é€‚ç”¨äºæ¨¡ç³ŠæŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½ä½¿ç”¨likeå…³é”®å­—ã€‚ æ—¢ç„¶ä¸æ”¯æŒæ’åºï¼Œä¹Ÿè‚¯å®šä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢å’¯ è§£å†³hashå†²çª ä¸è®ºhashçš„ç®—æ³•å¤šä¹ˆç²¾ç¡®ï¼Œå½“æ•°æ®é‡å¤§çš„æ—¶å€™éƒ½æœ‰å¯èƒ½å‘ç”Ÿhashç¢°æ’ï¼Œè§£å†³hashç¢°æ’çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å†hashã€é“¾è¡¨å åŠ ç­‰ï¼ŒMySQLé‡‡ç”¨çš„æ˜¯é“¾è¡¨å åŠ çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ç±»ä¼¼äºHashMapè§£å†³hashç¢°æ’çš„æ–¹æ³•ã€‚æ‰€ä»¥åœ¨å‘ç”Ÿhashç¢°æ’è¿‡å¤šçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨hashç´¢å¼•ä¼šå½±å“æŸ¥è¯¢æ€§èƒ½ã€‚","categories":[{"name":"MySQL","slug":"MySQL","permalink":"http://luxiaowan.github.io/categories/MySQL/"}],"tags":[]},{"title":"Spring-Sessionå’ŒRediså®ç°Sessionå…±äº«","slug":"Spring-Sessionå’ŒRediså®ç°Sessionå…±äº«","date":"2019-10-24T11:30:00.000Z","updated":"2019-10-24T15:18:45.220Z","comments":true,"path":"2019/10/24/Spring-Sessionå’ŒRediså®ç°Sessionå…±äº«/","link":"","permalink":"http://luxiaowan.github.io/2019/10/24/Spring-Sessionå’ŒRediså®ç°Sessionå…±äº«/","excerpt":"","text":"éœ€æ±‚ ç°åœ¨å¤§éƒ¨åˆ†æœåŠ¡éƒ½ä»¥é›†ç¾¤è´Ÿè½½å‡è¡¡çš„æ–¹å¼éƒ¨ç½²ï¼Œå‡ ä¹å¾ˆéš¾å†é‡åˆ°å•ç‚¹éƒ¨ç½²çš„é¡¹ç›®ï¼Œå› ä¸ºå¤§å®¶éƒ½è¦ä¿è¯æœ€åŸºæœ¬çš„HAï¼Œè¯´åˆ°HAï¼Œç¬¬ä¸€è¦è€ƒè™‘çš„å°±æ˜¯å„ç³»ç»Ÿä¹‹é—´çš„Sessionå…±äº«çš„é—®é¢˜ï¼Œå¦‚ä½•è§£å†³å‘¢ï¼Ÿè´Ÿè½½å‡è¡¡å½“å‰ä½¿ç”¨Nginx åˆ†æ ä¸åŒçš„PODä¹‹é—´å¦‚æœéœ€è¦è¾¾åˆ°æ•°æ®å…±äº«çš„ç›®çš„ï¼Œé‚£ä¹ˆåˆ™éœ€è¦ä½¿ç”¨åŒä¸€ä¸ªå­˜å‚¨åª’ä»‹ï¼Œä¸€å¼€å§‹æƒ³åˆ°ä½¿ç”¨MySQLæ¥å­˜å‚¨ç™»å½•sessionï¼Œä½†æ˜¯æ¯æ¬¡è¯·æ±‚éƒ½å»MySQLä¸­æŸ¥è¯¢æ•°æ®ï¼Œå¼€é”€è¿˜æ˜¯éå¸¸å¤§çš„ï¼›ç„¶åæœ€è¿‘ä½¿ç”¨MongoDBæ¯”è¾ƒå—¨ï¼Œæƒ³ç€ç”¨MongoDBï¼Œä½†æ˜¯MongoDBæŸ¥è¯¢èµ·æ¥ä¹Ÿä¸æ–¹ä¾¿ï¼Œå†µä¸”æˆ‘ä»¬è¿™ä¸ªSessionä¹Ÿä¸æ˜¯é‡çº§å¾ˆå¤§çš„æ•°æ®é›†ï¼Œæœ€ç»ˆé‡‡ç”¨äº†å†…å­˜çº§çš„Redisæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ä½¿ç”¨Redisçš„åŸºæœ¬æ“ä½œæ˜¯å°†jsessionIdä¸ºkeyï¼Œç”¨æˆ·ä¿¡æ¯ä¸ºvalueï¼Œä½¿ç”¨jedisæˆ–è€…redisTemplateæ¥æ“ä½œRedisçš„è¯»å†™è¡Œä¸ºã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¾µå…¥äº†ä¸šåŠ¡ä»£ç ï¼Œå¹¶ä¸æ˜¯æœ€ä¼˜è§£ï¼ŒæŸ¥äº†éƒ¨åˆ†èµ„æ–™ä¹‹åï¼Œå‘ç°spring-session.jaråŒ…ä¸­æœ‰ä¸€ä¸ªéå¸¸æœ‰ç‰¹è‰²çš„æ³¨è§£@EnableRedisHttpSessionï¼Œå¯ä»¥ä¸éœ€è¦ä¾µå…¥ä¸šåŠ¡ä»£ç å°±èƒ½ä½¿ç”¨rediså®ç°sessionå…±äº«çš„é—®é¢˜ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹@EnableRedisHttpSessionçš„æºç æ˜¯æ€ä¹ˆè¯´çš„ï¼š å°†æ­¤æ³¨é‡Šæ·»åŠ åˆ°ä¸€ä¸ªå•ç‹¬çš„ç±»ä¸Šï¼Œè¯¥ç±»å¿…é¡»åŠ ä¸Š@Configurationæ³¨è§£ã€‚ä½¿ç”¨æ–¹å¼åœ¨æ³¨é‡Šé‡Œä¹Ÿç»™å‡ºäº†demoä»£ç ã€‚ å®ç° ä¿®æ”¹pom.xmlæ–‡ä»¶ï¼Œå¼•å…¥æˆ‘ä»¬éœ€è¦çš„jaråŒ… 123456789101112&lt;dependency&gt; &lt;groupId&gt;org.springframework.session&lt;/groupId&gt; &lt;artifactId&gt;spring-session&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt; ä¿®æ”¹application.ymlæ–‡ä»¶ï¼Œé…ç½®redisä¿¡æ¯ 1234spring.redis.database=0spring.redis.host=localhostspring.redis.port=6379spring.redis.password=123456 åˆ›å»ºé…ç½®ç±» 1234567import org.springframework.context.annotation.Configuration;import org.springframework.session.data.redis.config.annotation.web.http.EnableRedisHttpSession;@Configuration@EnableRedisHttpSessionpublic class RedisHttpSessionConfig &#123;&#125; åˆ°æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨Rediså®ç°Sessionå…±äº«çš„æ‰€æœ‰é…ç½®å’Œä»£ç éƒ½å·²ç»å†™å®Œäº†ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ²¡æœ‰ä¾µå…¥åˆ°ä»»ä½•ä¸šåŠ¡ä»£ç ä¸­ï¼Œä»å¤´åˆ°å°¾ä¹Ÿå¾ˆç®€å•ã€‚ æ‰©å±• 1234@EnableGemFireHttpSession@EnableSpringHttpSession@EnableMongoHttpSession@EnableJdbcHttpSession","categories":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://luxiaowan.github.io/categories/SpringBoot/"}],"tags":[]},{"title":"Javaç®€å•æ“ä½œMongoDB","slug":"Javaç®€å•æ“ä½œMongoDB","date":"2019-10-24T02:16:00.000Z","updated":"2019-10-24T13:20:12.762Z","comments":true,"path":"2019/10/24/Javaç®€å•æ“ä½œMongoDB/","link":"","permalink":"http://luxiaowan.github.io/2019/10/24/Javaç®€å•æ“ä½œMongoDB/","excerpt":"","text":"å‰é¢å·²ç»æŒæ¡äº†mongoæœ€åŸºæœ¬çš„ä¸€äº›å‘½ä»¤ï¼Œå¯¹å„ä¸ªå‘½ä»¤ä¹Ÿéƒ½å®æ“è¿‡ï¼Œç†è§£å„å‘½ä»¤çš„æ„æ€ï¼Œä¹Ÿå¯¹mongoæœ‰äº†æœ€åŸºæœ¬çš„ç†è§£ï¼Œä½†å¤§éƒ¨åˆ†çŒ¿è¿˜æ˜¯æƒ³ä½¿ç”¨Javaå»è¿æ¥mongoï¼Œä¸²ä¸²ä¹Ÿä¸ä¾‹å¤– åœ¨pom.xmlä¸­åŠ å…¥mongodb-java-driver.jarçš„ä¾èµ– Mavené¡¹ç›®ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.mongodb&lt;/groupId&gt; &lt;artifactId&gt;mongo-java-driver&lt;/artifactId&gt; &lt;version&gt;3.0.4&lt;/version&gt;&lt;/dependency&gt; SpringBooté¡¹ç›®ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;&lt;/dependency&gt; è¿æ¥mongo è®¤è¯è¿æ¥ 12345678// åˆ›å»ºéªŒè¯ä¿¡æ¯ï¼Œæ ¹æ®åŠ å¯†æ–¹å¼é€‰æ‹©MongoCredentialå†…å¯¹åº”çš„åŠ å¯†æ–¹å¼List&lt;MongoCredential&gt; credentials = new ArrayList&lt;&gt;();MongoCredential credential = MongoCredential.createCredential(\"admin\", \"test1\", \"admin\".toCharArray());credentials.add(credential);// åˆ›å»ºmongoæœåŠ¡åœ°å€ServerAddress serverAddress = new ServerAddress(\"localhost\", 27017);MongoClient mongoClient = new MongoClient(serverAddress, credentials); æ— éœ€è®¤è¯è¿æ¥ 1MongoClient client = new MongoClient(\"localhost\", 27017); ç„¶åå°±å¯ä»¥é€šè¿‡MongoClientçš„å®ä¾‹æ–¹æ³•å¯¹mongoè¿›è¡Œç›¸å…³æ“ä½œäº† åˆ›å»ºæ•°æ®åº“è¿æ¥ 1MongoDatabase db = client.getDatabase(\"test1\"); mongoç‰¹æ€§æ˜¯ä¸ç®¡æ•°æ®åº“äº‹å…ˆæ˜¯å¦å­˜åœ¨ï¼Œéƒ½å¯ä»¥æ­£å¸¸åˆ›å»ºæ•°æ®åº“è¿æ¥ï¼Œä¸ä¼šåƒMySQLä¸€æ ·æŠ¥é”™ï¼Œè¿æ¥æˆåŠŸåï¼Œåœ¨mongoæœåŠ¡å™¨ä¸Šæ‰§è¡Œshow dbsï¼Œä¼šå‘ç°ä»ç„¶æŸ¥ä¸åˆ°æˆ‘ä»¬è¿æ¥çš„è¿™ä¸ªæ•°æ®åº“ï¼Œè¿™æ˜¯æ­£å¸¸æƒ…å†µï¼Œåªæœ‰åœ¨æ•°æ®åº“ä¸­æœ‰æ•°æ®çš„æ—¶å€™ï¼Œæ‰ä¼šæŸ¥å¾—å‡ºæ¥ï¼Œclient.getDatabase(&quot;test&quot;) === use testå‘½ä»¤ åˆ›å»ºé›†åˆ ä½¿ç”¨æ•°æ®åº“è¿æ¥å®ä¾‹æ–¹æ³•åˆ›å»ºä¸€ä¸ªç©ºçš„é›†åˆ 1234db.createCollection(\"base_info\");--- å‘½ä»¤ï¼šdb.createCollection(\"base_info\") ç›´æ¥å‘åˆ›å»ºçš„é›†åˆä¸­æ’å…¥æ•°æ® 12345MongoCollection&lt;Document&gt; collection = db.getCollection(\"base_info\");collection.insertOne(new Document(\"name\", \"lxl\"));--- å‘½ä»¤ï¼šdb.base_info.insert(&#123;\"name\": \"lxl\"&#125;) ä»¥ä¸Šä¸¤ç§æ–¹å¼å‡å¯åˆ›å»ºä¸€ä¸ªé›†åˆï¼ŒåŒºåˆ«åœ¨äºç¬¬ä¸€ç§æ–¹å¼åˆ›å»ºçš„æ˜¯ç©ºé›†åˆï¼Œ åˆ é™¤é›†åˆ 1234collection.drop();--- å‘½ä»¤ï¼šdb.base_info.drop() å¯¹é›†åˆçš„CRUD æ–°å¢æ•°æ® å•æ¡æ–°å¢ 12Document document = new Document().append(\"name\",\"cc\").append(\"age\",30).append(\"location\",\"SZ\");collection.insertOne(document); æ‰¹é‡æ–°å¢ 123456List&lt;Document&gt; documentList = new ArrayList&lt;&gt;();for (int i = 0; i &lt; 1000; i++) &#123; Document doc = new Document().append(\"name\", \"cc\" + i).append(\"age\", new Random().nextInt(100)).append(\"location\", \"SZ\"); documentList.add(doc);&#125;collection.insertMany(documentList); insertOne(Document)æ–¹æ³•æ¯æ¬¡æ’å…¥ä¸€æ¡æ•°æ® insertMany(List)æ–¹æ³•æ‰¹é‡æ’å…¥æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å‚æ•°InsertManyOptionsè®¾ç½®æ˜¯å¦æ’åº åˆ é™¤æ•°æ® åˆ é™¤ç¬¬ä¸€æ¡åŒ¹é…çš„æ•°æ® 12345Bson condition = Filters.eq(\"age\", 99);collection.deleteOne(condition);--- å‘½ä»¤ï¼šdb.base_info.deleteOne(&#123;\"age\": 99&#125;) åˆ é™¤æ‰€æœ‰åŒ¹é…æ•°æ® 12345Bson condition = Filters.eq(\"age\", 99);collection.deleteMany(condition);--- å‘½ä»¤ï¼šdb.base_info.deleteMany(&#123;\"ag\": 99&#125;) æŸ¥è¯¢æ•°æ® æŸ¥è¯¢è¿”å›ç¬¬ä¸€æ¡åŒ¹é…çš„æ•°æ® 1234Bson condition = Filters.eq(\"age\", 16);FindIterable&lt;Document&gt; vals = collection.find(condition);Document document = vals.first();System.out.println(document.toJson()); é€šè¿‡è°ƒç”¨FindIterableçš„å®ä¾‹æ–¹æ³•first()å–ç¬¬ä¸€æ¡æ•°æ® æŸ¥è¯¢è¿”å›æ‰€æœ‰åŒ¹é…æ•°æ® 12345Bson condition = Filters.eq(\"age\", 16);FindIterable&lt;Document&gt; vals = collection.find(condition);for (Document val : vals) &#123; System.out.println(val.toJson());&#125; find()æ–¹æ³•è¿”å›æ‰€æœ‰åŒ¹é…æ•°æ® åˆ†é¡µæŸ¥è¯¢ åˆ†é¡µæŸ¥è¯¢æ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯mongoè¿™ç§é‡çº§è¾ƒå¤§çš„å­˜å‚¨ï¼Œåˆ†é¡µä½¿ç”¨limit()å’Œskip()ä¸¤ä¸ªæ–¹æ³•æ¥å®ç°ï¼ŒlimitæŒ‡å®šæŸ¥è¯¢çš„æ¡æ•°ï¼Œskipè¿›è¡Œåˆ†é¡µï¼Œå‚æ•°ä¸ºä»ç¬¬å‡ æ¡å¼€å§‹ï¼Œéœ€è¦ä½¿ç”¨å½“å‰é¡µç å’Œåˆ†é¡µæ¡æ•°è¿›è¡Œè®¡ç®—(pageNo - 1) * pageSize 12345Bson condition = Filters.lt(\"age\", 2);FindIterable&lt;Document&gt; vals = collection.find(condition).limit(10).skip(10).sort(Sorts.descending(\"age\"));for (Document val : vals) &#123; System.out.println(val.toJson());&#125; limit(10): æ¯é¡µå–10æ¡æ•°æ® skip(10): ä»ç¬¬11æ¡å¼€å§‹æŸ¥è¯¢ï¼Œèµ·å§‹ä½ç½®ä¸º0 sort(Sorts.descending(â€œageâ€)): ä»¥åˆ—ageå€’åº å¯¹åº”MySQLï¼šselect * from base_info where age &lt; 2 order by age desc limit 7, 7 æ›´æ–°æ•°æ® æ›´æ–°ç¬¬ä¸€æ¡åŒ¹é…æ•°æ®ä¸­çš„æŸäº›å­—æ®µ 123Bson condition = Filters.eq(\"age\", 15);Document document = new Document(\"$set\", new Document(\"location\", \"XZ\"));collection.updateOne(condition, document); æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ª$setï¼Œè¿™ä¸ªæŒ‡ä»¤æ˜¯å¿…é¡»çš„ï¼Œç›¸å¯¹åº”çš„æŒ‡ä»¤è¿˜æœ‰$inc æ›¿æ¢ç¬¬ä¸€æ¡åŒ¹é…æ•°æ®å…¨éƒ¨å†…å®¹ 123Bson condition = Filters.eq(\"age\", 15);Document document = new Document(\"location\", \"XZ\");collection.updateOne(condition, document); æ²¡æœ‰$setæŒ‡ä»¤,åˆ™è¡¨ç¤ºä½¿ç”¨å‚æ•°documentæ›¿æ¢æ‰ç¬¬ä¸€æ¡åŒ¹é…åˆ°çš„æ•°æ® ç¬¬ä¸€æ¡åŒ¹é…çš„æ•°æ®ä¸­æŒ‡å®šå­—æ®µæ•°é‡+1 123Bson condition = Filters.eq(\"location\", \"XZ\");Document document = new Document(\"$inc\", new Document(\"age\", 1));collection.updateOne(condition, document); æ›´æ–°æ‰€æœ‰åŒ¹é…æ•°æ® 123Bson condition = Filters.eq(\"age\", 15);Document document = new Document(\"$set\", new Document(\"location\", \"XZ\"));collection.updateMany(condition, document); å…¨éƒ¨ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687import org.bson.Document;import org.bson.conversions.Bson;import com.mongodb.MongoClient;import com.mongodb.client.FindIterable;import com.mongodb.client.MongoCollection;import com.mongodb.client.MongoDatabase;import com.mongodb.client.model.Filters;import com.mongodb.client.model.Sorts;/** * @author: cc */public class MongoConnectTest &#123; public static void main(String[] args) &#123; MongoClient client = new MongoClient(\"localhost\", 27017); try &#123; /* // åˆ›å»ºéªŒè¯ä¿¡æ¯ï¼Œæ ¹æ®åŠ å¯†æ–¹å¼é€‰æ‹©MongoCredentialå†…å¯¹åº”çš„åŠ å¯†æ–¹å¼ List&lt;MongoCredential&gt; credentials = new ArrayList&lt;&gt;(); MongoCredential credential = MongoCredential.createCredential(\"admin\", \"test\", \"\".toCharArray()); credentials.add(credential); // åˆ›å»ºmongoæœåŠ¡åœ°å€ ServerAddress serverAddress = new ServerAddress(\"localhost\", 27017); MongoClient mongoClient = new MongoClient(serverAddress, credentials);*/ MongoDatabase db = client.getDatabase(\"test1\"); // åˆ›å»ºé›†åˆ // æ–¹å¼1 // db.createCollection(\"base_info2\"); // æ–¹å¼2 MongoCollection&lt;Document&gt; collection = db.getCollection(\"base_info\"); // collection.insertOne(new Document(\"name\", \"lxl\")); // åˆ é™¤é›†åˆ // collection.drop(); // æ–°å¢æ•°æ® // å•æ¡æ–°å¢ /*Document document = new Document().append(\"name\", \"cc\").append(\"age\", 30).append(\"location\", \"SZ\"); collection.insertOne(document); // æ‰¹é‡æ–°å¢ List&lt;Document&gt; documentList = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 1000; i++) &#123; Document doc = new Document().append(\"name\", \"cc\" + i).append(\"age\", new Random().nextInt(100)) .append(\"location\", \"SZ\"); documentList.add(doc); &#125; collection.insertMany(documentList);*/ // åˆ é™¤æ•°æ® // åˆ é™¤ç¬¬ä¸€æ¡åŒ¹é…æ•°æ® /*Bson condition = Filters.eq(\"age\", 99); collection.deleteOne(condition); // åˆ é™¤æ‰€æœ‰åŒ¹é…æ•°æ® collection.deleteMany(condition);*/ // ä¿®æ”¹æ•°æ® // ä¿®æ”¹ç¬¬ä¸€æ¡åŒ¹é…æ•°æ® /*Bson condition = Filters.eq(\"age\", 15); Document document = new Document(\"$set\", new Document(\"location\", \"XZ\")); collection.updateOne(condition, document); collection.updateMany(condition, document);*/ // å¹´é¾„+1 /*Bson condition = Filters.eq(\"location\", \"XZ\"); Document document = new Document(\"$inc\", new Document(\"age\", 1)); collection.updateOne(condition, document);*/ // æŸ¥è¯¢è¿”å›ç¬¬ä¸€æ¡åŒ¹é…æ•°æ® Bson condition = Filters.lt(\"age\", 2); FindIterable&lt;Document&gt; vals = collection.find(condition).sort(Sorts.descending(\"age\")).limit(7).skip(7); // Document document = vals.first(); // System.out.println(document.toJson()); for (Document val : vals) &#123; System.out.println(val.toJson()); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125;","categories":[{"name":"MongoDB","slug":"MongoDB","permalink":"http://luxiaowan.github.io/categories/MongoDB/"}],"tags":[{"name":"Javaä¸MongoDB","slug":"Javaä¸MongoDB","permalink":"http://luxiaowan.github.io/tags/Javaä¸MongoDB/"}]},{"title":"MongoDBç›‘æ§ã€åˆ†ç‰‡åŠå¤‡ä»½æ¢å¤","slug":"MongoDBç›‘æ§ã€åˆ†ç‰‡åŠå¤‡ä»½æ¢å¤","date":"2019-10-23T16:00:00.000Z","updated":"2019-10-24T13:20:12.764Z","comments":true,"path":"2019/10/24/MongoDBç›‘æ§ã€åˆ†ç‰‡åŠå¤‡ä»½æ¢å¤/","link":"","permalink":"http://luxiaowan.github.io/2019/10/24/MongoDBç›‘æ§ã€åˆ†ç‰‡åŠå¤‡ä»½æ¢å¤/","excerpt":"","text":"","categories":[{"name":"MongoDB","slug":"MongoDB","permalink":"http://luxiaowan.github.io/categories/MongoDB/"}],"tags":[{"name":"ç›‘æ§","slug":"ç›‘æ§","permalink":"http://luxiaowan.github.io/tags/ç›‘æ§/"}]},{"title":"MongoDBåŸºæœ¬æŒ‡ä»¤","slug":"MongoDBåŸºæœ¬æŒ‡ä»¤","date":"2019-10-22T16:00:00.000Z","updated":"2019-10-24T13:20:12.763Z","comments":true,"path":"2019/10/23/MongoDBåŸºæœ¬æŒ‡ä»¤/","link":"","permalink":"http://luxiaowan.github.io/2019/10/23/MongoDBåŸºæœ¬æŒ‡ä»¤/","excerpt":"","text":"æŸ¥çœ‹æ‰€æœ‰çš„db show dbs åˆ‡æ¢db user &lt;db_name&gt; æŸ¥çœ‹å½“å‰æ‰€åœ¨dbåç§° db åˆ é™¤db**(å¿…é¡»åœ¨è¦åˆ é™¤çš„dbä¸­æ“ä½œ)** db.dropDatabase() æŸ¥çœ‹dbä¸‹æ‰€æœ‰çš„é›†åˆ show tables show collections åˆ›å»ºé›†åˆ db.createCollection(&quot;abc&quot;) db.createCollection(&quot;def&quot;, {capped: true, autoIndexId: true, size: 1024, max: 100}) å¾€ä¸€å¼ ä¸å­˜åœ¨çš„é›†åˆä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºé›†åˆ db.test.insert({title: 123}) åˆ é™¤é›†åˆ db.&lt;collection_name&gt;.drop() ä¾‹ï¼šdb.abc.drop() æ’å…¥æ–‡æ¡£ db.&lt;collection_name&gt;.insert({title: 1234}) doc=({title: 12345, name: &quot;MongoDBæŒ‡å—&quot;}) db.&lt;collection_name&gt;.insert(doc) db.&lt;collection_name&gt;.save({name: &quot;MongoDBç®€å•æŒ‡ä»¤&quot;}}) doc2=({name: &quot;MongoDBä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;}) db.&lt;collection_name&gt;.save(doc2) doc3=({_id: &quot;edrftgyhjkgjhfgv2ryuoio&quot;, name: &quot;MongoDBä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;}) db.&lt;collection_name&gt;.save(doc3)// è‹¥_idå¯¹åº”å€¼çš„æ•°æ®å·²ç»å­˜åœ¨ï¼Œåˆ™æ›´æ–°è¿™æ¡æ•°æ®ï¼Œå¦åˆ™æ–°å¢ä¸€æ¡æ•°æ® æ›´æ–°æ–‡æ¡£ db.&lt;collection_name&gt;.update({title: 1234}, {$set:{title: &quot;4321&quot;}}) æ ¼å¼ï¼š 123456789db.&lt;collection_name&gt;.update( &lt;where&gt;,// ç›¸å½“äºMySQLçš„where &lt;update&gt;,// ç›¸å½“äºMySQLçš„updateè¯­å¥çš„setï¼Œéœ€è¦è·Ÿä¸€äº›æŒ‡ä»¤ï¼š$,$inc,$set &#123; upsert: true,// trueï¼šå¦‚æœä¸å­˜åœ¨è®°å½•ï¼Œåˆ™æ–°å¢ï¼›falseç›¸åï¼Œé»˜è®¤ multi: true,// trueï¼šåªæ›´æ–°ç¬¬ä¸€æ¡åŒ¹é…çš„è®°å½•ï¼›falseç›¸åï¼Œå…¨éƒ¨æ›´æ–°ï¼Œ é»˜è®¤ writeConcern: &lt;document&gt;// å¼‚å¸¸çº§åˆ« &#125;) æ¡ˆä¾‹ 12345678910111213&gt; 1. åªæ›´æ–°ç¬¬ä¸€æ¡è®°å½•ï¼š&gt; db.col.update( &#123; \"count\" : &#123; $gt : 1 &#125; &#125; , &#123; $set : &#123; \"test2\" : \"OK\"&#125; &#125; );&gt; 2. å…¨éƒ¨æ›´æ–°ï¼š&gt; db.col.update( &#123; \"count\" : &#123; $gt : 3 &#125; &#125; , &#123; $set : &#123; \"test2\" : \"OK\"&#125; &#125;,false,true );&gt; 3. åªæ·»åŠ ç¬¬ä¸€æ¡ï¼š&gt; db.col.update( &#123; \"count\" : &#123; $gt : 4 &#125; &#125; , &#123; $set : &#123; \"test5\" : \"OK\"&#125; &#125;,true,false );&gt; 4. å…¨éƒ¨æ·»åŠ è¿›å»:&gt; db.col.update( &#123; \"count\" : &#123; $gt : 5 &#125; &#125; , &#123; $set : &#123; \"test5\" : \"OK\"&#125; &#125;,true,true );&gt; 5. å…¨éƒ¨æ›´æ–°ï¼š&gt; db.col.update( &#123; \"count\" : &#123; $gt : 15 &#125; &#125; , &#123; $inc : &#123; \"count\" : 1&#125; &#125;,false,true );&gt; 6. åªæ›´æ–°ç¬¬ä¸€æ¡è®°å½•ï¼š&gt; db.col.update( &#123; \"count\" : &#123; $gt : 10 &#125; &#125; , &#123; $inc : &#123; \"count\" : 1&#125; &#125;,false,false );&gt; db.&lt;collection_name&gt;.save() è°ƒç”¨saveæŒ‡ä»¤ä¸€èˆ¬éœ€è¦æŒ‡å®š_id åˆ é™¤æ–‡æ¡£ db.&lt;collection_name&gt;.remove({title: &quot;4321&quot;}, true) æ ¼å¼ 1234db.&lt;collection_name&gt;.remove( &lt;where&gt;,// ç›¸å½“äºMySQLçš„where &lt;justOne&gt;// trueï¼šåªåˆ é™¤ä¸€æ¡åŒ¹é…æ¡ä»¶çš„æ•°æ®ï¼›falseï¼šåŒ¹é…æ¡ä»¶çš„æ•°æ®å…¨éƒ¨åˆ é™¤ï¼Œé»˜è®¤) åˆ é™¤é›†åˆä¸­æ‰€æœ‰æ•°æ® db.&lt;collection_name&gt;.remove({}) æ–°å‡½æ•°ï¼š db.&lt;collection_name&gt;.deleteMany({}) db.&lt;collection_name&gt;.deleteOne({title: &quot;12345&quot;}) æŸ¥è¯¢æ–‡æ¡£ æ™®é€šæŸ¥è¯¢ æ ¼å¼ï¼š 12345&gt; db.&lt;collection_name&gt;.find(&gt; &lt;where&gt;, // æŸ¥è¯¢æ¡ä»¶&gt; &lt;colName&gt;// è¿”å›å­—æ®µåç§°&gt; )&gt; åˆ›å»ºä¸€ä¸ªé›†åˆï¼Œæ’å…¥ä¸‰æ¡æ•°æ® 1db.user.insert([&#123;name: \"cc\", age: \"29\", gender: 1&#125;, &#123;name: \"ccc\", age: \"30\", gender: 2&#125;, &#123;name: \"c\", age: \"28\", gender: 1&#125;]) æŸ¥è¯¢é›†åˆä¸­å…¨éƒ¨æ•°æ® æ™®é€šæ˜¾ç¤ºï¼šdb.user.find() æ ¼å¼åŒ–æ˜¾ç¤ºï¼šdb.user.find().pretty() æŸ¥è¯¢name=&quot;c&quot;çš„ä¿¡æ¯ db.user.find({name: &quot;c&quot;}).pretty() æŸ¥è¯¢åªè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„æ•°æ® db.user.findOne({name: &quot;c&quot;}) ANDæŸ¥è¯¢ db.user.find({key: value, key: value}) AndæŸ¥è¯¢å³æ˜¯åœ¨whereæ¡ä»¶é‡Œé¢ç”¨é€—å·&quot;,&quot;åˆ†éš” æ —å­ï¼š 123456&gt; db.user.find(&#123;name:\"cc\", gender:1&#125;)&gt; &gt; ---&gt; ç­‰åŒäºMySQLï¼š&gt; select * from user where name = \"c\" AND gender = 1&gt; ORæŸ¥è¯¢ db.user.find({$or:[{key:value}, {key:value}]}) æ —å­ï¼š 12345678&gt; db.user.find(&#123;&gt; $or:[&#123;name:\"c\"&#125;, &#123;gender:2&#125;]&gt; &#125;)&gt; &gt; ---&gt; ç­‰åŒäºMySQLï¼š&gt; select * from user where name = \"c\" OR gender = 2&gt; ANDå’ŒORç»„åˆæŸ¥è¯¢ db.user.find({key:value, $or:[{key:value}, {key:value}]}) æ —å­ï¼š 123456&gt; db.user.find(&#123;gender:1, $or:[&#123;name: \"c\"&#125;, &#123;age: \"28\"&#125;]&#125;)&gt; &gt; ---&gt; ç­‰åŒäºMySQLï¼š&gt; select * from user where gender = 1 AND (name = \"c\" OR age = \"28\")&gt; è¿ç®—ç¬¦ è¿ç®—ç¬¦ æ ¼å¼ æ¡ˆä¾‹ MySQLå¯¹åº”è¯­å¥ ç­‰äº {key:value}{key:{$eq:value}} db.user.find({age:â€œ29â€})db.user.find({age:{$eq:â€œ29â€}}) where age = â€œ29â€ å¤§äº {key:{$gt: value}} db.user.find({age:{$gt:â€œ30â€}}) where age &gt; â€œ30â€ å°äº {key:{$lt: value}} db.user.find({age:{$lt: â€œ30â€}}) where age &lt; â€œ30â€ å¤§äºç­‰äº {key:{$gte: value}} db.user.find({age:{$gte:â€œ30â€}}) where age &gt;= â€œ30â€ å°äºç­‰äº {key:{$lte: value}} db.user.find({age:{$lte:â€œ30â€}}) where age &lt;= â€œ30â€ ä¸ç­‰äº {key:{ne: value}} db.user.find({age:{$ne:â€œ29â€}}) where age != â€œ30â€ æ¨¡ç³ŠæŸ¥è¯¢ æŸ¥è¯¢ageåŒ…å«0çš„ï¼šdb.user.find({age:/0/}) æŸ¥è¯¢ageä»¥2å¼€å¤´çš„ï¼šdb.user.find({age:/^2/}) æŸ¥è¯¢ageä»¥8ç»“æŸçš„ï¼šdb.user.find({age:/8$/}) åˆ†é¡µæŸ¥è¯¢ æ ¼å¼ï¼š 123456&gt; db.&lt;collection_name&gt;.find().limit(Number).skip(Number)&gt; &gt; ---&gt; limit(Number)è¡¨ç¤ºæŸ¥è¯¢å¤šå°‘æ¡æ•°æ®&gt; skip(Number)è¡¨ç¤ºä»ç¬¬å‡ æ¡å¼€å§‹æŸ¥è¯¢&gt; æŸ¥è¯¢ä¸€æ¡æ•°æ® ç¬¬ä¸€ç§æ–¹æ³•ï¼šdb.user.findOne({}) ç¬¬äºŒç§æ–¹æ³•ï¼šdb.user.find({}).limit(1) ä»ç¬¬äºŒæ¡æ•°æ®å¼€å§‹æŸ¥è¯¢ä¸€æ¡æ•°æ® db.user.find().limit(1).skip(2) æŸ¥è¯¢æ’åº æ ¼å¼ï¼š 1234567&gt; db.&lt;collection_name&gt;.find().sort(&#123;&lt;key_name&gt;:-1/1&#125;)&gt; &gt; ---&gt; &lt;key_name&gt;ï¼šæ’åºå­—æ®µ&gt; -1ï¼šå€’åº&gt; 1ï¼šæ­£åº&gt; æŒ‰ç…§å¹´é¾„å€’åº db.user.find().sort({age:-1}) æŒ‰ç…§å¹´é¾„å€’åºã€æ€§åˆ«æ­£åº db.user.find().sort({age:-1, gender:1})","categories":[{"name":"MongoDB","slug":"MongoDB","permalink":"http://luxiaowan.github.io/categories/MongoDB/"}],"tags":[{"name":"åŸºæœ¬æŒ‡ä»¤","slug":"åŸºæœ¬æŒ‡ä»¤","permalink":"http://luxiaowan.github.io/tags/åŸºæœ¬æŒ‡ä»¤/"}]},{"title":"MongoDBè¿æ¥æŠ¥é”™java.lang.NoSuchFieldError ACKNOWLEDGED","slug":"MongoDBè¿æ¥æŠ¥é”™java.lang.NoSuchFieldError-ACKNOWLEDGED","date":"2019-10-22T16:00:00.000Z","updated":"2019-10-24T13:20:12.764Z","comments":true,"path":"2019/10/23/MongoDBè¿æ¥æŠ¥é”™java.lang.NoSuchFieldError-ACKNOWLEDGED/","link":"","permalink":"http://luxiaowan.github.io/2019/10/23/MongoDBè¿æ¥æŠ¥é”™java.lang.NoSuchFieldError-ACKNOWLEDGED/","excerpt":"","text":"BUGæè¿° ä½¿ç”¨SpringBootæ•´åˆMongoDBæ—¶ï¼Œæ­£è¦è¿è¡Œä»£ç è¿æ¥mongoï¼Œå°±èµ¤çº¢èµ¤çº¢çš„æŠ¥äº†ä¸ªé”™ï¼š 12345Exception in thread \"main\" java.lang.NoSuchFieldError: ACKNOWLEDGED at com.mongodb.MongoClientOptions$Builder.&lt;init&gt;(MongoClientOptions.java:960) at com.mongodb.MongoClient.&lt;init&gt;(MongoClient.java:155) at com.mongodb.MongoClient.&lt;init&gt;(MongoClient.java:145) at com.example.demo.mongo.MongoConnectTest.main(MongoConnectTest.java:15) è¿™ä¸€ä¸‹å°±å‚»çœ¼äº†ï¼Œå¯¹äºåˆšæ¥è§¦mongoçš„äººæ¥è¯´ï¼Œæ˜¯å¾ˆæ‡µåœˆçš„ï¼Œå¤§è„‘çŸ¥è¯†åº“ä¸­æ²¡æœ‰è¿™ä¸ªå¼‚å¸¸ä¿¡æ¯çš„è§£å†³åŠæ³•ï¼Œåªèƒ½è°·æ­Œäº†ï¼Œæ²¡æƒ³åˆ°æœ‰é‚£ä¹ˆå¤šäººé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ BUGè§£å†³ åœ¨Stack Overflowä¸Šæ‰¾åˆ°ä¸€ä¸ªå¸–å­ï¼š https://stackoverflow.com/questions/13593614/mongodb-java-lang-nosuchfielderror å…¶ä¸­jyeminçš„å›ç­”å¯ä»¥è¯´æ˜¯ç›´å‡»è¦å®³äº†ï¼Œé¡ºåˆ©çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æŠŠæˆªå›¾è´´ä¸Šï¼Œä»¥é˜²å¸–å­è¢«åˆ  å…¶å®å°±æ˜¯åœ¨å·¥ç¨‹ä¸­å¼•å…¥äº†å¤šä¸ªç‰ˆæœ¬ä¸åŒçš„mongo-java-driverï¼Œæ‰€ä»¥å¯¼è‡´ç¨‹åºæ··ä¹±ï¼Œåªè¦ä¿ç•™è‡ªå·±çœŸæ­£ä½¿ç”¨çš„é‚£ä¸ªç‰ˆæœ¬ï¼Œå…¶ä»–çš„éƒ½åˆ é™¤å³å¯ æˆ‘çš„é…ç½®ï¼š å°†2.7.1ç‰ˆæœ¬çš„ä¾èµ–åˆ é™¤å°±å¯ä»¥æ­£å¸¸è¿è¡Œäº†","categories":[{"name":"MongoDB","slug":"MongoDB","permalink":"http://luxiaowan.github.io/categories/MongoDB/"}],"tags":[{"name":"MongoDBé”™è¯¯è®°å½•","slug":"MongoDBé”™è¯¯è®°å½•","permalink":"http://luxiaowan.github.io/tags/MongoDBé”™è¯¯è®°å½•/"}]},{"title":"MongoDBåŸºç¡€åº”ç”¨","slug":"MongoDBåŸºç¡€åº”ç”¨","date":"2019-10-22T16:00:00.000Z","updated":"2019-10-24T13:20:12.764Z","comments":true,"path":"2019/10/23/MongoDBåŸºç¡€åº”ç”¨/","link":"","permalink":"http://luxiaowan.github.io/2019/10/23/MongoDBåŸºç¡€åº”ç”¨/","excerpt":"","text":"ç´¢å¼• è¯´æ˜ï¼šç´¢å¼•æ˜¯ä¸ºäº†åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ï¼Œå¯ä»¥å¯¹é›†åˆä¸­çš„ä¸€åˆ—æˆ–å¤šåˆ—è®¾ç½®ç´¢å¼•ã€‚ â€“ æ— ç´¢å¼•ï¼šæ‰«ææ•´ä¸ªé›†åˆçš„æ–‡æ¡£ï¼ŒæŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ â€“ æœ‰ç´¢å¼•ï¼šæŸ¥æ‰¾ç´¢å¼•ï¼Œæ ¹æ®ç´¢å¼•å–å‡ºæ–‡æ¡£æ•°æ® åˆ›å»ºç´¢å¼• db.&lt;collection_name&gt;.createIndex(keys, option) æ —å­ï¼š 123456789101. å•ç´¢å¼•db.user.createIndex(&#123;age:-1&#125;)---age:ç´¢å¼•åˆ—å-1:å€’åºç´¢å¼•1:æ­£åºç´¢å¼•2. å¤šç´¢å¼•(å¤åˆç´¢å¼•)db.user.createIndex(&#123;age:1, gender:-1&#125;) å¯é€‰å‚æ•° å‚æ•° ç±»å‹ è¯´æ˜ background Boolean æŒ‡å®šåˆ›å»ºç´¢å¼•æ—¶æ˜¯å¦é˜»å¡é›†åˆçš„å…¶ä»–æ“ä½œã€‚true:åå°æ‰§è¡Œï¼Œä¸é˜»å¡ï¼›false:é˜»å¡ï¼Œé»˜è®¤ unique Boolean æŒ‡å®šç´¢å¼•æ˜¯å¦ä¸ºå”¯ä¸€ç´¢å¼•ã€‚true:å”¯ä¸€ç´¢å¼•ï¼›false:ä¸å”¯ä¸€ï¼Œé»˜è®¤ name String ç´¢å¼•åç§°ï¼Œé»˜è®¤ä¸ºå­—æ®µå+ç´¢å¼•é¡ºåº v indexversion ç´¢å¼•ç‰ˆæœ¬å·ï¼Œé»˜è®¤ä¸ºå½“å‰mongoçš„ç‰ˆæœ¬å· weights Integer 1~99999ä¹‹é—´ï¼Œå€¼è¶Šå¤§æƒé‡è¶Šå¤§ expireAfterSeconds Integer æŒ‡å®šé›†åˆç”Ÿå­˜æ—¶é—´ã€‚ç§’çº§ï¼ŒTTL sparse Boolean æŒ‡å®šæ˜¯å¦å¿½ç•¥ä¸å­˜åœ¨çš„å­—æ®µã€‚true:ä¸æŸ¥å‡ºä¸åŒ…å«æŸ¥è¯¢å­—æ®µçš„æ–‡æ¡£ï¼›false:æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£ï¼Œé»˜è®¤ æ —å­ï¼š 12345&gt; db.user.createIndex(&#123;name:1&#125;, &#123;background: true, unique: true, name: \"idx_user_name\", v: 1, weights: 99, sparse: true&#125;)&gt; &gt; ---&gt; åå°ä¸é˜»å¡é›†åˆçš„æ–¹å¼åˆ›å»ºä¸€ä¸ªnameåˆ—æ­£åº,ç‰ˆæœ¬å·ä¸º1,æƒé‡99,å¿½ç•¥æ— nameå­—æ®µçš„æ–‡æ¡£çš„å”¯ä¸€ç´¢å¼•idx_user_name&gt; æŸ¥çœ‹æ‰€æœ‰ç´¢å¼• db.&lt;collection_name&gt;.getIndexes() æ —å­ï¼š db.user.getIndexes() é‡å»ºç´¢å¼• æ–¹æ³•1ï¼šdb.&lt;collection_name&gt;.reIndex() æ–¹æ³•2ï¼šå…ˆåˆ é™¤åŸç´¢å¼•ï¼Œç„¶åå†åˆ›å»º 12db.&lt;collection_name&gt;.dropIndex(&lt;idx_name&gt;)db.&lt;collection_name&gt;.createIndex(...) åˆ é™¤ç´¢å¼• åˆ é™¤æŒ‡å®šåç§°çš„ç´¢å¼•ï¼š db.user.dropIndex(&lt;idx_name&gt;) åˆ é™¤é›†åˆä¸­æ‰€æœ‰ç´¢å¼• db.user.dropIndexes() è¯´æ˜ï¼šåªä¼šåˆ é™¤è‡ªå»ºçš„ç´¢å¼•ï¼Œé›†åˆä¸­_idåˆ—çš„ç´¢å¼•ä¸ä¼šè¢«åˆ é™¤ èšåˆæŸ¥è¯¢ 12345678910111213141516171819202122232425åˆ›å»ºé›†åˆå¹¶æ’å…¥æ•°æ®ï¼šdb.agg.save([&#123; title: 'MongoDB Overview', description: 'MongoDB is no sql database', by_user: 'runoob.com', url: 'http://www.runoob.com', tags: ['mongodb', 'database', 'NoSQL'], likes: 100&#125;,&#123; title: 'NoSQL Overview', description: 'No sql database is very fast', by_user: 'runoob.com', url: 'http://www.runoob.com', tags: ['mongodb', 'database', 'NoSQL'], likes: 10&#125;,&#123; title: 'Neo4j Overview', description: 'Neo4j is no sql database', by_user: 'Neo4j', url: 'http://www.neo4j.com', tags: ['neo4j', 'database', 'NoSQL'], likes: 750&#125;]) æ ¼å¼ï¼š 12345678910&gt; db.&lt;collection_name&gt;.aggregate(condition)&gt; ---&gt; condition:&gt; [&#123;$group:&#123;_id:\"$&lt;key&gt;\", num_tutorial:&#123;$&lt;fun_expression&gt;:\"$&lt;key&gt;\"&#125;&#125;&#125;]&gt; $group:ä¸€ä¸ªç»„&gt; _id:ç»„åˆåˆ—ï¼Œç±»åŒäºMySQLçš„group byåé¢çš„å­—æ®µï¼Œé»˜è®¤_idçš„åˆ—ä¼šåœ¨æŸ¥è¯¢ç»“æœä¸­æ˜¾ç¤º&gt; num_tutorial:è¾“å‡ºçš„åˆ—å&gt; $&lt;fun_expression&gt;:èšåˆè¡¨è¾¾å¼&gt; $&lt;key&gt;:è¿ç®—çš„åˆ—å&gt; å…³é”®å­—ï¼šaggregate è¯´æ˜ï¼šèšåˆæŸ¥è¯¢å°±æ˜¯æ±‚å’Œã€æœ€å¤§ã€æœ€å°ã€æœ€å‰ã€æœ€åã€å¹³å‡æ•°çš„ç»Ÿç§°ï¼Œç±»ä¼¼äºMySQLçš„count()ã€sum()ã€avg() æ —å­ï¼š 12345&gt; db.user.aggregate([&#123;$group: $&#123;_id:\"$gender\", num_tutorial:&#123;$sum:1&#125;&#125;&#125;])&gt; &gt; ---&gt; ç­‰åŒäºMySQLï¼šselect gender, count(1) from user group by gender&gt; èšåˆè¡¨è¾¾å¼ è¡¨è¾¾å¼ æè¿° æ¡ˆä¾‹ $sum è®¡ç®—æ€»å’Œ db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$sum:&quot;$likes&quot;}}}])â€”ç­‰åŒäºMySQLï¼šselect by_user, sum(likes) from agg group by by_user $avg è®¡ç®—å¹³å‡å€¼ db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$avg:&quot;$likes&quot;}}}])â€”ç­‰åŒäºMySQLï¼šselect by_user, avg(likes) from agg group by by_user $min è·å–é›†åˆä¸­æŒ‡å®šåˆ—çš„æœ€å°å€¼è®°å½• db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$min:&quot;$like&quot;}}}])â€”ç­‰åŒäºMySQLï¼šselect by_user, min(likes) from agg group by by_user $max è·å–é›†åˆä¸­æŒ‡å®šåˆ—çš„æœ€å¤§å€¼è®°å½• db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$max:&quot;$likes&quot;}}}])â€”ç­‰åŒäºMySQLï¼šselect by_user, max(likes) from agg group by by_user $push åœ¨ç»“æœæ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°æ•°ç»„ db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$push:&quot;$url&quot;}}}])â€”ç­‰åŒäºMySQLï¼šæŸ¥å‡ºæ‰€æœ‰æ•°æ®ï¼Œç„¶åå–å­—æ®µurlå†™å…¥åŒä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œurlä¸å»é‡ï¼Œç„¶åè¾“å‡º $addToSet åœ¨ç»“æœæ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä½†ä¸åˆ›å»ºå‰¯æœ¬ db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$addToSet:&quot;$url&quot;}}}])â€”ç­‰åŒäºMySQLï¼šæŸ¥å‡ºæ‰€æœ‰æ•°æ®ï¼Œç„¶åå–å­—æ®µurlå†™å…¥åŒä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œurlå»é‡ï¼Œç„¶åè¾“å‡º $first æ ¹æ®èµ„æºæ–‡æ¡£çš„æ’åºè·å–ç¬¬ä¸€ä¸ªæ–‡æ¡£æ•°æ® db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$first:&quot;$title&quot;}}}]) $last æ ¹æ®èµ„æºæ–‡æ¡£çš„æ’åºè·å–æœ€åä¸€ä¸ªæ–‡æ¡£æ•°æ® db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$last:&quot;$title&quot;}}}]) ç®¡é“å‡½æ•° è¯´æ˜ï¼šç®¡é“å‡½æ•°ç±»ä¼¼äºLinuxç³»ç»Ÿä¸­çš„ç®¡é“æ“ä½œï¼Œå°†ä¸Šä¸€æ­¥çš„è¿ç®—ç»“æœä½œä¸ºä¸‹ä¸€æ­¥çš„è¾“å…¥å€¼ï¼Œæœ€ç»ˆè¾¾åˆ°ç†æƒ³è®¡ç®—ç»“æœçš„è¿ç®—æ–¹å¼ å‡½æ•° è¯´æ˜ $project æŒ‡å®šéœ€è¦è¾“å‡ºçš„åˆ—ï¼Œé»˜è®¤æ˜¾ç¤º_idï¼Œæ ¼å¼ï¼š{$project:{by_user:1, title:1, url:1, _id:0ä¸æ˜¾ç¤ºid}}, $limit é™åˆ¶æŸ¥è¯¢è¿”å›çš„æ–‡æ¡£æ•°ï¼Œæ ¼å¼ï¼š{$limit: 1},åªè¿”å›ä¸€ä¸ªæ–‡æ¡£ $skip è·³è¿‡æŒ‡å®šæ•°é‡çš„æ–‡æ¡£ï¼Œè¿”å›ä¹‹åçš„æ‰€æœ‰æ–‡æ¡£ï¼Œæ ¼å¼ï¼š{$skip: 1},ä»ç¬¬äºŒä¸ªæ–‡æ¡£å¼€å§‹è¾“å‡º $match æ¡ä»¶ç­›é€‰ï¼Œæ ¼å¼ï¼š{match: {likes: {gte: 10}}} $group èšåˆæ¡ä»¶ï¼Œæ ¼å¼ï¼š{group: {_id: &quot;by_user&quot;, count: {$sum: -1}}} $sort æ’åºï¼Œæ ¼å¼ï¼š{$sort: {likes: -1}}ï¼Œ-1:å€’åº; 1:æ­£åº $unwind å°†æ–‡æ¡£ä¸­çš„æŸä¸€ä¸ªæ•°ç»„ç±»å‹å­—æ®µæ‹†åˆ†æˆå¤šæ¡ï¼Œæ¯æ¡åŒ…å«æ•°ç»„ä¸­çš„ä¸€ä¸ªå€¼ $geoNear è¾“å‡ºæ¥è¿‘æŸä¸€åœ°ç†ä½ç½®çš„æœ‰åºæ–‡æ¡£ã€‚ æ —å­ï¼š 123456&gt; db.agg.aggregate(&#123;$match: &#123;likes: &#123;$gte: 10&#125;&#125;&#125;, &#123; $project: &#123;_id: 0, title: 1, by_user: 1, likes: 1&#125;&#125;, &#123;$limit: 5&#125;, &#123;$skip: 1&#125;, &#123;$sort: &#123;likes: -1&#125;&#125;)&gt; &gt; ---&gt; ç­‰åŒäºMySQL: &gt; select title, by_user, likes from agg where likes &gt;= 10 order by likes desc limit 1,5&gt;","categories":[{"name":"MongoDB","slug":"MongoDB","permalink":"http://luxiaowan.github.io/categories/MongoDB/"}],"tags":[{"name":"åŸºç¡€åº”ç”¨","slug":"åŸºç¡€åº”ç”¨","permalink":"http://luxiaowan.github.io/tags/åŸºç¡€åº”ç”¨/"}]},{"title":"Git Stashç”¨æ³•","slug":"git stashå‘½ä»¤","date":"2019-10-21T16:00:00.000Z","updated":"2019-10-24T13:20:12.765Z","comments":true,"path":"2019/10/22/git stashå‘½ä»¤/","link":"","permalink":"http://luxiaowan.github.io/2019/10/22/git stashå‘½ä»¤/","excerpt":"","text":"åˆ›å»ºä»“åº“ git init echo 123 &gt; test.txt git add . git commit -m â€œadd test fileâ€ git remote add origin git@git.xx.xx.xx:xxx/xxx.git git push origin master ä»¥ä¸Šå†…å®¹æ¯”è¾ƒç®€å•ï¼Œå°±ä¸ä½œè¯¦ç»†è®²è¿°ï¼Œå¦‚æœä¸Šé¢çš„å†…å®¹çœ‹ä¸æ‡‚ï¼Œä¸‹é¢çš„è¯·æ”¾å¼ƒ ä½¿ç”¨git stashæš‚å­˜ éšæ„ä¿®æ”¹test.txtæ–‡ä»¶çš„å†…å®¹ï¼Œæ¯”å¦‚ï¼šç”»ä¸ªå¿ƒå½¢ï¼Œä½ æ­£çƒ­ç«æœå¤©ä¿®æ”¹ä¸­â€¦â€¦ è¿™æ—¶é¢†å¯¼èµ°è¿‡æ¥æ‹äº†æ‹ä½ çš„è‚©è†€è¯´åˆ°ï¼šâ€å°ä¼™å­å•Šï¼Œåˆ›å»ºä¸ªæœ•.txtæ–‡ä»¶æäº¤ä¸Šæ¥ï¼Œå†…å®¹å°±å†™æˆ‘è¿˜æƒ³å†æ´»äº”ç™¾å¹´ï¼Œtest.txtæ–‡ä»¶è¿™ä¸€ç‰ˆä¸ä½œä¿®æ”¹â€œã€‚ ä½ é¢éœ²ç¬‘å®¹çš„å›ç­”ï¼šâ€œå¥½çš„ï¼Œæ²¡é—®é¢˜ï¼â€ï¼Œå†…å¿ƒå´æ˜¯ï¼šâ€œMMP,MMP,MMPâ€¦â€¦â€ è¾›è¾›è‹¦è‹¦ä¿®æ”¹çš„test.txtæ–‡ä»¶æ€ä¹ˆåŠï¼Ÿçœ¼ç…ç€å°±è¦å®Œæˆäº†ï¼Œéš¾é“å¤åˆ¶å‡ºå»ï¼Œç„¶åç­‰è§£å†³é¢†å¯¼éœ€æ±‚åå†ç²˜è´´å›æ¥ï¼Ÿlowä¸lowï¼Ÿè‚¯å®šä¸lowå•Šï¼Œä¸€ä¸ªæ–‡ä»¶è€Œå·²ï¼Œè¿™ç§æ–¹æ³•å¾ˆç®€å•ï¼Œ*ä½†æ˜¯å½“ä½ å®é™…é¡¹ç›®ä¸­ä¿®æ”¹äº†å‡ åä¸ªæ–‡ä»¶çš„æ—¶å€™å‘¢ï¼Ÿ*æŒ¨ä¸ªå„¿å¤åˆ¶å‡ºå»ï¼Ÿç´¯å‚»å°å­å‘ï¼Ÿï¼ï¼ï¼ï¼ï¼ git stashå‘½ä»¤å¸®ä½ è§£å†³é—®é¢˜ï¼Œstashæ˜¯å­˜å‚¨çš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯å°†å½“å‰å·¥ä½œåŒºå†…çš„æ‰€æœ‰ä¸œè¥¿éƒ½å­˜å‚¨èµ·æ¥ï¼Œç„¶åå·¥ä½œåŒºæ‰€æœ‰æ–‡ä»¶æ¢å¤åˆ°ä¿®æ”¹ä¹‹å‰çš„çŠ¶æ€(å¹¶ä¸æ˜¯æœ€æ–°çŠ¶æ€ï¼Œä¸ä¼šå’Œä»“åº“ä¸­è¿›è¡Œè‡ªåŠ¨åŒæ­¥ï¼Œéœ€è¦ä½ è‡ªå·±å»pull)ï¼Œç„¶åä½ å°±å¯ä»¥ç»§ç»­å®Œæˆä»»åŠ¡äº†ã€‚(åœ¨æ‰§è¡Œgit stashä¹‹å‰éœ€è¦å…ˆæ‰§è¡Œgit addå‘½ä»¤) stashå¯ä»¥è¿›è¡Œå¤šæ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œéƒ½ä¼šå°†å½“å‰å·¥ä½œåŒºçš„æ–‡ä»¶æƒ…å†µæš‚å­˜èµ·æ¥ï¼Œstashæ˜¯ç±»æ ˆå­˜å‚¨ï¼Œæ¯æ¬¡stashçš„åºå·éƒ½ä¸º0ï¼Œæ­¤æ¬¡ä¹‹å‰stashçš„åºå·ä¼šè‡ªåŠ¨+1 ä½¿ç”¨git stash popå–å‡º git stash popå–å‡ºæ ˆé¡¶å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯åºå·ä¸º0çš„é‚£ä¸ªï¼Œå³æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œgit stashä¿å­˜çš„å†…å®¹ã€‚popä¹‹åï¼Œæš‚å­˜åˆ—è¡¨ä¸­å°±ä¼šè‡ªåŠ¨å°†å…¶æ¸…é™¤æ‰ï¼Œè¿™ä¸ªæ—¶å€™ä½ å†æ‰§è¡Œgit stash listä¼šå‘ç°æ¯›éƒ½æ²¡æœ‰ è¿™ä¸ªæ—¶å€™å¯èƒ½å°±ä¼šçº³é—·äº†ï¼Œæˆ‘ä¿å­˜äº†å¥½å‡ æ¬¡ï¼Œä½†æ˜¯æˆ‘è¿™æ¬¡æ˜¯æƒ³ä½¿ç”¨æœ€å¼€å§‹stashçš„é‚£ä»½å†…å®¹ï¼Œæ€ä¹ˆåŠï¼Ÿä¸€ç›´popï¼Œç›´åˆ°æœ€åä¸€æ¬¡ï¼Ÿå½“ç„¶ä¸è¡Œï¼Œä¸Šé¢åˆšè®²è¿‡popä¹‹åæš‚å­˜åˆ—è¡¨ä¸­å°±æ²¡æœ‰stashçš„ä¿¡æ¯äº†ï¼Œå·²ç»è¢«popå‡ºå»çš„å°±æ‰¾ä¸å›æ¥äº†ï¼Œç­‰äºæ˜¯è‡ªæ€å¼æ”»å‡»ï¼Œé‚£å’‹æ•´å‘¢ï¼Ÿ git stash apply stash@{åºå·}å¯ä»¥å°†æŒ‡å®šåºå·çš„stashå†…å®¹å¼¹å‡ºåˆ°å·¥ä½œåŒºï¼Œæ­¤æ—¶å·¥ä½œåŒºé‡Œæ–‡ä»¶çš„çŠ¶æ€å°±å’Œstash@{åºå·}é‡Œçš„ä¸€è‡´äº†ï¼Œä½†æ˜¯è¿™ä¸ªå‘½ä»¤æ— æ³•å°†stashè®°å½•ä»æš‚å­˜åˆ—è¡¨ä¸­åˆ é™¤ï¼Œä»…ä»…åªæ˜¯å°†æ–‡ä»¶æ¢å¤è€Œå·² git stash drop stash@{åºå·}æ¥ä¸¢å¼ƒæš‚å­˜åˆ—è¡¨ä¸­çš„è®°å½•ï¼Œå¯ä»¥é…åˆapplyä½¿ç”¨ æŸ¥çœ‹æš‚å­˜è®°å½•ä¸­çš„ä¿¡æ¯ æŸ¥çœ‹æš‚å­˜åˆ—è¡¨ï¼šgit stash listæŸ¥çœ‹å½“å‰stashçš„åˆ—è¡¨ æŸ¥çœ‹æš‚å­˜å†…å®¹ï¼šgit stash show stash@{åºå·}æŸ¥çœ‹æŒ‡å®šåºå·çš„stashçš„å†…å®¹ git stash save â€˜msgâ€™ ç­‰äºæ˜¯åœ¨stashçš„æ—¶å€™æ‰“äº†ä¸ªæ ‡ç­¾ï¼Œå¦–å¨†ï¼ï¼ï¼ï¼","categories":[{"name":"Git","slug":"Git","permalink":"http://luxiaowan.github.io/categories/Git/"}],"tags":[]},{"title":"Hashç´¢å¼•ç›¸å…³","slug":"Hashç´¢å¼•ç›¸å…³","date":"2019-10-12T15:42:43.000Z","updated":"2019-10-21T15:48:05.043Z","comments":true,"path":"2019/10/12/Hashç´¢å¼•ç›¸å…³/","link":"","permalink":"http://luxiaowan.github.io/2019/10/12/Hashç´¢å¼•ç›¸å…³/","excerpt":"","text":"hashç´¢å¼•ç»“æ„ä½¿ç”¨æ–¹å¼è¾ƒä¸ºå±€é™ï¼Œä»…é€‚ç”¨äº=ã€INå’Œ&lt;=&gt;ä¸‰ç§ï¼Œä½†æ˜¯ç”±äºé€šè¿‡hashå¯ä»¥ç›´æ¥æŸ¥æ‰¾åˆ°å…·ä½“çš„å€¼ï¼Œè€Œä¸ç”¨åƒBTé‚£æ ·æ¯æ¬¡éƒ½ä»rootèŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ‰€ä»¥åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œhashçš„æŸ¥æ‰¾æ•ˆç‡è¦æ¯”BTé«˜ã€‚ hashçš„ç¼ºé™·ï¼š 1. hashä¸èƒ½è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ å€¼åœ¨è®¡ç®—hashåï¼Œå¹¶ä¸èƒ½ä¿è¯è®¡ç®—åçš„hashå€¼å’Œè®¡ç®—å‰çš„å¤§å°æ’åˆ—ä¸€æ ·ï¼Œæ‰€ä»¥hashä¸é€‚ç”¨äºèŒƒå›´æŸ¥æ‰¾ 2. hashä¸èƒ½è¿›è¡Œæ’åºæŸ¥è¯¢ å€¼è®¡ç®—åçš„hashå€¼æ— æ³•ä¿è¯ä¸åŸå€¼å¤§å°é¡ºåºä¸€æ ·ï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œæ’åº 3. ç»„åˆç´¢å¼•ä¸èƒ½ä½¿ç”¨éƒ¨åˆ†å­—æ®µæŸ¥è¯¢ ç»„åˆç´¢å¼•çš„hashå€¼æ˜¯æ‰€æœ‰ç´¢å¼•å­—æ®µçš„å€¼ç»„åˆåœ¨ä¸€èµ·è¿›è¡Œè®¡ç®—çš„ï¼Œè‹¥ä»…ä½¿ç”¨éƒ¨åˆ†å­—æ®µè¿›è¡ŒæŸ¥è¯¢çš„è¯ï¼Œè®¡ç®—å‡ºçš„hashå€¼åŸºæœ¬ä¸ä¼šä¸ç´¢å¼•çš„hashå€¼ç›¸åŒ 4. hashåœ¨å‡ºç°å¤§é‡å€¼ç¢°æ’çš„æ—¶å€™ï¼Œæ€§èƒ½ä¼šé™ä½ hashå‡ºç°å¤§é‡çš„å€¼ç›¸ç­‰çš„æ—¶å€™ï¼Œéœ€è¦è¿›è¡Œè¡¨æ‰«æä»¥è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œæ•ˆç‡è¾ƒä½","categories":[{"name":"Java","slug":"Java","permalink":"http://luxiaowan.github.io/categories/Java/"}],"tags":[{"name":"JavaåŸºç¡€çŸ¥è¯†","slug":"JavaåŸºç¡€çŸ¥è¯†","permalink":"http://luxiaowan.github.io/tags/JavaåŸºç¡€çŸ¥è¯†/"}]},{"title":"Charå’Œvarcharç®€å•ä»‹ç»","slug":"charä¸varcharç®€å•ä»‹ç»","date":"2019-10-12T04:10:43.000Z","updated":"2019-10-21T16:19:50.476Z","comments":true,"path":"2019/10/12/charä¸varcharç®€å•ä»‹ç»/","link":"","permalink":"http://luxiaowan.github.io/2019/10/12/charä¸varcharç®€å•ä»‹ç»/","excerpt":"","text":"1. æ•°æ®é•¿åº¦ 1) char(æœ€å¤§é•¿åº¦255ä¸ªå­—èŠ‚) é•¿åº¦å›ºå®šï¼ˆå­—æ®µå­˜å…¥æ•°æ®é•¿åº¦å§‹ç»ˆç­‰äºå­—æ®µé•¿åº¦ï¼‰ 2) varchar(æœ€å¤§é•¿åº¦65535ä¸ªå­—èŠ‚) å¯å˜é•¿åº¦ï¼Œå­˜å…¥æ•°æ®é•¿åº¦ä¸ºNä¸ªå­—èŠ‚ï¼Œåˆ™å®é™…ä½¿ç”¨äº†N+1(255ä»¥ä¸Šé•¿åº¦åˆ™+2)ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œå¤šå‡ºæ¥çš„1å­—èŠ‚æ˜¯ç”¨æ¥å­˜å‚¨æ•°æ®å®é™…é•¿åº¦ã€‚ å­˜å…¥æ•°æ®å¯¹æ¯” å­˜å…¥&quot;ab&quot; charæŸ¥è¯¢å‡º&quot;ab&quot; varcharæŸ¥è¯¢å‡º&quot;ab&quot; å­˜å…¥&quot;ab &quot;ï¼Œabåé¢æœ‰ä¸¤ä¸ªç©ºæ ¼ï¼Œ charæŸ¥è¯¢å‡º&quot;ab&quot; varcharæŸ¥è¯¢å‡º&quot;ab &quot; è§£æï¼š â€‹ åœ¨å…¥åº“æ—¶ï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨åœ¨abåé¢æ·»åŠ ä¸¤ä½ç©ºæ ¼ï¼Œè®©å…¥åº“çš„æ•°æ®é•¿åº¦ä¿è¯ç­‰äº4 char(4) ï¼Œè¿™ç§æ“ä½œå¾ˆå®¹æ˜“ç†è§£ï¼Œä½†æ˜¯å¦‚æœä½ å»æ•°æ®è¡¨é‡Œé¢å»æŸ¥è¿™æ¡æ•°æ®ï¼Œä¼šå‘ç°è¡¨ä¸­æ•°æ®å¹¶æ²¡æœ‰ç©ºæ ¼ï¼Œæ‰€ä»¥å¯ä»¥æ¨æ–­å‡ºè¿™é‡Œæ˜¯é€»è¾‘è¿½åŠ ï¼Œæ‰€ä»¥åœ¨æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ä¼šå¹¶ä¸ä¼šå‡ºç°å¼•æ“è‡ªåŠ¨æ·»åŠ çš„ç©ºæ ¼ã€‚ 2. å®æ“(æŠ€æœ¯ä¸€å®šè¦**å®æ“**) 1ï¼‰æ— ç©ºæ ¼æ•°æ® å…ˆåˆ›å»ºä¸€å¼ è¡¨ 1create table cv(c char(4), v varchar(4)); æ’å…¥æ•°æ® 1insert into cv values(&quot;ab&quot;, &quot;ab&quot;); æŸ¥è¯¢æ•°æ® 1select concat(&apos;(&apos;, c, &apos;)&apos;) AS c, concat(&apos;(&apos;, v, &apos;)&apos;) AS v from cv; ç»“æœ ç»“æœä¸­charå’Œvarcharå‡æŸ¥å‡ºæ¥ä¸ºæ— ç©ºæ ¼çš„ab ####2ï¼‰æœ‰ç©ºæ ¼æ•°æ® æ’å…¥æ•°æ® 1insert into cv values(&quot;ab &quot;, &quot;ab &quot;); æŸ¥è¯¢æ•°æ® 1select concat(&apos;(&apos;, c, &apos;)&apos;) AS c, concat(&apos;(&apos;, v, &apos;)&apos;) AS v from cv; ç»“æœ ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œcharç±»å‹å°†æ•°æ®åé¢çš„ç©ºæ ¼è‡ªåŠ¨å»æ‰äº†ï¼Œvarcharåˆ™ä¿ç•™äº†æ‰€æœ‰çš„ç©ºæ ¼","categories":[{"name":"MySQL","slug":"MySQL","permalink":"http://luxiaowan.github.io/categories/MySQL/"}],"tags":[]},{"title":"MySQLä½¿ç”¨æŸ¥è¯¢ç¼“å­˜","slug":"MySQLä½¿ç”¨æŸ¥è¯¢ç¼“å­˜","date":"2019-10-11T05:01:23.000Z","updated":"2019-10-21T15:48:59.282Z","comments":true,"path":"2019/10/11/MySQLä½¿ç”¨æŸ¥è¯¢ç¼“å­˜/","link":"","permalink":"http://luxiaowan.github.io/2019/10/11/MySQLä½¿ç”¨æŸ¥è¯¢ç¼“å­˜/","excerpt":"","text":"æŸ¥è¯¢æœåŠ¡æ˜¯å¦å·²å¼€å¯ç¼“å­˜ æ‰§è¡Œshow variables like '%query_cache%';æŸ¥çœ‹ç¼“å­˜çŠ¶æ€ Variable_name: query_cache_typeä¸ºç¼“å­˜çŠ¶æ€ï¼ŒONè¡¨ç¤ºå¼€å¯ï¼ŒOFFè¡¨ç¤ºå…³é—­ å¼€å¯/å…³é—­ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ ä¿®æ”¹my.cnfæ–‡ä»¶è¿›è¡Œå¼€å¯å’Œå…³é—­ [mysqld]ä¸­æ·»åŠ /ä¿®æ”¹ï¼š query_cache_size = 20M query_cache_type = ON/OFF **ä¿®æ”¹å®Œæˆåé‡å¯MySQLæœåŠ¡ï¼šservice mysql restart/systemctl mysql restart ** æŸ¥è¯¢ç¼“å­˜ä½¿ç”¨æƒ…å†µ æ‰§è¡Œshow status like 'qcache%';æŸ¥è¯¢ç¼“å­˜ä½¿ç”¨æƒ…å†µ å› ä¸ºæœ¬æœºMySQLæœªå¼€å¯æŸ¥è¯¢ç¼“å­˜ï¼Œæ‰€ä»¥æ­¤å¤„å’Œä½¿ç”¨ç›¸å…³çš„å±æ€§å‡ä¸º0 å±æ€§è§£é‡Š: å±æ€§ é‡Šä¹‰ Qcache_free_blocks ç¼“å­˜ä¸­ç›¸é‚»å†…å­˜å—çš„ä¸ªæ•°ã€‚æ•°ç›®å¤§è¯´æ˜å¯èƒ½æœ‰ç¢ç‰‡ã€‚FLUSH QUERY CACHEä¼šå¯¹ç¼“å­˜ä¸­çš„ç¢ç‰‡è¿›è¡Œæ•´ç†ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªç©ºé—²å—ã€‚ Qcache_free_memory ç¼“å­˜ä¸­ç©ºé—²å†…å­˜å¤§å° Qcache_hits ç¼“å­˜å‘½ä¸­æ¬¡æ•°ï¼Œå‘½ä¸­ä¸€æ¬¡å°±+1 Qcache_inserts æŸ¥è¯¢æ¬¡æ•°ï¼Œå‘½ä¸­æ¬¡æ•°/æŸ¥è¯¢æ¬¡æ•°=ç¼“å­˜å‘½ä¸­ç‡ Qcache_lowmem_prunes ç¼“å­˜å‡ºç°å†…å­˜ä¸è¶³å¹¶ä¸”å¿…é¡»è¦è¿›è¡Œæ¸…ç†ä»¥ä¾¿ä¸ºæ›´å¤šæŸ¥è¯¢æä¾›ç©ºé—´çš„æ¬¡æ•°ï¼Œå¦‚æœæ•°å­—ä¸æ–­å¢é•¿ï¼Œå°±å¯èƒ½ç¢ç‰‡éå¸¸ä¸¥é‡ï¼Œæˆ–è€…å†…å­˜å¾ˆå°‘ï¼Œé€šè¿‡Qcache_free_blocksã€Qcache_free_memoryæ¥åˆ†æå…·ä½“æƒ…å†µ Qcache_not_cached ä¸é€‚åˆè¿›è¡Œç¼“å­˜çš„æŸ¥è¯¢çš„æ•°é‡ Qcache_queries_in_cache å½“å‰ç¼“å­˜çš„æŸ¥è¯¢(å’Œå“åº”)çš„æ•°é‡ Qcache_total_blocks ç¼“å­˜ä¸­å—çš„æ•°é‡","categories":[{"name":"MySQL","slug":"MySQL","permalink":"http://luxiaowan.github.io/categories/MySQL/"}],"tags":[]},{"title":"JavaåŸºç¡€é¢è¯•é¢˜","slug":"èš‚èšJavaåŸºç¡€é¢è¯•é¢˜","date":"2019-10-10T15:21:56.000Z","updated":"2019-10-21T15:49:27.313Z","comments":true,"path":"2019/10/10/èš‚èšJavaåŸºç¡€é¢è¯•é¢˜/","link":"","permalink":"http://luxiaowan.github.io/2019/10/10/èš‚èšJavaåŸºç¡€é¢è¯•é¢˜/","excerpt":"","text":"ä¸€ mapæ€ä¹ˆå®ç°hashcodeå’Œequals,ä¸ºä»€ä¹ˆé‡å†™equalså¿…é¡»é‡å†™hashcode ä½¿ç”¨è¿‡concurrentåŒ…ä¸‹çš„å“ªäº›ç±»ï¼Œä½¿ç”¨åœºæ™¯ç­‰ç­‰ã€‚ concurrentHashMapæ€ä¹ˆå®ç°ï¼Ÿconcurrenthashmapåœ¨1.8å’Œ1.7é‡Œé¢æœ‰ä»€ä¹ˆåŒºåˆ« CountDownLatchã€LinkedHashMapã€AQSå®ç°åŸç† çº¿ç¨‹æ± æœ‰å“ªäº›RejectedExecutionHandler,åˆ†åˆ«å¯¹åº”çš„ä½¿ç”¨åœºæ™¯ å¤šçº¿ç¨‹çš„é”ï¼Ÿæ€ä¹ˆä¼˜åŒ–çš„ï¼Ÿåå‘é”ã€è½»é‡çº§é”ã€é‡é‡çº§é”ï¼Ÿ ç»„åˆç´¢å¼•ï¼ŸB+æ ‘å¦‚ä½•å­˜å‚¨çš„ï¼Ÿ ä¸ºä»€ä¹ˆç¼“å­˜æ›´æ–°ç­–ç•¥æ˜¯å…ˆæ›´æ–°æ•°æ®åº“ååˆ é™¤ç¼“å­˜ OOMè¯´ä¸€ä¸‹ï¼Ÿæ€ä¹ˆæ’æŸ¥ï¼Ÿå“ªäº›ä¼šå¯¼è‡´OOM? OSIä¸ƒå±‚ç»“æ„ï¼Œæ¯å±‚ç»“æ„éƒ½æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ javaçš„çº¿ç¨‹å®‰å…¨queueéœ€è¦æ³¨æ„çš„ç‚¹ æ­»é”çš„åŸå› ï¼Œå¦‚ä½•é¿å… äºŒ jvmè™šæ‹Ÿæœºè€å¹´ä»£ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‘ç”Ÿgcï¼Œç»™ä½ ä¸€ä¸ªåœºæ™¯ï¼Œä¸€å°4æ ¸8Gçš„æœåŠ¡å™¨ï¼Œæ¯éš”ä¸¤ä¸ªå°æ—¶å°±è¦å‡ºç°ä¸€æ¬¡è€å¹´ä»£gcï¼Œç°åœ¨æœ‰æ—¥å¿—ï¼Œæ€ä¹ˆåˆ†ææ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ æ•°æ®åº“ç´¢å¼•æœ‰å“ªäº›ï¼Ÿåº•å±‚æ€ä¹ˆå®ç°çš„ï¼Ÿæ•°æ®åº“æ€ä¹ˆä¼˜åŒ–ï¼Ÿ æ•°æ®åº“çš„äº‹åŠ¡ï¼Œå››ä¸ªæ€§è´¨è¯´ä¸€ä¸‹ï¼Œåˆ†åˆ«æœ‰ä»€ä¹ˆç”¨ï¼Œæ€ä¹ˆå®ç°çš„ï¼Ÿ æœåŠ¡å™¨å¦‚ä½•è´Ÿè½½å‡è¡¡ï¼Œæœ‰å“ªäº›ç®—æ³•ï¼Œå“ªä¸ªæ¯”è¾ƒå¥½ï¼Œä¸€è‡´æ€§å“ˆå¸ŒåŸç†ï¼Œæ€ä¹ˆé¿å…DDOSæ”»å‡»è¯·æ±‚æ‰“åˆ°å°‘æ•°æœºå™¨ volatileè®²è®² å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿè£…é¥°å™¨ã€ä»£ç†è®²è®²ï¼Ÿ redisé›†ç¾¤ä¼šå—ï¼Ÿ mysqlå­˜å‚¨å¼•æ“ äº‹åŠ¡éš”ç¦»çº§åˆ« ä¸å¯é‡å¤åº¦å’Œå¹»è¯»ï¼Œæ€ä¹ˆé¿å…ï¼Œåº•å±‚æ€ä¹ˆå®ç°ï¼ˆè¡Œé”è¡¨é”ï¼‰ ä¸‰ é¡¹ç›®ä»‹ç» åˆ†å¸ƒå¼é”æ˜¯æ€ä¹ˆå®ç°çš„ MySQLæœ‰å“ªå‡ ç§joinæ–¹å¼ï¼Œåº•å±‚åŸç†æ˜¯ä»€ä¹ˆ Redisæœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿåº•å±‚çš„ç¼–ç æœ‰å“ªäº›ï¼Ÿæœ‰åºé“¾è¡¨é‡‡ç”¨äº†å“ªäº›ä¸åŒçš„ç¼–ç ï¼Ÿ Redisæ‰©å®¹ï¼Œå¤±æ•ˆkeyæ¸…ç†ç­–ç•¥ Redisçš„æŒä¹…åŒ–æ€ä¹ˆåšï¼Œaofå’Œrdbï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ã€‚ MySQLæ•°æ®åº“æ€ä¹ˆå®ç°åˆ†åº“åˆ†è¡¨ï¼Œä»¥åŠæ•°æ®åŒæ­¥ï¼Ÿ å•ç‚¹ç™»å½•å¦‚ä½•æ˜¯å®ç°ï¼Ÿ è°ˆè°ˆSpringBootå’ŒSpringCloudçš„ç†è§£ æœªæ¥çš„æŠ€æœ¯èŒä¸šæ€ä¹ˆè§„åˆ’ï¼Ÿ ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬å…¬å¸ï¼Ÿ","categories":[{"name":"Java","slug":"Java","permalink":"http://luxiaowan.github.io/categories/Java/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"http://luxiaowan.github.io/tags/é¢è¯•/"},{"name":"é˜¿é‡Œ","slug":"é˜¿é‡Œ","permalink":"http://luxiaowan.github.io/tags/é˜¿é‡Œ/"}]}]}