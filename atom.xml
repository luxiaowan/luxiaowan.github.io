<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä¸²ä¸€ä¸²</title>
  
  <subtitle>æ–­èˆç¦»</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://luxiaowan.github.io/"/>
  <updated>2019-10-30T16:43:50.550Z</updated>
  <id>http://luxiaowan.github.io/</id>
  
  <author>
    <name>cc</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨::stringç¯‡</title>
    <link href="http://luxiaowan.github.io/2019/10/29/Redis%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%E2%80%94string%E7%AF%87/"/>
    <id>http://luxiaowan.github.io/2019/10/29/RedisåŸºæœ¬å‘½ä»¤ä½¿ç”¨â€”stringç¯‡/</id>
    <published>2019-10-29T15:55:00.000Z</published>
    <updated>2019-10-30T16:43:50.550Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Redisæœ‰6å¤§åŸºæœ¬ç±»å‹ï¼Œåˆ†åˆ«æ˜¯å­—ç¬¦ä¸²(String)ã€åˆ—è¡¨(List)ã€é›†åˆ(set)ã€å“ˆå¸Œç»“æ„(hash)ã€æœ‰åºé›†åˆ(zset)å’ŒåŸºæ•°(HyperLogLog)</p></blockquote><p><strong>redisåœ¨çº¿ä½“éªŒåœ°å€ï¼š<a href="http://try.redis.io/" target="_blank" rel="noopener">http://try.redis.io/</a></strong></p><h2 id="å­—ç¬¦ä¸²string"><a class="markdownIt-Anchor" href="#å­—ç¬¦ä¸²string"></a> å­—ç¬¦ä¸²(String)</h2><blockquote><p>ä»‹ç»:</p></blockquote><p>å­—ç¬¦ä¸²æ˜¯Redisä¸­æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œæ•°æ®ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å­˜å‚¨äºå†…å­˜ä¸­ï¼Œæ‰€ä»¥Redisçš„å­—ç¬¦ä¸²å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„æ•°æ®ï¼Œæ¯”å¦‚JPEGå›¾åƒã€åºåˆ—åŒ–çš„Rubyå¯¹è±¡ç­‰ã€‚</p><p>å­—ç¬¦ä¸²æœ€å¤§å¯å­˜å‚¨512MBçš„æ•°æ®ï¼Œä½†ä¸€èˆ¬ä¸€ä¸ªå­—ç¬¦ä¸²å®¹é‡è¿‡å¤§ï¼Œä¼šç›´æ¥å½±å“å­˜å‚¨å’ŒæŸ¥è¯¢çš„æ•ˆç‡ã€‚å­—ç¬¦ä¸²æœ‰ä¸¤ç§ç¼–ç æ–¹å¼ï¼šrawå’Œembstrï¼Œæ ¹æ®å­—ç¬¦ä¸²é•¿åº¦è‡ªåŠ¨é€‰æ‹©ä½¿ç”¨å“ªä¸€ç§ç¼–ç ï¼Œç›®å‰æœ€æ–°ç‰ˆçš„é•¿åº¦æ˜¯44ä¸ªå­—èŠ‚ï¼Œå­—ç¬¦ä¸²é•¿åº¦å°äºç­‰äº44ä¸ªå­—èŠ‚ï¼Œåˆ™ä½¿ç”¨embstrç¼–ç ï¼Œå¤§äº44ä¸ªå­—èŠ‚åˆ™ä½¿ç”¨rawç¼–ç ï¼Œä¸¤ç§ç¼–ç æ–¹å¼è¿™é‡Œå°±ä¸ä½œè¯¦è§£ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è°·æ­Œä¸€ä¸‹ã€‚</p><blockquote><p>åˆ›å»ºç¼“å­˜</p></blockquote><ol><li><p>åˆ›å»ºä¸€ä¸ªç¼“å­˜</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>set key value</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">set</span> <span class="string">cc</span> <span class="string">'niubility'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">åˆ›å»ºä¸€ä¸ªkeyä¸ºccï¼Œå€¼ä¸ºniubilityçš„ç¼“å­˜</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>æ‰¹é‡åˆ›å»ºç¼“å­˜</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>mset key value [key value ...]</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">mset</span> <span class="string">cc1</span> <span class="number">1</span> <span class="string">cc2</span> <span class="number">2</span> <span class="string">cc3</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">åˆ›å»ºä¸‰ä¸ªç¼“å­˜ï¼Œkey:valueåˆ†åˆ«ä¸ºcc1:1,</span> <span class="attr">cc2:2,</span> <span class="attr">cc3:3</span></span><br></pre></td></tr></table></figure></li><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>msetnx key value [key value ...]</code></p><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">msetnx</span> <span class="string">cc1</span> <span class="number">11</span> <span class="string">cc2</span> <span class="number">22</span> <span class="string">cc5</span> <span class="number">5</span> <span class="string">cc6</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">æ­¤å‘½ä»¤åªä¼šå°†å°šä¸å­˜åœ¨çš„keyå€¼åˆ›å»ºåˆ°ç¼“å­˜ä¸­ï¼Œå·²ç»å­˜åœ¨çš„keyåˆ™å¿½ç•¥</span></span><br><span class="line"><span class="string">*</span> <span class="string">cc1ã€cc2å·²å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œæ‰€ä»¥ä¸ä¼šåˆ›å»º/æ›´æ–°æˆåŠŸï¼Œcc5ã€cc6ä¸å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œä¼šåˆ›å»º</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>åˆ›å»ºä¸€ä¸ªå¸¦è¿‡æœŸæ—¶é—´çš„ç¼“å­˜</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>setex key time value</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">setex</span> <span class="string">cc1</span> <span class="number">10</span> <span class="number">234</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">è®¾ç½®key:valueä¸ºcc1:234ä¸”è¿‡æœŸæ—¶é—´ä¸º10ç§’çš„ç¼“å­˜</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨keyçš„valueï¼Œè‹¥keyå·²å­˜åœ¨åˆ™ä¸è®¾ç½®</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>setnx key value</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">setnx</span> <span class="string">cc5</span> <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">è‹¥cc5çš„keyä¸å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™åˆ›å»ºkey:valueä¸ºcc5:12çš„ç¼“å­˜ï¼Œå¦åˆ™ä¸æ‰§è¡Œåˆ›å»º</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>ç»„åˆåˆ›å»ºä¸€ä¸ªç¼“å­˜(ç¼“å­˜è¿‡æœŸæ—¶é—´ã€æ˜¯å¦è¦†ç›–)</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>set key value [EX|PX time] [NX|XX]</code></p><blockquote><p>è§£æï¼š</p></blockquote><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   EXï¼šè¡¨æ˜è¿‡æœŸæ—¶é—´ä¸ºç§’</span><br><span class="line">   </span><br><span class="line">PXï¼šè¡¨æ˜è¿‡æœŸæ—¶é—´ä¸ºæ¯«ç§’</span><br><span class="line">   </span><br><span class="line">   NXï¼šè‹¥<span class="built_in">key</span>ä¸å­˜åœ¨åˆ™æ‰§è¡Œï¼Œå¦åˆ™ä¸æ‰§è¡Œï¼Œä¸XXç›¸å</span><br><span class="line">   </span><br><span class="line">   XXï¼šè‹¥<span class="built_in">key</span>å­˜åœ¨åˆ™æ‰§è¡Œï¼Œå¦åˆ™ä¸æ‰§è¡Œï¼Œä¸NXç›¸å</span><br></pre></td></tr></table></figure></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  <span class="string">set</span> <span class="string">cc1</span> <span class="number">123</span> <span class="string">EX</span> <span class="number">20</span> <span class="string">XX</span></span><br><span class="line">  </span><br><span class="line"><span class="meta">---</span></span><br><span class="line">  <span class="string">è‹¥cc1å·²å­˜åœ¨åˆ™åˆ›å»ºè¿‡æœŸæ—¶é—´ä¸º20ç§’çš„key:value</span> <span class="string">=</span> <span class="attr">cc1:123</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>å°†keyè®¾ç½®ä¸ºæ–°å€¼çš„åŒæ—¶è¿”å›åŸå€¼</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>getset key value</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">getset</span> <span class="string">cc1</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">è‹¥keyä¸å­˜åœ¨ï¼Œåˆ™è¿”å›nil</span></span><br></pre></td></tr></table></figure></li></ul></li></ol><blockquote><p>è¯»å–ç¼“å­˜</p></blockquote><ol><li><p>è¯»å–ä¸€ä¸ªkeyçš„ç¼“å­˜å€¼</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>get key</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">get</span> <span class="string">cc1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">è¯»å–key=cc1çš„å€¼</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>æ‰¹é‡è¯»å–ä¸€æ‰¹æ•°æ®</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>mget key [key ...]</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mget <span class="keyword">cc</span><span class="number">1</span> <span class="keyword">cc</span><span class="number">2</span> <span class="keyword">cc</span><span class="number">3</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>æˆªå–å­—ç¬¦ä¸²å¹¶è¿”å›</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>getrange key start end</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">getrange</span> <span class="string">cc1</span> <span class="number">1</span> <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">å­—ç¬¦ä¸²ä¸‹æ ‡ä»¥0å¼€å§‹ï¼Œè‹¥startè¶…å‡ºå­—ç¬¦ä¸²é•¿åº¦æˆ–keyä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure></li></ul></li></ol><blockquote><p>å…¶ä»–æ“ä½œ</p></blockquote><ol><li><p>å°†valueåŠ 1( valueå¿…é¡»ä¸ºæ•´æ•° )[ å¯ç”¨äºé˜…è¯»é‡ã€ç‚¹èµæ•°ç­‰ç®€å•ç»Ÿè®¡ç±»çš„åŠŸèƒ½åº”ç”¨ ]</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>incr key</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">incr</span> <span class="string">cc1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">æ¯æ¬¡è°ƒç”¨å‡å¯¹valueè¿›è¡Œ+1æ“ä½œ</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>ç»™valueåŠ ä¸ŠæŸä¸ªæ•°( numå¿…é¡»ä¸ºæ•´æ•° )</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>incrby key num</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">incrby</span> <span class="string">cc1</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">ç»™cc1çš„å€¼åŠ ä¸Š100</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>ç»™valueåŠ ä¸ŠæŸä¸ªæµ®ç‚¹æ•°</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>incrbyfloat key num</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">incrbyfloat cc1 <span class="number">0.2</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>ç»™valueå‡1</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>decr key</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">decr</span> <span class="string">cc1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">æ¯æ¬¡è°ƒç”¨å‡å¯¹valueè¿›è¡Œ-1æ“ä½œ</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>ç»™valueå‡å»æŸä¸ªæ•°( numå¿…é¡»ä¸ºæ•´æ•° )</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>descby key num</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">decrby</span> <span class="string">cc1</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">ç»™cc1çš„å€¼å‡å»100</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>æŸ¥çœ‹valueçš„é•¿åº¦</p><ul><li><p>å‘½ä»¤æ ¼å¼ï¼š<code>strlen key</code></p></li><li><blockquote><p>ğŸŒ°</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strlen</span> cc1</span><br></pre></td></tr></table></figure></li></ul></li></ol><p>ç›®å‰å…ˆæ•´ç†è¿™äº›ï¼Œéƒ½æ˜¯ä¸€äº›åŸºç¡€çš„å‘½ä»¤ï¼Œéšåå†å†™ä¸€ç¯‡Javaä¸­ä½¿ç”¨Jedisæ“ä½œå­—ç¬¦ä¸²çš„éšç¬”ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;Redisæœ‰6å¤§åŸºæœ¬ç±»å‹ï¼Œåˆ†åˆ«æ˜¯å­—ç¬¦ä¸²(String)ã€åˆ—è¡¨(List)ã€é›†åˆ(set)ã€å“ˆå¸Œç»“æ„(hash)ã€æœ‰åºé›†åˆ(zset)å’ŒåŸºæ•°(HyperLogLog)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;redisåœ¨çº¿ä½“éªŒåœ°å€ï¼š
      
    
    </summary>
    
    
      <category term="Redis" scheme="http://luxiaowan.github.io/categories/Redis/"/>
    
    
  </entry>
  
  <entry>
    <title>Redisæ•°æ®åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„</title>
    <link href="http://luxiaowan.github.io/2019/10/29/Redis%E6%95%B0%E6%8D%AE%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E6%98%AF%E5%A6%82%E4%BD%95%E5%AD%98%E5%82%A8%E7%9A%84/"/>
    <id>http://luxiaowan.github.io/2019/10/29/Redisæ•°æ®åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„/</id>
    <published>2019-10-29T08:50:00.000Z</published>
    <updated>2019-10-29T15:02:17.269Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="Redis" scheme="http://luxiaowan.github.io/categories/Redis/"/>
    
    
  </entry>
  
  <entry>
    <title>MySQLç´¢å¼•ä»€ä¹ˆæ—¶å€™ç”¨hash</title>
    <link href="http://luxiaowan.github.io/2019/10/28/MySQL%E7%B4%A2%E5%BC%95%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E7%94%A8hash/"/>
    <id>http://luxiaowan.github.io/2019/10/28/MySQLç´¢å¼•ä»€ä¹ˆæ—¶å€™ç”¨hash/</id>
    <published>2019-10-28T11:06:00.000Z</published>
    <updated>2019-10-29T14:10:04.447Z</updated>
    
    <content type="html"><![CDATA[<p>MySQLç´¢å¼•æ˜¯åœ¨é¢è¯•ä¸­å¸¸è¢«é—®åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå¸¸ç”¨çš„ä¸¤ç§ç´¢å¼•æ–¹æ³•æœ‰Hashå’ŒB+Treeï¼Œæ ‘çš„ç»“æ„æˆ‘ä»¬æ”¹å¤©å†æ‰¯ï¼Œä»Šå¤©è¯´æ”¶Hashã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆä½¿ç”¨hash</p></blockquote><p>Hashç´¢å¼•å¯ä»¥æ ¹æ®æ•°æ®çš„hashå€¼ç›´æ¥å®šä½åˆ°ç´¢å¼•æ•°æ®çš„å­˜å‚¨ä½ç½®ï¼Œå°±ç›¸å½“äºæˆ‘çŸ¥é“äº†æ•°ç»„çš„ä¸‹æ ‡ï¼Œç„¶åæ ¹æ®ä¸‹æ ‡å»å–æ•°æ®ï¼Œè¿™ä¸ªæ•ˆç‡å¯ä»¥è¯´æ˜¯æœ€é«˜çš„äº†ï¼Œä½¿ç”¨hashå°±æ˜¯ä¸ºäº†å¦‚æ­¤ã€‚</p><blockquote><p>æ”¯æŒhashçš„å­˜å‚¨å¼•æ“</p></blockquote><p>ç›®å‰æ”¯æŒhashçš„å¼•æ“æœ‰MEMORY(è¿™é‡Œéœ€è¦è°·æ­Œ)ï¼Œå…¶ä»–çš„å¼•æ“éƒ½é€šè¿‡å„è‡ªçš„æ–¹å¼å»æ”¯æŒhashæ–¹æ³•ã€‚å¦‚InnoDBæœ‰ä¸€å¥—è‡ªé€‚åº”hashç®—æ³•ï¼Œå†…éƒ¨å®ç°è¿˜æ˜¯é‡‡ç”¨äº†BTçš„æ–¹å¼ï¼Œå¯ä»¥ç†è§£ä¸ºBTç´¢å¼•çš„ç´¢å¼•</p><blockquote><p>InnoDBä¸­hashç´¢å¼•æ”¯æŒçš„å¼€å¯/å…³é—­</p></blockquote><p>hashç´¢å¼•è™½ç„¶éå¸¸å¿«é€Ÿï¼Œä½†æ˜¯åœ¨InnoDBä¸­ç¡®å®æ”¯æŒçš„ä¸æ˜¯å¾ˆå¥½ï¼Œå¹¶ä¸”ç´¢å¼•çš„å…·ä½“åˆ›å»ºæ˜¯ç”±å¼•æ“å†³å®šçš„(åˆ›å»ºåå­˜åœ¨äºå†…å­˜ä¸­)ï¼ŒéDBAå¯æ§ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹å»ºè®®å…³é—­hashæ”¯æŒï¼Œä½¿ç”¨BTä¹Ÿèƒ½å¤Ÿæ»¡è¶³æ€§èƒ½è¦æ±‚ã€‚</p><p>â€‹<code>set global innodb_adaptive_hash_index=off/on</code></p><blockquote><p>hashçš„ä½¿ç”¨åœºæ™¯</p></blockquote><p>hashä½¿ç”¨åœºæ™¯æ¯”è¾ƒå±€é™</p><ol><li>hashç´¢å¼•ä»…é€‚ç”¨äºâ€˜=â€™ã€â€˜&lt;=&gt;â€™å’Œâ€˜inâ€™æ“ä½œï¼Œæ‰€ä»¥hashä»…ä»…é€‚ç”¨äºç²¾ç¡®æŸ¥æ‰¾ã€‚</li><li>ä¸é€‚ç”¨äºæŸ¥è¯¢æ’åºï¼Œå› ä¸ºhashåçš„æ•°æ®å¹¶ä¸ä¼šåƒåŸæ•°æ®ä¸€æ ·ä¿æŒæœ‰åºã€‚</li><li>ä¸é€‚ç”¨äºæ¨¡ç³ŠæŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½ä½¿ç”¨likeå…³é”®å­—ã€‚</li><li>æ—¢ç„¶ä¸æ”¯æŒæ’åºï¼Œä¹Ÿè‚¯å®šä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢å’¯</li></ol><blockquote><p>è§£å†³hashå†²çª</p></blockquote><p>ä¸è®ºhashçš„ç®—æ³•å¤šä¹ˆç²¾ç¡®ï¼Œå½“æ•°æ®é‡å¤§çš„æ—¶å€™éƒ½æœ‰å¯èƒ½å‘ç”Ÿhashç¢°æ’ï¼Œè§£å†³hashç¢°æ’çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å†hashã€é“¾è¡¨å åŠ ç­‰ï¼ŒMySQLé‡‡ç”¨çš„æ˜¯é“¾è¡¨å åŠ çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ç±»ä¼¼äºHashMapè§£å†³hashç¢°æ’çš„æ–¹æ³•ã€‚æ‰€ä»¥åœ¨å‘ç”Ÿhashç¢°æ’è¿‡å¤šçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨hashç´¢å¼•ä¼šå½±å“æŸ¥è¯¢æ€§èƒ½ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;MySQLç´¢å¼•æ˜¯åœ¨é¢è¯•ä¸­å¸¸è¢«é—®åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå¸¸ç”¨çš„ä¸¤ç§ç´¢å¼•æ–¹æ³•æœ‰Hashå’ŒB+Treeï¼Œæ ‘çš„ç»“æ„æˆ‘ä»¬æ”¹å¤©å†æ‰¯ï¼Œä»Šå¤©è¯´æ”¶Hashã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆä½¿ç”¨hash&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Hashç´¢å¼•å¯ä»¥æ ¹æ®æ•°æ®çš„hashå€¼ç›´æ¥å®šä½
      
    
    </summary>
    
    
      <category term="MySQL" scheme="http://luxiaowan.github.io/categories/MySQL/"/>
    
    
  </entry>
  
  <entry>
    <title>Spring-Sessionå’ŒRediså®ç°Sessionå…±äº«</title>
    <link href="http://luxiaowan.github.io/2019/10/24/Spring-Session%E5%92%8CRedis%E5%AE%9E%E7%8E%B0Session%E5%85%B1%E4%BA%AB/"/>
    <id>http://luxiaowan.github.io/2019/10/24/Spring-Sessionå’ŒRediså®ç°Sessionå…±äº«/</id>
    <published>2019-10-24T11:30:00.000Z</published>
    <updated>2019-10-24T15:18:45.220Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>éœ€æ±‚</p><blockquote><p>ç°åœ¨å¤§éƒ¨åˆ†æœåŠ¡éƒ½ä»¥é›†ç¾¤è´Ÿè½½å‡è¡¡çš„æ–¹å¼éƒ¨ç½²ï¼Œå‡ ä¹å¾ˆéš¾å†é‡åˆ°å•ç‚¹éƒ¨ç½²çš„é¡¹ç›®ï¼Œå› ä¸ºå¤§å®¶éƒ½è¦ä¿è¯æœ€åŸºæœ¬çš„HAï¼Œè¯´åˆ°HAï¼Œç¬¬ä¸€è¦è€ƒè™‘çš„å°±æ˜¯å„ç³»ç»Ÿä¹‹é—´çš„Sessionå…±äº«çš„é—®é¢˜ï¼Œå¦‚ä½•è§£å†³å‘¢ï¼Ÿè´Ÿè½½å‡è¡¡å½“å‰ä½¿ç”¨Nginx</p></blockquote></blockquote><hr><blockquote><p>åˆ†æ</p><blockquote><p><img src="/images/image-20191024193415981.png" alt></p></blockquote><blockquote><ol><li>ä¸åŒçš„PODä¹‹é—´å¦‚æœéœ€è¦è¾¾åˆ°æ•°æ®å…±äº«çš„ç›®çš„ï¼Œé‚£ä¹ˆåˆ™éœ€è¦ä½¿ç”¨åŒä¸€ä¸ªå­˜å‚¨åª’ä»‹ï¼Œä¸€å¼€å§‹æƒ³åˆ°ä½¿ç”¨MySQLæ¥å­˜å‚¨ç™»å½•sessionï¼Œä½†æ˜¯æ¯æ¬¡è¯·æ±‚éƒ½å»MySQLä¸­æŸ¥è¯¢æ•°æ®ï¼Œå¼€é”€è¿˜æ˜¯éå¸¸å¤§çš„ï¼›ç„¶åæœ€è¿‘ä½¿ç”¨MongoDBæ¯”è¾ƒå—¨ï¼Œæƒ³ç€ç”¨MongoDBï¼Œä½†æ˜¯MongoDBæŸ¥è¯¢èµ·æ¥ä¹Ÿä¸æ–¹ä¾¿ï¼Œå†µä¸”æˆ‘ä»¬è¿™ä¸ªSessionä¹Ÿä¸æ˜¯é‡çº§å¾ˆå¤§çš„æ•°æ®é›†ï¼Œæœ€ç»ˆé‡‡ç”¨äº†å†…å­˜çº§çš„Redisæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</li><li>ä½¿ç”¨Redisçš„åŸºæœ¬æ“ä½œæ˜¯å°†jsessionIdä¸ºkeyï¼Œç”¨æˆ·ä¿¡æ¯ä¸ºvalueï¼Œä½¿ç”¨jedisæˆ–è€…redisTemplateæ¥æ“ä½œRedisçš„è¯»å†™è¡Œä¸ºã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¾µå…¥äº†ä¸šåŠ¡ä»£ç ï¼Œå¹¶ä¸æ˜¯æœ€ä¼˜è§£ï¼ŒæŸ¥äº†éƒ¨åˆ†èµ„æ–™ä¹‹åï¼Œå‘ç°spring-session.jaråŒ…ä¸­æœ‰ä¸€ä¸ªéå¸¸æœ‰ç‰¹è‰²çš„æ³¨è§£@EnableRedisHttpSessionï¼Œå¯ä»¥ä¸éœ€è¦ä¾µå…¥ä¸šåŠ¡ä»£ç å°±èƒ½ä½¿ç”¨rediså®ç°sessionå…±äº«çš„é—®é¢˜ã€‚</li></ol></blockquote></blockquote><ul><li>æˆ‘ä»¬çœ‹ä¸€ä¸‹@EnableRedisHttpSessionçš„æºç æ˜¯æ€ä¹ˆè¯´çš„ï¼š</li></ul><p><img src="/images/image-20191024223839113.png" alt="image-20191024223839113"></p><blockquote><p>å°†æ­¤æ³¨é‡Šæ·»åŠ åˆ°ä¸€ä¸ªå•ç‹¬çš„ç±»ä¸Šï¼Œè¯¥ç±»å¿…é¡»åŠ ä¸Š@Configurationæ³¨è§£ã€‚ä½¿ç”¨æ–¹å¼åœ¨æ³¨é‡Šé‡Œä¹Ÿç»™å‡ºäº†demoä»£ç ã€‚</p></blockquote><hr><blockquote><p>å®ç°</p></blockquote><ol><li>ä¿®æ”¹pom.xmlæ–‡ä»¶ï¼Œå¼•å…¥æˆ‘ä»¬éœ€è¦çš„jaråŒ…</li></ol><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-session&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>ä¿®æ”¹application.ymlæ–‡ä»¶ï¼Œé…ç½®redisä¿¡æ¯</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.redis.database=<span class="number">0</span></span><br><span class="line">spring.redis.host=localhost</span><br><span class="line">spring.redis.port=<span class="number">6379</span></span><br><span class="line">spring.redis.password=<span class="number">123456</span></span><br></pre></td></tr></table></figure><ol start="3"><li>åˆ›å»ºé…ç½®ç±»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.session.data.redis.config.annotation.web.http.EnableRedisHttpSession;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableRedisHttpSession</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisHttpSessionConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨Rediså®ç°Sessionå…±äº«çš„æ‰€æœ‰é…ç½®å’Œä»£ç éƒ½å·²ç»å†™å®Œäº†ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ²¡æœ‰ä¾µå…¥åˆ°ä»»ä½•ä¸šåŠ¡ä»£ç ä¸­ï¼Œä»å¤´åˆ°å°¾ä¹Ÿå¾ˆç®€å•ã€‚</p><blockquote><p>æ‰©å±•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableGemFireHttpSession</span></span><br><span class="line"><span class="meta">@EnableSpringHttpSession</span></span><br><span class="line"><span class="meta">@EnableMongoHttpSession</span></span><br><span class="line"><span class="meta">@EnableJdbcHttpSession</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;éœ€æ±‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç°åœ¨å¤§éƒ¨åˆ†æœåŠ¡éƒ½ä»¥é›†ç¾¤è´Ÿè½½å‡è¡¡çš„æ–¹å¼éƒ¨ç½²ï¼Œå‡ ä¹å¾ˆéš¾å†é‡åˆ°å•ç‚¹éƒ¨ç½²çš„é¡¹ç›®ï¼Œå› ä¸ºå¤§å®¶éƒ½è¦ä¿è¯æœ€åŸºæœ¬çš„HAï¼Œè¯´åˆ°HAï¼Œç¬¬ä¸€è¦è€ƒè™‘çš„å°±æ˜¯å„ç³»ç»Ÿä¹‹é—´çš„Sessionå…±äº«çš„é—®é¢˜ï¼Œå¦‚ä½•è§£å†³å‘¢ï¼Ÿè´Ÿè½½å‡è¡¡å½“å‰ä½¿ç”¨Ngin
      
    
    </summary>
    
    
      <category term="SpringBoot" scheme="http://luxiaowan.github.io/categories/SpringBoot/"/>
    
    
  </entry>
  
  <entry>
    <title>Javaç®€å•æ“ä½œMongoDB</title>
    <link href="http://luxiaowan.github.io/2019/10/24/Java%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9CMongoDB/"/>
    <id>http://luxiaowan.github.io/2019/10/24/Javaç®€å•æ“ä½œMongoDB/</id>
    <published>2019-10-24T02:16:00.000Z</published>
    <updated>2019-10-24T13:20:12.762Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‰é¢å·²ç»æŒæ¡äº†mongoæœ€åŸºæœ¬çš„ä¸€äº›å‘½ä»¤ï¼Œå¯¹å„ä¸ªå‘½ä»¤ä¹Ÿéƒ½å®æ“è¿‡ï¼Œç†è§£å„å‘½ä»¤çš„æ„æ€ï¼Œä¹Ÿå¯¹mongoæœ‰äº†æœ€åŸºæœ¬çš„ç†è§£ï¼Œä½†å¤§éƒ¨åˆ†çŒ¿è¿˜æ˜¯æƒ³ä½¿ç”¨Javaå»è¿æ¥mongoï¼Œä¸²ä¸²ä¹Ÿä¸ä¾‹å¤–</p></blockquote><ul><li><p>åœ¨pom.xmlä¸­åŠ å…¥mongodb-java-driver.jarçš„ä¾èµ–</p><ul><li><p>Mavené¡¹ç›®ä¾èµ–</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.mongodb&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;mongo-java-driver&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;3.0.4&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li><li><p>SpringBooté¡¹ç›®ä¾èµ–</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>è¿æ¥mongo</p><ul><li><p>è®¤è¯è¿æ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºéªŒè¯ä¿¡æ¯ï¼Œæ ¹æ®åŠ å¯†æ–¹å¼é€‰æ‹©MongoCredentialå†…å¯¹åº”çš„åŠ å¯†æ–¹å¼</span></span><br><span class="line">List&lt;MongoCredential&gt; credentials = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">MongoCredential credential = MongoCredential.createCredential(<span class="string">"admin"</span>, <span class="string">"test1"</span>, <span class="string">"admin"</span>.toCharArray());</span><br><span class="line">credentials.add(credential);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºmongoæœåŠ¡åœ°å€</span></span><br><span class="line">ServerAddress serverAddress = <span class="keyword">new</span> ServerAddress(<span class="string">"localhost"</span>, <span class="number">27017</span>);</span><br><span class="line">MongoClient mongoClient = <span class="keyword">new</span> MongoClient(serverAddress, credentials);</span><br></pre></td></tr></table></figure></li><li><p>æ— éœ€è®¤è¯è¿æ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MongoClient client = <span class="keyword">new</span> MongoClient(<span class="string">"localhost"</span>, <span class="number">27017</span>);</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥é€šè¿‡MongoClientçš„å®ä¾‹æ–¹æ³•å¯¹mongoè¿›è¡Œç›¸å…³æ“ä½œäº†</p></li></ul></li><li><p>åˆ›å»ºæ•°æ®åº“è¿æ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MongoDatabase db = client.getDatabase(<span class="string">"test1"</span>);</span><br></pre></td></tr></table></figure><blockquote><p>mongoç‰¹æ€§æ˜¯ä¸ç®¡æ•°æ®åº“äº‹å…ˆæ˜¯å¦å­˜åœ¨ï¼Œéƒ½å¯ä»¥æ­£å¸¸åˆ›å»ºæ•°æ®åº“è¿æ¥ï¼Œä¸ä¼šåƒMySQLä¸€æ ·æŠ¥é”™ï¼Œè¿æ¥æˆåŠŸåï¼Œåœ¨mongoæœåŠ¡å™¨ä¸Šæ‰§è¡Œ<code>show dbs</code>ï¼Œä¼šå‘ç°ä»ç„¶æŸ¥ä¸åˆ°æˆ‘ä»¬è¿æ¥çš„è¿™ä¸ªæ•°æ®åº“ï¼Œè¿™æ˜¯æ­£å¸¸æƒ…å†µï¼Œåªæœ‰åœ¨æ•°æ®åº“ä¸­æœ‰æ•°æ®çš„æ—¶å€™ï¼Œæ‰ä¼šæŸ¥å¾—å‡ºæ¥ï¼Œ<code>client.getDatabase(&quot;test&quot;) === use testå‘½ä»¤</code></p></blockquote></li><li><p>åˆ›å»ºé›†åˆ</p><ul><li>ä½¿ç”¨æ•°æ®åº“è¿æ¥å®ä¾‹æ–¹æ³•åˆ›å»ºä¸€ä¸ªç©ºçš„é›†åˆ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection(<span class="string">"base_info"</span>);</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">  å‘½ä»¤ï¼šdb.createCollection(<span class="string">"base_info"</span>)</span><br></pre></td></tr></table></figure><ul><li>ç›´æ¥å‘åˆ›å»ºçš„é›†åˆä¸­æ’å…¥æ•°æ®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MongoCollection&lt;Document&gt; collection = db.getCollection(<span class="string">"base_info"</span>);</span><br><span class="line">collection.insertOne(<span class="keyword">new</span> Document(<span class="string">"name"</span>, <span class="string">"lxl"</span>));</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">  å‘½ä»¤ï¼šdb.base_info.insert(&#123;<span class="string">"name"</span>: <span class="string">"lxl"</span>&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>ä»¥ä¸Šä¸¤ç§æ–¹å¼å‡å¯åˆ›å»ºä¸€ä¸ªé›†åˆï¼ŒåŒºåˆ«åœ¨äºç¬¬ä¸€ç§æ–¹å¼åˆ›å»ºçš„æ˜¯ç©ºé›†åˆï¼Œ</p></blockquote></li><li><p>åˆ é™¤é›†åˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">collection.drop();</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">  å‘½ä»¤ï¼šdb.base_info.drop()</span><br></pre></td></tr></table></figure></li></ul><h4 id="å¯¹é›†åˆçš„crud"><a class="markdownIt-Anchor" href="#å¯¹é›†åˆçš„crud"></a> å¯¹é›†åˆçš„CRUD</h4><ul><li><p>æ–°å¢æ•°æ®</p><ul><li><p>å•æ¡æ–°å¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Document document = <span class="keyword">new</span> Document().append(<span class="string">"name"</span>,<span class="string">"cc"</span>).append(<span class="string">"age"</span>,<span class="number">30</span>).append(<span class="string">"location"</span>,<span class="string">"SZ"</span>);</span><br><span class="line">collection.insertOne(document);</span><br></pre></td></tr></table></figure></li><li><p>æ‰¹é‡æ–°å¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Document&gt; documentList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">  Document doc = <span class="keyword">new</span> Document().append(<span class="string">"name"</span>, <span class="string">"cc"</span> + i).append(<span class="string">"age"</span>, <span class="keyword">new</span> Random().nextInt(<span class="number">100</span>)).append(<span class="string">"location"</span>, <span class="string">"SZ"</span>);</span><br><span class="line">  documentList.add(doc);</span><br><span class="line">&#125;</span><br><span class="line">collection.insertMany(documentList);</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>insertOne(Document)æ–¹æ³•æ¯æ¬¡æ’å…¥ä¸€æ¡æ•°æ®</p><p>insertMany(List<document>)æ–¹æ³•æ‰¹é‡æ’å…¥æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å‚æ•°InsertManyOptionsè®¾ç½®æ˜¯å¦æ’åº</document></p></blockquote></li><li><p>åˆ é™¤æ•°æ®</p><ul><li>åˆ é™¤ç¬¬ä¸€æ¡åŒ¹é…çš„æ•°æ®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.eq(<span class="string">"age"</span>, <span class="number">99</span>);</span><br><span class="line">collection.deleteOne(condition);</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">  å‘½ä»¤ï¼šdb.base_info.deleteOne(&#123;<span class="string">"age"</span>: <span class="number">99</span>&#125;)</span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤æ‰€æœ‰åŒ¹é…æ•°æ®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.eq(<span class="string">"age"</span>, <span class="number">99</span>);</span><br><span class="line">collection.deleteMany(condition);</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">  å‘½ä»¤ï¼šdb.base_info.deleteMany(&#123;<span class="string">"ag"</span>: <span class="number">99</span>&#125;)</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢æ•°æ®</p><ul><li><p>æŸ¥è¯¢è¿”å›ç¬¬ä¸€æ¡åŒ¹é…çš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.eq(<span class="string">"age"</span>, <span class="number">16</span>);</span><br><span class="line">FindIterable&lt;Document&gt; vals = collection.find(condition);</span><br><span class="line">Document document = vals.first();</span><br><span class="line">System.out.println(document.toJson());</span><br></pre></td></tr></table></figure><blockquote><p>é€šè¿‡è°ƒç”¨FindIterableçš„å®ä¾‹æ–¹æ³•first()å–ç¬¬ä¸€æ¡æ•°æ®</p></blockquote></li><li><p>æŸ¥è¯¢è¿”å›æ‰€æœ‰åŒ¹é…æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.eq(<span class="string">"age"</span>, <span class="number">16</span>);</span><br><span class="line">FindIterable&lt;Document&gt; vals = collection.find(condition);</span><br><span class="line"><span class="keyword">for</span> (Document val : vals) &#123;</span><br><span class="line">  System.out.println(val.toJson());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>find()æ–¹æ³•è¿”å›æ‰€æœ‰åŒ¹é…æ•°æ®</p></blockquote></li><li><p>åˆ†é¡µæŸ¥è¯¢</p><p>åˆ†é¡µæŸ¥è¯¢æ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯mongoè¿™ç§é‡çº§è¾ƒå¤§çš„å­˜å‚¨ï¼Œåˆ†é¡µä½¿ç”¨limit()å’Œskip()ä¸¤ä¸ªæ–¹æ³•æ¥å®ç°ï¼ŒlimitæŒ‡å®šæŸ¥è¯¢çš„æ¡æ•°ï¼Œskipè¿›è¡Œåˆ†é¡µï¼Œå‚æ•°ä¸ºä»ç¬¬å‡ æ¡å¼€å§‹ï¼Œéœ€è¦ä½¿ç”¨å½“å‰é¡µç å’Œåˆ†é¡µæ¡æ•°è¿›è¡Œè®¡ç®—(pageNo - 1) * pageSize</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.lt(<span class="string">"age"</span>, <span class="number">2</span>);</span><br><span class="line">FindIterable&lt;Document&gt; vals = collection.find(condition).limit(<span class="number">10</span>).skip(<span class="number">10</span>).sort(Sorts.descending(<span class="string">"age"</span>));</span><br><span class="line"><span class="keyword">for</span> (Document val : vals) &#123;</span><br><span class="line">  System.out.println(val.toJson());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>limit(10): æ¯é¡µå–10æ¡æ•°æ®</p><p>skip(10): ä»ç¬¬11æ¡å¼€å§‹æŸ¥è¯¢ï¼Œèµ·å§‹ä½ç½®ä¸º0</p><p>sort(Sorts.descending(â€œageâ€)): ä»¥åˆ—ageå€’åº</p><blockquote><p>å¯¹åº”MySQLï¼šselect * from base_info where age &lt; 2 order by age desc limit 7, 7</p></blockquote></blockquote></li></ul></li><li><p>æ›´æ–°æ•°æ®</p><ul><li><p>æ›´æ–°ç¬¬ä¸€æ¡åŒ¹é…æ•°æ®ä¸­çš„æŸäº›å­—æ®µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.eq(<span class="string">"age"</span>, <span class="number">15</span>);</span><br><span class="line">Document document = <span class="keyword">new</span> Document(<span class="string">"$set"</span>, <span class="keyword">new</span> Document(<span class="string">"location"</span>, <span class="string">"XZ"</span>));</span><br><span class="line">collection.updateOne(condition, document);</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ª<code>$set</code>ï¼Œè¿™ä¸ªæŒ‡ä»¤æ˜¯å¿…é¡»çš„ï¼Œç›¸å¯¹åº”çš„æŒ‡ä»¤è¿˜æœ‰<code>$inc</code></p></blockquote></li><li><p>æ›¿æ¢ç¬¬ä¸€æ¡åŒ¹é…æ•°æ®å…¨éƒ¨å†…å®¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.eq(<span class="string">"age"</span>, <span class="number">15</span>);</span><br><span class="line">Document document = <span class="keyword">new</span> Document(<span class="string">"location"</span>, <span class="string">"XZ"</span>);</span><br><span class="line">collection.updateOne(condition, document);</span><br></pre></td></tr></table></figure><blockquote><p>æ²¡æœ‰<code>$set</code>æŒ‡ä»¤,åˆ™è¡¨ç¤ºä½¿ç”¨å‚æ•°documentæ›¿æ¢æ‰ç¬¬ä¸€æ¡åŒ¹é…åˆ°çš„æ•°æ®</p></blockquote></li><li><p>ç¬¬ä¸€æ¡åŒ¹é…çš„æ•°æ®ä¸­æŒ‡å®šå­—æ®µæ•°é‡+1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.eq(<span class="string">"location"</span>, <span class="string">"XZ"</span>);</span><br><span class="line">Document document = <span class="keyword">new</span> Document(<span class="string">"$inc"</span>, <span class="keyword">new</span> Document(<span class="string">"age"</span>, <span class="number">1</span>));</span><br><span class="line">collection.updateOne(condition, document);</span><br></pre></td></tr></table></figure></li><li><p>æ›´æ–°æ‰€æœ‰åŒ¹é…æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Bson condition = Filters.eq(<span class="string">"age"</span>, <span class="number">15</span>);</span><br><span class="line">Document document = <span class="keyword">new</span> Document(<span class="string">"$set"</span>, <span class="keyword">new</span> Document(<span class="string">"location"</span>, <span class="string">"XZ"</span>));</span><br><span class="line">collection.updateMany(condition, document);</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="å…¨éƒ¨ä»£ç "><a class="markdownIt-Anchor" href="#å…¨éƒ¨ä»£ç "></a> å…¨éƒ¨ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.bson.Document;</span><br><span class="line"><span class="keyword">import</span> org.bson.conversions.Bson;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mongodb.MongoClient;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.FindIterable;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.MongoCollection;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.MongoDatabase;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.model.Filters;</span><br><span class="line"><span class="keyword">import</span> com.mongodb.client.model.Sorts;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: cc</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MongoConnectTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MongoClient client = <span class="keyword">new</span> MongoClient(<span class="string">"localhost"</span>, <span class="number">27017</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            // åˆ›å»ºéªŒè¯ä¿¡æ¯ï¼Œæ ¹æ®åŠ å¯†æ–¹å¼é€‰æ‹©MongoCredentialå†…å¯¹åº”çš„åŠ å¯†æ–¹å¼</span></span><br><span class="line"><span class="comment">            List&lt;MongoCredential&gt; credentials = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">            MongoCredential credential = MongoCredential.createCredential("admin", "test", "".toCharArray());</span></span><br><span class="line"><span class="comment">            credentials.add(credential);</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            // åˆ›å»ºmongoæœåŠ¡åœ°å€</span></span><br><span class="line"><span class="comment">            ServerAddress serverAddress = new ServerAddress("localhost", 27017);</span></span><br><span class="line"><span class="comment">            MongoClient mongoClient = new MongoClient(serverAddress, credentials);*/</span></span><br><span class="line"></span><br><span class="line">            MongoDatabase db = client.getDatabase(<span class="string">"test1"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ›å»ºé›†åˆ</span></span><br><span class="line">            <span class="comment">// æ–¹å¼1</span></span><br><span class="line">            <span class="comment">// db.createCollection("base_info2");</span></span><br><span class="line">            <span class="comment">// æ–¹å¼2</span></span><br><span class="line">            MongoCollection&lt;Document&gt; collection = db.getCollection(<span class="string">"base_info"</span>);</span><br><span class="line">            <span class="comment">// collection.insertOne(new Document("name", "lxl"));</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ é™¤é›†åˆ</span></span><br><span class="line">            <span class="comment">// collection.drop();</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ–°å¢æ•°æ®</span></span><br><span class="line">            <span class="comment">// å•æ¡æ–°å¢</span></span><br><span class="line">            <span class="comment">/*Document document = new Document().append("name", "cc").append("age", 30).append("location", "SZ");</span></span><br><span class="line"><span class="comment">            collection.insertOne(document);</span></span><br><span class="line"><span class="comment">            // æ‰¹é‡æ–°å¢</span></span><br><span class="line"><span class="comment">            List&lt;Document&gt; documentList = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">            for (int i = 0; i &lt; 1000; i++) &#123;</span></span><br><span class="line"><span class="comment">                Document doc = new Document().append("name", "cc" + i).append("age", new Random().nextInt(100))</span></span><br><span class="line"><span class="comment">                        .append("location", "SZ");</span></span><br><span class="line"><span class="comment">                documentList.add(doc);</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">            collection.insertMany(documentList);*/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ é™¤æ•°æ®</span></span><br><span class="line">            <span class="comment">// åˆ é™¤ç¬¬ä¸€æ¡åŒ¹é…æ•°æ®</span></span><br><span class="line">            <span class="comment">/*Bson condition = Filters.eq("age", 99);</span></span><br><span class="line"><span class="comment">            collection.deleteOne(condition);</span></span><br><span class="line"><span class="comment">            // åˆ é™¤æ‰€æœ‰åŒ¹é…æ•°æ®</span></span><br><span class="line"><span class="comment">            collection.deleteMany(condition);*/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä¿®æ”¹æ•°æ®</span></span><br><span class="line">            <span class="comment">// ä¿®æ”¹ç¬¬ä¸€æ¡åŒ¹é…æ•°æ®</span></span><br><span class="line">            <span class="comment">/*Bson condition = Filters.eq("age", 15);</span></span><br><span class="line"><span class="comment">            Document document = new Document("$set", new Document("location", "XZ"));</span></span><br><span class="line"><span class="comment">            collection.updateOne(condition, document);</span></span><br><span class="line"><span class="comment">            collection.updateMany(condition, document);*/</span></span><br><span class="line">            <span class="comment">// å¹´é¾„+1</span></span><br><span class="line">            <span class="comment">/*Bson condition = Filters.eq("location", "XZ");</span></span><br><span class="line"><span class="comment">            Document document = new Document("$inc", new Document("age", 1));</span></span><br><span class="line"><span class="comment">            collection.updateOne(condition, document);*/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// æŸ¥è¯¢è¿”å›ç¬¬ä¸€æ¡åŒ¹é…æ•°æ®</span></span><br><span class="line">            Bson condition = Filters.lt(<span class="string">"age"</span>, <span class="number">2</span>);</span><br><span class="line">            FindIterable&lt;Document&gt; vals = collection.find(condition).sort(Sorts.descending(<span class="string">"age"</span>)).limit(<span class="number">7</span>).skip(<span class="number">7</span>);</span><br><span class="line">            <span class="comment">// Document document = vals.first();</span></span><br><span class="line">            <span class="comment">// System.out.println(document.toJson());</span></span><br><span class="line">            <span class="keyword">for</span> (Document val : vals) &#123;</span><br><span class="line">                System.out.println(val.toJson());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;å‰é¢å·²ç»æŒæ¡äº†mongoæœ€åŸºæœ¬çš„ä¸€äº›å‘½ä»¤ï¼Œå¯¹å„ä¸ªå‘½ä»¤ä¹Ÿéƒ½å®æ“è¿‡ï¼Œç†è§£å„å‘½ä»¤çš„æ„æ€ï¼Œä¹Ÿå¯¹mongoæœ‰äº†æœ€åŸºæœ¬çš„ç†è§£ï¼Œä½†å¤§éƒ¨åˆ†çŒ¿è¿˜æ˜¯æƒ³ä½¿ç”¨Javaå»è¿æ¥mongoï¼Œä¸²ä¸²ä¹Ÿä¸ä¾‹å¤–&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åœ¨pom.x
      
    
    </summary>
    
    
      <category term="MongoDB" scheme="http://luxiaowan.github.io/categories/MongoDB/"/>
    
    
      <category term="Javaä¸MongoDB" scheme="http://luxiaowan.github.io/tags/Java%E4%B8%8EMongoDB/"/>
    
  </entry>
  
  <entry>
    <title>MongoDBç›‘æ§ã€åˆ†ç‰‡åŠå¤‡ä»½æ¢å¤</title>
    <link href="http://luxiaowan.github.io/2019/10/24/MongoDB%E7%9B%91%E6%8E%A7%E3%80%81%E5%88%86%E7%89%87%E5%8F%8A%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/"/>
    <id>http://luxiaowan.github.io/2019/10/24/MongoDBç›‘æ§ã€åˆ†ç‰‡åŠå¤‡ä»½æ¢å¤/</id>
    <published>2019-10-23T16:00:00.000Z</published>
    <updated>2019-10-24T13:20:12.764Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="MongoDB" scheme="http://luxiaowan.github.io/categories/MongoDB/"/>
    
    
      <category term="ç›‘æ§" scheme="http://luxiaowan.github.io/tags/%E7%9B%91%E6%8E%A7/"/>
    
  </entry>
  
  <entry>
    <title>MongoDBè¿æ¥æŠ¥é”™java.lang.NoSuchFieldError ACKNOWLEDGED</title>
    <link href="http://luxiaowan.github.io/2019/10/23/MongoDB%E8%BF%9E%E6%8E%A5%E6%8A%A5%E9%94%99java.lang.NoSuchFieldError-ACKNOWLEDGED/"/>
    <id>http://luxiaowan.github.io/2019/10/23/MongoDBè¿æ¥æŠ¥é”™java.lang.NoSuchFieldError-ACKNOWLEDGED/</id>
    <published>2019-10-22T16:00:00.000Z</published>
    <updated>2019-10-24T13:20:12.764Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>BUGæè¿°</p></blockquote><p>ä½¿ç”¨SpringBootæ•´åˆMongoDBæ—¶ï¼Œæ­£è¦è¿è¡Œä»£ç è¿æ¥mongoï¼Œå°±èµ¤çº¢èµ¤çº¢çš„æŠ¥äº†ä¸ªé”™ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java<span class="selector-class">.lang</span><span class="selector-class">.NoSuchFieldError</span>: ACKNOWLEDGED</span><br><span class="line">at com<span class="selector-class">.mongodb</span><span class="selector-class">.MongoClientOptions</span><span class="variable">$Builder</span>.&lt;init&gt;(MongoClientOptions<span class="selector-class">.java</span>:<span class="number">960</span>)</span><br><span class="line">at com<span class="selector-class">.mongodb</span><span class="selector-class">.MongoClient</span>.&lt;init&gt;(MongoClient<span class="selector-class">.java</span>:<span class="number">155</span>)</span><br><span class="line">at com<span class="selector-class">.mongodb</span><span class="selector-class">.MongoClient</span>.&lt;init&gt;(MongoClient<span class="selector-class">.java</span>:<span class="number">145</span>)</span><br><span class="line">at com<span class="selector-class">.example</span><span class="selector-class">.demo</span><span class="selector-class">.mongo</span><span class="selector-class">.MongoConnectTest</span><span class="selector-class">.main</span>(MongoConnectTest<span class="selector-class">.java</span>:<span class="number">15</span>)</span><br></pre></td></tr></table></figure><p>è¿™ä¸€ä¸‹å°±å‚»çœ¼äº†ï¼Œå¯¹äºåˆšæ¥è§¦mongoçš„äººæ¥è¯´ï¼Œæ˜¯å¾ˆæ‡µåœˆçš„ï¼Œå¤§è„‘çŸ¥è¯†åº“ä¸­æ²¡æœ‰è¿™ä¸ªå¼‚å¸¸ä¿¡æ¯çš„è§£å†³åŠæ³•ï¼Œåªèƒ½è°·æ­Œäº†ï¼Œæ²¡æƒ³åˆ°æœ‰é‚£ä¹ˆå¤šäººé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜</p><hr><blockquote><p>BUGè§£å†³</p></blockquote><p>åœ¨Stack Overflowä¸Šæ‰¾åˆ°ä¸€ä¸ªå¸–å­ï¼š</p><blockquote><p><a href="https://stackoverflow.com/questions/13593614/mongodb-java-lang-nosuchfielderror" target="_blank" rel="noopener">https://stackoverflow.com/questions/13593614/mongodb-java-lang-nosuchfielderror</a></p></blockquote><p>å…¶ä¸­jyeminçš„å›ç­”å¯ä»¥è¯´æ˜¯ç›´å‡»è¦å®³äº†ï¼Œé¡ºåˆ©çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æŠŠæˆªå›¾è´´ä¸Šï¼Œä»¥é˜²å¸–å­è¢«åˆ </p><blockquote><blockquote><p><img src="/images/image-20191023182806521.png" alt="image-20191023182806521"></p></blockquote></blockquote><p><strong>å…¶å®å°±æ˜¯åœ¨å·¥ç¨‹ä¸­å¼•å…¥äº†å¤šä¸ªç‰ˆæœ¬ä¸åŒçš„mongo-java-driverï¼Œæ‰€ä»¥å¯¼è‡´ç¨‹åºæ··ä¹±ï¼Œåªè¦ä¿ç•™è‡ªå·±çœŸæ­£ä½¿ç”¨çš„é‚£ä¸ªç‰ˆæœ¬ï¼Œå…¶ä»–çš„éƒ½åˆ é™¤å³å¯</strong></p><blockquote><p>æˆ‘çš„é…ç½®ï¼š</p><blockquote><p><img src="/images/image-20191023183034949.png" alt="image-20191023183034949"></p></blockquote><p>å°†2.7.1ç‰ˆæœ¬çš„ä¾èµ–åˆ é™¤å°±å¯ä»¥æ­£å¸¸è¿è¡Œäº†</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;BUGæè¿°&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½¿ç”¨SpringBootæ•´åˆMongoDBæ—¶ï¼Œæ­£è¦è¿è¡Œä»£ç è¿æ¥mongoï¼Œå°±èµ¤çº¢èµ¤çº¢çš„æŠ¥äº†ä¸ªé”™ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;
      
    
    </summary>
    
    
      <category term="MongoDB" scheme="http://luxiaowan.github.io/categories/MongoDB/"/>
    
    
      <category term="MongoDBé”™è¯¯è®°å½•" scheme="http://luxiaowan.github.io/tags/MongoDB%E9%94%99%E8%AF%AF%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>MongoDBåŸºç¡€åº”ç”¨</title>
    <link href="http://luxiaowan.github.io/2019/10/23/MongoDB%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8/"/>
    <id>http://luxiaowan.github.io/2019/10/23/MongoDBåŸºç¡€åº”ç”¨/</id>
    <published>2019-10-22T16:00:00.000Z</published>
    <updated>2019-10-24T13:20:12.764Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç´¢å¼•"><a class="markdownIt-Anchor" href="#ç´¢å¼•"></a> ç´¢å¼•</h3><blockquote><p>è¯´æ˜ï¼šç´¢å¼•æ˜¯ä¸ºäº†åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ï¼Œå¯ä»¥å¯¹é›†åˆä¸­çš„ä¸€åˆ—æˆ–å¤šåˆ—è®¾ç½®ç´¢å¼•ã€‚</p><p>â€“ æ— ç´¢å¼•ï¼šæ‰«ææ•´ä¸ªé›†åˆçš„æ–‡æ¡£ï¼ŒæŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£</p><p>â€“ æœ‰ç´¢å¼•ï¼šæŸ¥æ‰¾ç´¢å¼•ï¼Œæ ¹æ®ç´¢å¼•å–å‡ºæ–‡æ¡£æ•°æ®</p></blockquote><ol><li><p>åˆ›å»ºç´¢å¼•</p><p><code>db.&lt;collection_name&gt;.createIndex(keys, option)</code></p><blockquote><p>æ —å­ï¼š</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. å•ç´¢å¼•</span><br><span class="line"><span class="selector-tag">db</span><span class="selector-class">.user</span><span class="selector-class">.createIndex</span>(&#123;<span class="attribute">age</span>:-<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">---</span></span><br><span class="line"><span class="selector-tag">age</span>:ç´¢å¼•åˆ—å</span><br><span class="line"><span class="selector-tag">-1</span>:å€’åºç´¢å¼•</span><br><span class="line">1:æ­£åºç´¢å¼•</span><br><span class="line"></span><br><span class="line">2. å¤šç´¢å¼•(å¤åˆç´¢å¼•)</span><br><span class="line"><span class="selector-tag">db</span><span class="selector-class">.user</span><span class="selector-class">.createIndex</span>(&#123;<span class="attribute">age</span>:<span class="number">1</span>, gender:-<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><ul><li>å¯é€‰å‚æ•°</li></ul><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>background</td><td>Boolean</td><td>æŒ‡å®šåˆ›å»ºç´¢å¼•æ—¶æ˜¯å¦é˜»å¡é›†åˆçš„å…¶ä»–æ“ä½œã€‚true:åå°æ‰§è¡Œï¼Œä¸é˜»å¡ï¼›false:é˜»å¡ï¼Œé»˜è®¤</td></tr><tr><td>unique</td><td>Boolean</td><td>æŒ‡å®šç´¢å¼•æ˜¯å¦ä¸ºå”¯ä¸€ç´¢å¼•ã€‚true:å”¯ä¸€ç´¢å¼•ï¼›false:ä¸å”¯ä¸€ï¼Œé»˜è®¤</td></tr><tr><td>name</td><td>String</td><td>ç´¢å¼•åç§°ï¼Œé»˜è®¤ä¸ºå­—æ®µå+ç´¢å¼•é¡ºåº</td></tr><tr><td>v</td><td>index<br>version</td><td>ç´¢å¼•ç‰ˆæœ¬å·ï¼Œé»˜è®¤ä¸ºå½“å‰mongoçš„ç‰ˆæœ¬å·</td></tr><tr><td>weights</td><td>Integer</td><td>1~99999ä¹‹é—´ï¼Œå€¼è¶Šå¤§æƒé‡è¶Šå¤§</td></tr><tr><td>expireAfterSeconds</td><td>Integer</td><td>æŒ‡å®šé›†åˆç”Ÿå­˜æ—¶é—´ã€‚ç§’çº§ï¼ŒTTL</td></tr><tr><td>sparse</td><td>Boolean</td><td>æŒ‡å®šæ˜¯å¦å¿½ç•¥ä¸å­˜åœ¨çš„å­—æ®µã€‚true:ä¸æŸ¥å‡ºä¸åŒ…å«æŸ¥è¯¢å­—æ®µçš„æ–‡æ¡£ï¼›false:æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£ï¼Œé»˜è®¤</td></tr></tbody></table><blockquote><p>æ —å­ï¼š</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.user.create<span class="constructor">Index(&#123;<span class="params">name</span>:1&#125;, &#123;<span class="params">background</span>: <span class="params">true</span>, <span class="params">unique</span>: <span class="params">true</span>, <span class="params">name</span>: <span class="string">"idx_user_name"</span>, <span class="params">v</span>: 1, <span class="params">weights</span>: 99, <span class="params">sparse</span>: <span class="params">true</span>&#125;)</span></span><br><span class="line">&gt; </span><br><span class="line">&gt; ---</span><br><span class="line">&gt; åå°ä¸é˜»å¡é›†åˆçš„æ–¹å¼åˆ›å»ºä¸€ä¸ªnameåˆ—æ­£åº,ç‰ˆæœ¬å·ä¸º<span class="number">1</span>,æƒé‡<span class="number">99</span>,å¿½ç•¥æ— nameå­—æ®µçš„æ–‡æ¡£çš„å”¯ä¸€ç´¢å¼•idx_user_name</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote></li><li><p>æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•</p><p><code>db.&lt;collection_name&gt;.getIndexes()</code></p><blockquote><p>æ —å­ï¼š</p><p><code>db.user.getIndexes()</code></p></blockquote></li><li><p>é‡å»ºç´¢å¼•</p><ul><li><p>æ–¹æ³•1ï¼š<code>db.&lt;collection_name&gt;.reIndex()</code></p></li><li><p>æ–¹æ³•2ï¼šå…ˆåˆ é™¤åŸç´¢å¼•ï¼Œç„¶åå†åˆ›å»º</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="tag">&lt;<span class="name">collection_name</span>&gt;</span>.dropIndex(<span class="tag">&lt;<span class="name">idx_name</span>&gt;</span>)</span><br><span class="line">db.<span class="tag">&lt;<span class="name">collection_name</span>&gt;</span>.createIndex(...)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>åˆ é™¤ç´¢å¼•</p><ul><li><p>åˆ é™¤æŒ‡å®šåç§°çš„ç´¢å¼•ï¼š</p><p><code>db.user.dropIndex(&lt;idx_name&gt;)</code></p></li><li><p>åˆ é™¤é›†åˆä¸­æ‰€æœ‰ç´¢å¼•</p><p><code>db.user.dropIndexes()</code></p><blockquote><p>è¯´æ˜ï¼šåªä¼šåˆ é™¤è‡ªå»ºçš„ç´¢å¼•ï¼Œé›†åˆä¸­_idåˆ—çš„ç´¢å¼•ä¸ä¼šè¢«åˆ é™¤</p></blockquote></li></ul></li></ol><hr><h3 id="èšåˆæŸ¥è¯¢"><a class="markdownIt-Anchor" href="#èšåˆæŸ¥è¯¢"></a> èšåˆæŸ¥è¯¢</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">åˆ›å»ºé›†åˆå¹¶æ’å…¥æ•°æ®ï¼š</span><br><span class="line"><span class="selector-tag">db</span><span class="selector-class">.agg</span><span class="selector-class">.save</span>([&#123;</span><br><span class="line">   <span class="attribute">title</span>: <span class="string">'MongoDB Overview'</span>, </span><br><span class="line">   <span class="attribute">description</span>: <span class="string">'MongoDB is no sql database'</span>,</span><br><span class="line">   <span class="attribute">by_user</span>: <span class="string">'runoob.com'</span>,</span><br><span class="line">   <span class="attribute">url</span>: <span class="string">'http://www.runoob.com'</span>,</span><br><span class="line">   <span class="attribute">tags</span>: [<span class="string">'mongodb'</span>, <span class="string">'database'</span>, <span class="string">'NoSQL'</span>],</span><br><span class="line">   <span class="attribute">likes</span>: <span class="number">100</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">   <span class="attribute">title</span>: <span class="string">'NoSQL Overview'</span>, </span><br><span class="line">   <span class="attribute">description</span>: <span class="string">'No sql database is very fast'</span>,</span><br><span class="line">   <span class="attribute">by_user</span>: <span class="string">'runoob.com'</span>,</span><br><span class="line">   <span class="attribute">url</span>: <span class="string">'http://www.runoob.com'</span>,</span><br><span class="line">   <span class="attribute">tags</span>: [<span class="string">'mongodb'</span>, <span class="string">'database'</span>, <span class="string">'NoSQL'</span>],</span><br><span class="line">   <span class="attribute">likes</span>: <span class="number">10</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">   <span class="attribute">title</span>: <span class="string">'Neo4j Overview'</span>, </span><br><span class="line">   <span class="attribute">description</span>: <span class="string">'Neo4j is no sql database'</span>,</span><br><span class="line">   <span class="attribute">by_user</span>: <span class="string">'Neo4j'</span>,</span><br><span class="line">   <span class="attribute">url</span>: <span class="string">'http://www.neo4j.com'</span>,</span><br><span class="line">   <span class="attribute">tags</span>: [<span class="string">'neo4j'</span>, <span class="string">'database'</span>, <span class="string">'NoSQL'</span>],</span><br><span class="line">   <span class="attribute">likes</span>: <span class="number">750</span></span><br><span class="line">&#125;])</span><br></pre></td></tr></table></figure><blockquote><p>æ ¼å¼ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.&lt;collection_name&gt;.aggregate(condition)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ---</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> condition:</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> [&#123;<span class="variable">$group</span>:&#123;_id:<span class="string">"$&lt;key&gt;"</span>, num_tutorial:&#123;$&lt;fun_expression&gt;:<span class="string">"$&lt;key&gt;"</span>&#125;&#125;&#125;]</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="variable">$group</span>:ä¸€ä¸ªç»„</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> _id:ç»„åˆåˆ—ï¼Œç±»åŒäºMySQLçš„group byåé¢çš„å­—æ®µï¼Œé»˜è®¤_idçš„åˆ—ä¼šåœ¨æŸ¥è¯¢ç»“æœä¸­æ˜¾ç¤º</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> num_tutorial:è¾“å‡ºçš„åˆ—å</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> $&lt;fun_expression&gt;:èšåˆè¡¨è¾¾å¼</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> $&lt;key&gt;:è¿ç®—çš„åˆ—å</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p>å…³é”®å­—ï¼šaggregate</p><p>è¯´æ˜ï¼šèšåˆæŸ¥è¯¢å°±æ˜¯æ±‚å’Œã€æœ€å¤§ã€æœ€å°ã€æœ€å‰ã€æœ€åã€å¹³å‡æ•°çš„ç»Ÿç§°ï¼Œç±»ä¼¼äºMySQLçš„count()ã€sum()ã€avg()</p></blockquote><blockquote><p>æ —å­ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.user.aggregate([&#123;<span class="variable">$group</span>: <span class="variable">$&#123;_id:"$gender", num_tutorial:&#123;$sum:1&#125;</span>&#125;&#125;])</span><br><span class="line">&gt; </span><br><span class="line">&gt; ---</span><br><span class="line">&gt; ç­‰åŒäºMySQLï¼šselect gender, count(1) <span class="keyword">from</span><span class="built_in"> user group </span>by gender</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><ol><li>èšåˆè¡¨è¾¾å¼</li></ol><table><thead><tr><th>è¡¨è¾¾å¼</th><th>æè¿°</th><th>æ¡ˆä¾‹</th></tr></thead><tbody><tr><td>$sum</td><td>è®¡ç®—æ€»å’Œ</td><td><code>db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$sum:&quot;$likes&quot;}}}])</code><br>â€”<br>ç­‰åŒäºMySQLï¼š<code>select by_user, sum(likes) from agg group by by_user</code></td></tr><tr><td>$avg</td><td>è®¡ç®—å¹³å‡å€¼</td><td><code>db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$avg:&quot;$likes&quot;}}}])</code><br>â€”<br>ç­‰åŒäºMySQLï¼š<code>select by_user, avg(likes) from agg group by by_user</code></td></tr><tr><td>$min</td><td>è·å–é›†åˆä¸­æŒ‡å®šåˆ—çš„æœ€å°å€¼è®°å½•</td><td><code>db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$min:&quot;$like&quot;}}}])</code><br>â€”<br>ç­‰åŒäºMySQLï¼š<code>select by_user, min(likes) from agg group by by_user</code></td></tr><tr><td>$max</td><td>è·å–é›†åˆä¸­æŒ‡å®šåˆ—çš„æœ€å¤§å€¼è®°å½•</td><td><code>db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$max:&quot;$likes&quot;}}}])</code><br>â€”<br>ç­‰åŒäºMySQLï¼š<code>select by_user, max(likes) from agg group by by_user</code></td></tr><tr><td>$push</td><td>åœ¨ç»“æœæ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°æ•°ç»„</td><td><code>db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$push:&quot;$url&quot;}}}])</code><br>â€”<br>ç­‰åŒäºMySQLï¼šæŸ¥å‡ºæ‰€æœ‰æ•°æ®ï¼Œç„¶åå–å­—æ®µurlå†™å…¥åŒä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œurlä¸å»é‡ï¼Œç„¶åè¾“å‡º</td></tr><tr><td>$addToSet</td><td>åœ¨ç»“æœæ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä½†ä¸åˆ›å»ºå‰¯æœ¬</td><td><code>db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$addToSet:&quot;$url&quot;}}}])</code><br>â€”<br>ç­‰åŒäºMySQLï¼šæŸ¥å‡ºæ‰€æœ‰æ•°æ®ï¼Œç„¶åå–å­—æ®µurlå†™å…¥åŒä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œurlå»é‡ï¼Œç„¶åè¾“å‡º</td></tr><tr><td>$first</td><td>æ ¹æ®èµ„æºæ–‡æ¡£çš„æ’åºè·å–ç¬¬ä¸€ä¸ªæ–‡æ¡£æ•°æ®</td><td><code>db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$first:&quot;$title&quot;}}}])</code></td></tr><tr><td>$last</td><td>æ ¹æ®èµ„æºæ–‡æ¡£çš„æ’åºè·å–æœ€åä¸€ä¸ªæ–‡æ¡£æ•°æ®</td><td><code>db.agg.aggregate([{$group:{_id:&quot;$by_user&quot;, num_tutorial:{$last:&quot;$title&quot;}}}])</code></td></tr></tbody></table><hr><h3 id="ç®¡é“å‡½æ•°"><a class="markdownIt-Anchor" href="#ç®¡é“å‡½æ•°"></a> ç®¡é“å‡½æ•°</h3><blockquote><p>è¯´æ˜ï¼šç®¡é“å‡½æ•°ç±»ä¼¼äºLinuxç³»ç»Ÿä¸­çš„ç®¡é“æ“ä½œï¼Œå°†ä¸Šä¸€æ­¥çš„è¿ç®—ç»“æœä½œä¸ºä¸‹ä¸€æ­¥çš„è¾“å…¥å€¼ï¼Œæœ€ç»ˆè¾¾åˆ°ç†æƒ³è®¡ç®—ç»“æœçš„è¿ç®—æ–¹å¼</p></blockquote><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>$project</td><td>æŒ‡å®šéœ€è¦è¾“å‡ºçš„åˆ—ï¼Œé»˜è®¤æ˜¾ç¤º_idï¼Œæ ¼å¼ï¼š{$project:{by_user:1, title:1, url:1, _id:0<code>ä¸æ˜¾ç¤ºid</code>}},</td></tr><tr><td>$limit</td><td>é™åˆ¶æŸ¥è¯¢è¿”å›çš„æ–‡æ¡£æ•°ï¼Œæ ¼å¼ï¼š{$limit: 1},åªè¿”å›ä¸€ä¸ªæ–‡æ¡£</td></tr><tr><td>$skip</td><td>è·³è¿‡æŒ‡å®šæ•°é‡çš„æ–‡æ¡£ï¼Œè¿”å›ä¹‹åçš„æ‰€æœ‰æ–‡æ¡£ï¼Œæ ¼å¼ï¼š{$skip: 1},ä»ç¬¬äºŒä¸ªæ–‡æ¡£å¼€å§‹è¾“å‡º</td></tr><tr><td>$match</td><td>æ¡ä»¶ç­›é€‰ï¼Œæ ¼å¼ï¼š{<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;EOF&#039; at end of input: â€¦atch: {likes: {">match: {likes: {</span>gte: 10}}}</td></tr><tr><td>$group</td><td>èšåˆæ¡ä»¶ï¼Œæ ¼å¼ï¼š{<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;EOF&#039; at end of input: group: {_id: &quot;">group: {_id: &quot;</span>by_user&quot;, count: {$sum: -1}}}</td></tr><tr><td>$sort</td><td>æ’åºï¼Œæ ¼å¼ï¼š{$sort: {likes: -1}}ï¼Œ-1:å€’åº; 1:æ­£åº</td></tr><tr><td>$unwind</td><td>å°†æ–‡æ¡£ä¸­çš„æŸä¸€ä¸ªæ•°ç»„ç±»å‹å­—æ®µæ‹†åˆ†æˆå¤šæ¡ï¼Œæ¯æ¡åŒ…å«æ•°ç»„ä¸­çš„ä¸€ä¸ªå€¼</td></tr><tr><td>$geoNear</td><td>è¾“å‡ºæ¥è¿‘æŸä¸€åœ°ç†ä½ç½®çš„æœ‰åºæ–‡æ¡£ã€‚</td></tr></tbody></table><blockquote><p>æ —å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.agg.aggregate(&#123;<span class="variable">$match</span>: &#123;likes: &#123;<span class="variable">$gte</span>: 10&#125;&#125;&#125;, &#123; <span class="variable">$project</span>: &#123;_id: 0, title: 1, by_user: 1, likes: 1&#125;&#125;, &#123;<span class="variable">$limit</span>: 5&#125;, &#123;<span class="variable">$skip</span>: 1&#125;, &#123;<span class="variable">$sort</span>: &#123;likes: -1&#125;&#125;)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> </span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ---</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ç­‰åŒäºMySQL: </span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> select title, by_user, likes from agg <span class="built_in">where</span> likes &gt;= 10 order by likes desc <span class="built_in">limit</span> 1,5</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ç´¢å¼•&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ç´¢å¼•&quot;&gt;&lt;/a&gt; ç´¢å¼•&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯´æ˜ï¼šç´¢å¼•æ˜¯ä¸ºäº†åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ï¼Œå¯ä»¥å¯¹é›†åˆä¸­çš„ä¸€åˆ—æˆ–å¤šåˆ—è®¾ç½®ç´¢å¼•ã€‚&lt;/p&gt;
&lt;p&gt;â€“ æ— ç´¢å¼•ï¼šæ‰«ææ•´ä¸ªé›†åˆçš„æ–‡æ¡£ï¼ŒæŸ¥æ‰¾ç¬¦
      
    
    </summary>
    
    
      <category term="MongoDB" scheme="http://luxiaowan.github.io/categories/MongoDB/"/>
    
    
      <category term="åŸºç¡€åº”ç”¨" scheme="http://luxiaowan.github.io/tags/%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>MongoDBåŸºæœ¬æŒ‡ä»¤</title>
    <link href="http://luxiaowan.github.io/2019/10/23/MongoDB%E5%9F%BA%E6%9C%AC%E6%8C%87%E4%BB%A4/"/>
    <id>http://luxiaowan.github.io/2019/10/23/MongoDBåŸºæœ¬æŒ‡ä»¤/</id>
    <published>2019-10-22T16:00:00.000Z</published>
    <updated>2019-10-24T13:20:12.763Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>æŸ¥çœ‹æ‰€æœ‰çš„db</p><p><code>show dbs</code></p></li><li><p>åˆ‡æ¢db</p><p><code>user &lt;db_name&gt;</code></p></li><li><p>æŸ¥çœ‹å½“å‰æ‰€åœ¨dbåç§°</p><p><code>db</code></p></li><li><p>åˆ é™¤db**(å¿…é¡»åœ¨è¦åˆ é™¤çš„dbä¸­æ“ä½œ)**</p><p><code>db.dropDatabase()</code></p></li><li><p>æŸ¥çœ‹dbä¸‹æ‰€æœ‰çš„é›†åˆ</p><p><code>show tables</code></p><p><code>show collections</code></p></li><li><p>åˆ›å»ºé›†åˆ</p><ul><li><code>db.createCollection(&quot;abc&quot;)</code></li><li><code>db.createCollection(&quot;def&quot;, {capped: true, autoIndexId: true, size: 1024, max: 100})</code></li><li>å¾€ä¸€å¼ ä¸å­˜åœ¨çš„é›†åˆä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºé›†åˆ<ul><li><code>db.test.insert({title: 123})</code></li></ul></li></ul></li><li><p>åˆ é™¤é›†åˆ</p><p><code>db.&lt;collection_name&gt;.drop()</code></p><p>ä¾‹ï¼š<code>db.abc.drop()</code></p></li><li><p>æ’å…¥æ–‡æ¡£</p><ul><li><p><code>db.&lt;collection_name&gt;.insert({title: 1234})</code></p></li><li><p><code>doc=({title: 12345, name: &quot;MongoDBæŒ‡å—&quot;})</code></p><p><code>db.&lt;collection_name&gt;.insert(doc)</code></p></li><li><p><code>db.&lt;collection_name&gt;.save({name: &quot;MongoDBç®€å•æŒ‡ä»¤&quot;}})</code></p></li><li><p><code>doc2=({name: &quot;MongoDBä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;})</code></p><p><code>db.&lt;collection_name&gt;.save(doc2)</code></p></li><li><p><code>doc3=({_id: &quot;edrftgyhjkgjhfgv2ryuoio&quot;, name: &quot;MongoDBä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;})</code></p><p><code>db.&lt;collection_name&gt;.save(doc3)</code>// è‹¥_idå¯¹åº”å€¼çš„æ•°æ®å·²ç»å­˜åœ¨ï¼Œåˆ™æ›´æ–°è¿™æ¡æ•°æ®ï¼Œå¦åˆ™æ–°å¢ä¸€æ¡æ•°æ®</p></li></ul></li><li><p>æ›´æ–°æ–‡æ¡£</p><ul><li><code>db.&lt;collection_name&gt;.update({title: 1234}, {$set:{title: &quot;4321&quot;}})</code></li></ul><blockquote><p>æ ¼å¼ï¼š</p></blockquote><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">db.&lt;collection_name&gt;.update(</span><br><span class="line">&lt;where&gt;,<span class="regexp">//</span> ç›¸å½“äºMySQLçš„where</span><br><span class="line">&lt;update&gt;,<span class="regexp">//</span> ç›¸å½“äºMySQLçš„updateè¯­å¥çš„setï¼Œéœ€è¦è·Ÿä¸€äº›æŒ‡ä»¤ï¼š<span class="variable">$,</span><span class="variable">$inc</span>,<span class="variable">$set</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="symbol">upsert:</span> <span class="keyword">true</span>,<span class="regexp">//</span> <span class="keyword">true</span>ï¼šå¦‚æœä¸å­˜åœ¨è®°å½•ï¼Œåˆ™æ–°å¢ï¼›<span class="keyword">false</span>ç›¸åï¼Œé»˜è®¤</span><br><span class="line"><span class="symbol">multi:</span> <span class="keyword">true</span>,<span class="regexp">//</span> <span class="keyword">true</span>ï¼šåªæ›´æ–°ç¬¬ä¸€æ¡åŒ¹é…çš„è®°å½•ï¼›<span class="keyword">false</span>ç›¸åï¼Œå…¨éƒ¨æ›´æ–°ï¼Œ é»˜è®¤</span><br><span class="line"><span class="symbol">writeConcern:</span> &lt;document&gt;<span class="regexp">//</span> å¼‚å¸¸çº§åˆ«</span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>æ¡ˆä¾‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> 1. åªæ›´æ–°ç¬¬ä¸€æ¡è®°å½•ï¼š</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.update( &#123; <span class="string">"count"</span> : &#123; <span class="variable">$gt</span> : 1 &#125; &#125; , &#123; <span class="variable">$set</span> : &#123; <span class="string">"test2"</span> : <span class="string">"OK"</span>&#125; &#125; );</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 2. å…¨éƒ¨æ›´æ–°ï¼š</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.update( &#123; <span class="string">"count"</span> : &#123; <span class="variable">$gt</span> : 3 &#125; &#125; , &#123; <span class="variable">$set</span> : &#123; <span class="string">"test2"</span> : <span class="string">"OK"</span>&#125; &#125;,<span class="literal">false</span>,<span class="literal">true</span> );</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 3. åªæ·»åŠ ç¬¬ä¸€æ¡ï¼š</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.update( &#123; <span class="string">"count"</span> : &#123; <span class="variable">$gt</span> : 4 &#125; &#125; , &#123; <span class="variable">$set</span> : &#123; <span class="string">"test5"</span> : <span class="string">"OK"</span>&#125; &#125;,<span class="literal">true</span>,<span class="literal">false</span> );</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 4. å…¨éƒ¨æ·»åŠ è¿›å»:</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.update( &#123; <span class="string">"count"</span> : &#123; <span class="variable">$gt</span> : 5 &#125; &#125; , &#123; <span class="variable">$set</span> : &#123; <span class="string">"test5"</span> : <span class="string">"OK"</span>&#125; &#125;,<span class="literal">true</span>,<span class="literal">true</span> );</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 5. å…¨éƒ¨æ›´æ–°ï¼š</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.update( &#123; <span class="string">"count"</span> : &#123; <span class="variable">$gt</span> : 15 &#125; &#125; , &#123; <span class="variable">$inc</span> : &#123; <span class="string">"count"</span> : 1&#125; &#125;,<span class="literal">false</span>,<span class="literal">true</span> );</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 6. åªæ›´æ–°ç¬¬ä¸€æ¡è®°å½•ï¼š</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.update( &#123; <span class="string">"count"</span> : &#123; <span class="variable">$gt</span> : 10 &#125; &#125; , &#123; <span class="variable">$inc</span> : &#123; <span class="string">"count"</span> : 1&#125; &#125;,<span class="literal">false</span>,<span class="literal">false</span> );</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><ul><li><p><code>db.&lt;collection_name&gt;.save()</code></p><p>è°ƒç”¨saveæŒ‡ä»¤ä¸€èˆ¬éœ€è¦æŒ‡å®š_id</p></li></ul></li><li><p>åˆ é™¤æ–‡æ¡£</p><p><code>db.&lt;collection_name&gt;.remove({title: &quot;4321&quot;}, true)</code></p><blockquote><p>æ ¼å¼</p></blockquote><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="params">&lt;collection_name&gt;</span>.remove(</span><br><span class="line"><span class="params">&lt;where&gt;</span>,<span class="comment">// ç›¸å½“äºMySQLçš„where</span></span><br><span class="line"><span class="params">&lt;justOne&gt;</span><span class="comment">// trueï¼šåªåˆ é™¤ä¸€æ¡åŒ¹é…æ¡ä»¶çš„æ•°æ®ï¼›falseï¼šåŒ¹é…æ¡ä»¶çš„æ•°æ®å…¨éƒ¨åˆ é™¤ï¼Œé»˜è®¤</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li><p>åˆ é™¤é›†åˆä¸­æ‰€æœ‰æ•°æ®</p><p><code>db.&lt;collection_name&gt;.remove({})</code></p></li><li><p>æ–°å‡½æ•°ï¼š</p><ul><li><code>db.&lt;collection_name&gt;.deleteMany({})</code></li><li><code>db.&lt;collection_name&gt;.deleteOne({title: &quot;12345&quot;})</code></li></ul></li></ul></li><li><p>æŸ¥è¯¢æ–‡æ¡£</p><ol><li>æ™®é€šæŸ¥è¯¢</li></ol><blockquote><p>æ ¼å¼ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.&lt;collection_name&gt;.find(</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &lt;<span class="built_in">where</span>&gt;, // æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &lt;colName&gt;// è¿”å›å­—æ®µåç§°</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> )</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><ul><li>åˆ›å»ºä¸€ä¸ªé›†åˆï¼Œæ’å…¥ä¸‰æ¡æ•°æ®</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.user.insert([&#123;<span class="string">name:</span> <span class="string">"cc"</span>, <span class="string">age:</span> <span class="string">"29"</span>, <span class="string">gender:</span> <span class="number">1</span>&#125;, &#123;<span class="string">name:</span> <span class="string">"ccc"</span>, <span class="string">age:</span> <span class="string">"30"</span>, <span class="string">gender:</span> <span class="number">2</span>&#125;, &#123;<span class="string">name:</span> <span class="string">"c"</span>, <span class="string">age:</span> <span class="string">"28"</span>, <span class="string">gender:</span> <span class="number">1</span>&#125;])</span><br></pre></td></tr></table></figure><ul><li><p>æŸ¥è¯¢é›†åˆä¸­å…¨éƒ¨æ•°æ®</p><p>æ™®é€šæ˜¾ç¤ºï¼š<code>db.user.find()</code></p><p>æ ¼å¼åŒ–æ˜¾ç¤ºï¼š<code>db.user.find().pretty()</code></p></li><li><p>æŸ¥è¯¢name=&quot;c&quot;çš„ä¿¡æ¯</p><p><code>db.user.find({name: &quot;c&quot;}).pretty()</code></p></li><li><p>æŸ¥è¯¢åªè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„æ•°æ®</p><p><code>db.user.findOne({name: &quot;c&quot;})</code></p></li></ul><ol start="2"><li><p>ANDæŸ¥è¯¢</p><p><code>db.user.find({key: value, key: value})</code></p><p>AndæŸ¥è¯¢å³æ˜¯åœ¨whereæ¡ä»¶é‡Œé¢ç”¨é€—å·&quot;,&quot;åˆ†éš”</p><blockquote><p>æ —å­ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.user.<span class="builtin-name">find</span>(&#123;name:<span class="string">"cc"</span>, gender:1&#125;)</span><br><span class="line">&gt; </span><br><span class="line">&gt; ---</span><br><span class="line">&gt; ç­‰åŒäºMySQLï¼š</span><br><span class="line">&gt; select * <span class="keyword">from</span><span class="built_in"> user </span>where name = <span class="string">"c"</span> <span class="keyword">AND</span> gender = 1</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote></li><li><p>ORæŸ¥è¯¢</p><p><code>db.user.find({$or:[{key:value}, {key:value}]})</code></p><blockquote><p>æ —å­ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.user.<span class="builtin-name">find</span>(&#123;</span><br><span class="line">&gt; <span class="variable">$or</span>:[&#123;name:<span class="string">"c"</span>&#125;, &#123;gender:2&#125;]</span><br><span class="line">&gt; &#125;)</span><br><span class="line">&gt; </span><br><span class="line">&gt; ---</span><br><span class="line">&gt; ç­‰åŒäºMySQLï¼š</span><br><span class="line">&gt; select * <span class="keyword">from</span><span class="built_in"> user </span>where name = <span class="string">"c"</span> <span class="keyword">OR</span> gender = 2</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote></li><li><p>ANDå’ŒORç»„åˆæŸ¥è¯¢</p><p><code>db.user.find({key:value, $or:[{key:value}, {key:value}]})</code></p><blockquote><p>æ —å­ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.user.<span class="builtin-name">find</span>(&#123;gender:1, <span class="variable">$or</span>:[&#123;name: <span class="string">"c"</span>&#125;, &#123;age: <span class="string">"28"</span>&#125;]&#125;)</span><br><span class="line">&gt; </span><br><span class="line">&gt; ---</span><br><span class="line">&gt; ç­‰åŒäºMySQLï¼š</span><br><span class="line">&gt; select * <span class="keyword">from</span><span class="built_in"> user </span>where gender = 1 <span class="keyword">AND</span> (name = <span class="string">"c"</span> <span class="keyword">OR</span> age = <span class="string">"28"</span>)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote></li></ol><blockquote><p>è¿ç®—ç¬¦</p><table><thead><tr><th>è¿ç®—ç¬¦</th><th>æ ¼å¼</th><th>æ¡ˆä¾‹</th><th>MySQLå¯¹åº”è¯­å¥</th></tr></thead><tbody><tr><td>ç­‰äº</td><td>{key:value}<br>{key:{$eq:value}}</td><td>db.user.find({age:â€œ29â€})<br>db.user.find({age:{$eq:â€œ29â€}})</td><td>where age = â€œ29â€</td></tr><tr><td>å¤§äº</td><td>{key:{$gt: value}}</td><td>db.user.find({age:{$gt:â€œ30â€}})</td><td>where age &gt; â€œ30â€</td></tr><tr><td>å°äº</td><td>{key:{$lt: value}}</td><td>db.user.find({age:{$lt: â€œ30â€}})</td><td>where age &lt; â€œ30â€</td></tr><tr><td>å¤§äºç­‰äº</td><td>{key:{$gte: value}}</td><td>db.user.find({age:{$gte:â€œ30â€}})</td><td>where age &gt;= â€œ30â€</td></tr><tr><td>å°äºç­‰äº</td><td>{key:{$lte: value}}</td><td>db.user.find({age:{$lte:â€œ30â€}})</td><td>where age &lt;= â€œ30â€</td></tr><tr><td>ä¸ç­‰äº</td><td><span class="katex-error" title="ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;EOF&#039; at end of input: {key:{">{key:{</span>ne: value}}</td><td>db.user.find({age:{$ne:â€œ29â€}})</td><td>where age != â€œ30â€</td></tr></tbody></table></blockquote><ol start="5"><li><p>æ¨¡ç³ŠæŸ¥è¯¢</p><ul><li>æŸ¥è¯¢ageåŒ…å«0çš„ï¼š<code>db.user.find({age:/0/})</code></li><li>æŸ¥è¯¢ageä»¥2å¼€å¤´çš„ï¼šdb.user.find({age:/^2/})</li><li>æŸ¥è¯¢ageä»¥8ç»“æŸçš„ï¼šdb.user.find({age:/8$/})</li></ul></li><li><p>åˆ†é¡µæŸ¥è¯¢</p><blockquote><p>æ ¼å¼ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.&lt;collection_name&gt;.find().<span class="built_in">limit</span>(Number).skip(Number)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> </span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ---</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">limit</span>(Number)è¡¨ç¤ºæŸ¥è¯¢å¤šå°‘æ¡æ•°æ®</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> skip(Number)è¡¨ç¤ºä»ç¬¬å‡ æ¡å¼€å§‹æŸ¥è¯¢</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><ul><li><p>æŸ¥è¯¢ä¸€æ¡æ•°æ®</p><ul><li>ç¬¬ä¸€ç§æ–¹æ³•ï¼š<code>db.user.findOne({})</code></li><li>ç¬¬äºŒç§æ–¹æ³•ï¼š<code>db.user.find({}).limit(1)</code></li></ul></li><li><p>ä»ç¬¬äºŒæ¡æ•°æ®å¼€å§‹æŸ¥è¯¢ä¸€æ¡æ•°æ®</p><p><code>db.user.find().limit(1).skip(2)</code></p></li></ul></li><li><p>æŸ¥è¯¢æ’åº</p><blockquote><p>æ ¼å¼ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.&lt;collection_name&gt;.find().sort(&#123;&lt;key_name&gt;:-1/1&#125;)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> </span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ---</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &lt;key_name&gt;ï¼šæ’åºå­—æ®µ</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -1ï¼šå€’åº</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 1ï¼šæ­£åº</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></blockquote><ul><li><p>æŒ‰ç…§å¹´é¾„å€’åº</p><p><code>db.user.find().sort({age:-1})</code></p></li><li><p>æŒ‰ç…§å¹´é¾„å€’åºã€æ€§åˆ«æ­£åº</p><p><code>db.user.find().sort({age:-1, gender:1})</code></p></li></ul></li></ol></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥çœ‹æ‰€æœ‰çš„db&lt;/p&gt;
&lt;p&gt;&lt;code&gt;show dbs&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ‡æ¢db&lt;/p&gt;
&lt;p&gt;&lt;code&gt;user &amp;lt;db_name&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥çœ‹å½“å‰æ‰€åœ¨db
      
    
    </summary>
    
    
      <category term="MongoDB" scheme="http://luxiaowan.github.io/categories/MongoDB/"/>
    
    
      <category term="åŸºæœ¬æŒ‡ä»¤" scheme="http://luxiaowan.github.io/tags/%E5%9F%BA%E6%9C%AC%E6%8C%87%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Git Stashç”¨æ³•</title>
    <link href="http://luxiaowan.github.io/2019/10/22/git%20stash%E5%91%BD%E4%BB%A4/"/>
    <id>http://luxiaowan.github.io/2019/10/22/git stashå‘½ä»¤/</id>
    <published>2019-10-21T16:00:00.000Z</published>
    <updated>2019-10-24T13:20:12.765Z</updated>
    
    <content type="html"><![CDATA[<h3 id="åˆ›å»ºä»“åº“"><a class="markdownIt-Anchor" href="#åˆ›å»ºä»“åº“"></a> åˆ›å»ºä»“åº“</h3><ol><li>git init</li><li>echo 123 &gt; test.txt</li><li>git add .</li><li>git commit -m â€œadd test fileâ€</li><li>git remote add origin git@git.xx.xx.xx:xxx/xxx.git</li><li>git push origin master</li></ol><p><em>ä»¥ä¸Šå†…å®¹æ¯”è¾ƒç®€å•ï¼Œå°±ä¸ä½œè¯¦ç»†è®²è¿°ï¼Œå¦‚æœä¸Šé¢çš„å†…å®¹çœ‹ä¸æ‡‚ï¼Œä¸‹é¢çš„è¯·æ”¾å¼ƒ</em></p><h3 id="ä½¿ç”¨git-stashæš‚å­˜"><a class="markdownIt-Anchor" href="#ä½¿ç”¨git-stashæš‚å­˜"></a> ä½¿ç”¨git stashæš‚å­˜</h3><ol><li><p>éšæ„ä¿®æ”¹test.txtæ–‡ä»¶çš„å†…å®¹ï¼Œæ¯”å¦‚ï¼šç”»ä¸ªå¿ƒå½¢ï¼Œä½ æ­£çƒ­ç«æœå¤©ä¿®æ”¹ä¸­â€¦â€¦</p></li><li><p>è¿™æ—¶é¢†å¯¼èµ°è¿‡æ¥æ‹äº†æ‹ä½ çš„è‚©è†€è¯´åˆ°ï¼šâ€å°ä¼™å­å•Šï¼Œåˆ›å»ºä¸ª<code>æœ•.txt</code>æ–‡ä»¶æäº¤ä¸Šæ¥ï¼Œå†…å®¹å°±å†™<code>æˆ‘è¿˜æƒ³å†æ´»äº”ç™¾å¹´</code>ï¼Œtest.txtæ–‡ä»¶è¿™ä¸€ç‰ˆä¸ä½œä¿®æ”¹â€œã€‚</p></li><li><p><strong>ä½ é¢éœ²ç¬‘å®¹çš„å›ç­”ï¼šâ€œå¥½çš„ï¼Œæ²¡é—®é¢˜ï¼â€ï¼Œå†…å¿ƒå´æ˜¯ï¼šâ€œMMP,MMP,MMPâ€¦â€¦â€</strong></p></li><li><p>è¾›è¾›è‹¦è‹¦ä¿®æ”¹çš„<code>test.txt</code>æ–‡ä»¶æ€ä¹ˆåŠï¼Ÿçœ¼ç…ç€å°±è¦å®Œæˆäº†ï¼Œéš¾é“å¤åˆ¶å‡ºå»ï¼Œç„¶åç­‰è§£å†³é¢†å¯¼éœ€æ±‚åå†ç²˜è´´å›æ¥ï¼Ÿlowä¸lowï¼Ÿè‚¯å®š<code>ä¸low</code>å•Šï¼Œä¸€ä¸ªæ–‡ä»¶è€Œå·²ï¼Œè¿™ç§æ–¹æ³•å¾ˆç®€å•ï¼Œ*ä½†æ˜¯å½“ä½ å®é™…é¡¹ç›®ä¸­ä¿®æ”¹äº†å‡ åä¸ªæ–‡ä»¶çš„æ—¶å€™å‘¢ï¼Ÿ*æŒ¨ä¸ªå„¿å¤åˆ¶å‡ºå»ï¼Ÿç´¯å‚»å°å­å‘ï¼Ÿï¼ï¼ï¼ï¼ï¼</p></li><li><p><code>git stash</code>å‘½ä»¤å¸®ä½ è§£å†³é—®é¢˜ï¼Œstashæ˜¯å­˜å‚¨çš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯å°†å½“å‰å·¥ä½œåŒºå†…çš„æ‰€æœ‰ä¸œè¥¿éƒ½å­˜å‚¨èµ·æ¥ï¼Œç„¶åå·¥ä½œåŒºæ‰€æœ‰æ–‡ä»¶æ¢å¤åˆ°ä¿®æ”¹ä¹‹å‰çš„çŠ¶æ€(å¹¶ä¸æ˜¯æœ€æ–°çŠ¶æ€ï¼Œä¸ä¼šå’Œä»“åº“ä¸­è¿›è¡Œè‡ªåŠ¨åŒæ­¥ï¼Œéœ€è¦ä½ è‡ªå·±å»pull)ï¼Œç„¶åä½ å°±å¯ä»¥ç»§ç»­å®Œæˆä»»åŠ¡äº†ã€‚(<font color="red">åœ¨æ‰§è¡Œgit stashä¹‹å‰éœ€è¦å…ˆæ‰§è¡Œgit addå‘½ä»¤</font>)</p><p>stashå¯ä»¥è¿›è¡Œå¤šæ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œéƒ½ä¼šå°†å½“å‰å·¥ä½œåŒºçš„æ–‡ä»¶æƒ…å†µæš‚å­˜èµ·æ¥ï¼Œstashæ˜¯ç±»æ ˆå­˜å‚¨ï¼Œæ¯æ¬¡stashçš„åºå·éƒ½ä¸º0ï¼Œæ­¤æ¬¡ä¹‹å‰stashçš„åºå·ä¼šè‡ªåŠ¨+1</p></li></ol><h3 id="ä½¿ç”¨git-stash-popå–å‡º"><a class="markdownIt-Anchor" href="#ä½¿ç”¨git-stash-popå–å‡º"></a> ä½¿ç”¨git stash popå–å‡º</h3><ol><li><code>git stash pop</code>å–å‡ºæ ˆé¡¶å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯åºå·ä¸º0çš„é‚£ä¸ªï¼Œå³æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œ<code>git stash</code>ä¿å­˜çš„å†…å®¹ã€‚popä¹‹åï¼Œæš‚å­˜åˆ—è¡¨ä¸­å°±ä¼šè‡ªåŠ¨å°†å…¶æ¸…é™¤æ‰ï¼Œè¿™ä¸ªæ—¶å€™ä½ å†æ‰§è¡Œ<code>git stash list</code>ä¼šå‘ç°æ¯›éƒ½æ²¡æœ‰</li><li>è¿™ä¸ªæ—¶å€™å¯èƒ½å°±ä¼šçº³é—·äº†ï¼Œæˆ‘ä¿å­˜äº†å¥½å‡ æ¬¡ï¼Œä½†æ˜¯æˆ‘è¿™æ¬¡æ˜¯æƒ³ä½¿ç”¨æœ€å¼€å§‹stashçš„é‚£ä»½å†…å®¹ï¼Œæ€ä¹ˆåŠï¼Ÿä¸€ç›´popï¼Œç›´åˆ°æœ€åä¸€æ¬¡ï¼Ÿå½“ç„¶ä¸è¡Œï¼Œä¸Šé¢åˆšè®²è¿‡popä¹‹åæš‚å­˜åˆ—è¡¨ä¸­å°±æ²¡æœ‰stashçš„ä¿¡æ¯äº†ï¼Œå·²ç»è¢«popå‡ºå»çš„å°±æ‰¾ä¸å›æ¥äº†ï¼Œç­‰äºæ˜¯è‡ªæ€å¼æ”»å‡»ï¼Œé‚£å’‹æ•´å‘¢ï¼Ÿ</li><li><code>git stash apply stash@{åºå·}</code>å¯ä»¥å°†æŒ‡å®šåºå·çš„stashå†…å®¹å¼¹å‡ºåˆ°å·¥ä½œåŒºï¼Œæ­¤æ—¶å·¥ä½œåŒºé‡Œæ–‡ä»¶çš„çŠ¶æ€å°±å’Œ<code>stash@{åºå·}</code>é‡Œçš„ä¸€è‡´äº†ï¼Œä½†æ˜¯è¿™ä¸ªå‘½ä»¤<strong>æ— æ³•å°†stashè®°å½•ä»æš‚å­˜åˆ—è¡¨ä¸­åˆ é™¤ï¼Œä»…ä»…åªæ˜¯å°†æ–‡ä»¶æ¢å¤è€Œå·²</strong></li><li><code>git stash drop stash@{åºå·}</code>æ¥ä¸¢å¼ƒæš‚å­˜åˆ—è¡¨ä¸­çš„è®°å½•ï¼Œå¯ä»¥é…åˆapplyä½¿ç”¨</li></ol><h3 id="æŸ¥çœ‹æš‚å­˜è®°å½•ä¸­çš„ä¿¡æ¯"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹æš‚å­˜è®°å½•ä¸­çš„ä¿¡æ¯"></a> æŸ¥çœ‹æš‚å­˜è®°å½•ä¸­çš„ä¿¡æ¯</h3><ol><li>æŸ¥çœ‹æš‚å­˜åˆ—è¡¨ï¼š<code>git stash list</code>æŸ¥çœ‹å½“å‰stashçš„åˆ—è¡¨</li><li>æŸ¥çœ‹æš‚å­˜å†…å®¹ï¼š<code>git stash show stash@{åºå·}</code>æŸ¥çœ‹æŒ‡å®šåºå·çš„stashçš„å†…å®¹</li></ol><h3 id="git-stash-save-msg"><a class="markdownIt-Anchor" href="#git-stash-save-msg"></a> git stash save â€˜msgâ€™</h3><p>ç­‰äºæ˜¯åœ¨stashçš„æ—¶å€™æ‰“äº†ä¸ªæ ‡ç­¾ï¼Œå¦–å¨†ï¼ï¼ï¼ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;åˆ›å»ºä»“åº“&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#åˆ›å»ºä»“åº“&quot;&gt;&lt;/a&gt; åˆ›å»ºä»“åº“&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;git init&lt;/li&gt;
&lt;li&gt;echo 123 &amp;gt; test.txt&lt;/li&gt;
&lt;li&gt;git add .&lt;
      
    
    </summary>
    
    
      <category term="Git" scheme="http://luxiaowan.github.io/categories/Git/"/>
    
    
  </entry>
  
  <entry>
    <title>Hashç´¢å¼•ç›¸å…³</title>
    <link href="http://luxiaowan.github.io/2019/10/12/Hash%E7%B4%A2%E5%BC%95%E7%9B%B8%E5%85%B3/"/>
    <id>http://luxiaowan.github.io/2019/10/12/Hashç´¢å¼•ç›¸å…³/</id>
    <published>2019-10-12T15:42:43.000Z</published>
    <updated>2019-10-21T15:48:05.043Z</updated>
    
    <content type="html"><![CDATA[<p>hashç´¢å¼•ç»“æ„ä½¿ç”¨æ–¹å¼è¾ƒä¸ºå±€é™ï¼Œä»…é€‚ç”¨äº=ã€INå’Œ&lt;=&gt;ä¸‰ç§ï¼Œä½†æ˜¯ç”±äºé€šè¿‡hashå¯ä»¥ç›´æ¥æŸ¥æ‰¾åˆ°å…·ä½“çš„å€¼ï¼Œè€Œä¸ç”¨åƒBTé‚£æ ·æ¯æ¬¡éƒ½ä»rootèŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ‰€ä»¥åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œhashçš„æŸ¥æ‰¾æ•ˆç‡è¦æ¯”BTé«˜ã€‚</p><p>hashçš„ç¼ºé™·ï¼š</p><h6 id="1-hashä¸èƒ½è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾"><a class="markdownIt-Anchor" href="#1-hashä¸èƒ½è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾"></a> 1. hashä¸èƒ½è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾</h6><p>å€¼åœ¨è®¡ç®—hashåï¼Œå¹¶ä¸èƒ½ä¿è¯è®¡ç®—åçš„hashå€¼å’Œè®¡ç®—å‰çš„å¤§å°æ’åˆ—ä¸€æ ·ï¼Œæ‰€ä»¥hashä¸é€‚ç”¨äºèŒƒå›´æŸ¥æ‰¾</p><h6 id="2-hashä¸èƒ½è¿›è¡Œæ’åºæŸ¥è¯¢"><a class="markdownIt-Anchor" href="#2-hashä¸èƒ½è¿›è¡Œæ’åºæŸ¥è¯¢"></a> 2. hashä¸èƒ½è¿›è¡Œæ’åºæŸ¥è¯¢</h6><p>å€¼è®¡ç®—åçš„hashå€¼æ— æ³•ä¿è¯ä¸åŸå€¼å¤§å°é¡ºåºä¸€æ ·ï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œæ’åº</p><h6 id="3-ç»„åˆç´¢å¼•ä¸èƒ½ä½¿ç”¨éƒ¨åˆ†å­—æ®µæŸ¥è¯¢"><a class="markdownIt-Anchor" href="#3-ç»„åˆç´¢å¼•ä¸èƒ½ä½¿ç”¨éƒ¨åˆ†å­—æ®µæŸ¥è¯¢"></a> 3. ç»„åˆç´¢å¼•ä¸èƒ½ä½¿ç”¨éƒ¨åˆ†å­—æ®µæŸ¥è¯¢</h6><p>ç»„åˆç´¢å¼•çš„hashå€¼æ˜¯æ‰€æœ‰ç´¢å¼•å­—æ®µçš„å€¼ç»„åˆåœ¨ä¸€èµ·è¿›è¡Œè®¡ç®—çš„ï¼Œè‹¥ä»…ä½¿ç”¨éƒ¨åˆ†å­—æ®µè¿›è¡ŒæŸ¥è¯¢çš„è¯ï¼Œè®¡ç®—å‡ºçš„hashå€¼åŸºæœ¬ä¸ä¼šä¸ç´¢å¼•çš„hashå€¼ç›¸åŒ</p><h6 id="4-hashåœ¨å‡ºç°å¤§é‡å€¼ç¢°æ’çš„æ—¶å€™æ€§èƒ½ä¼šé™ä½"><a class="markdownIt-Anchor" href="#4-hashåœ¨å‡ºç°å¤§é‡å€¼ç¢°æ’çš„æ—¶å€™æ€§èƒ½ä¼šé™ä½"></a> 4. hashåœ¨å‡ºç°å¤§é‡å€¼ç¢°æ’çš„æ—¶å€™ï¼Œæ€§èƒ½ä¼šé™ä½</h6><p>hashå‡ºç°å¤§é‡çš„å€¼ç›¸ç­‰çš„æ—¶å€™ï¼Œéœ€è¦è¿›è¡Œè¡¨æ‰«æä»¥è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œæ•ˆç‡è¾ƒä½</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;hashç´¢å¼•ç»“æ„ä½¿ç”¨æ–¹å¼è¾ƒä¸ºå±€é™ï¼Œä»…é€‚ç”¨äº=ã€INå’Œ&amp;lt;=&amp;gt;ä¸‰ç§ï¼Œä½†æ˜¯ç”±äºé€šè¿‡hashå¯ä»¥ç›´æ¥æŸ¥æ‰¾åˆ°å…·ä½“çš„å€¼ï¼Œè€Œä¸ç”¨åƒBTé‚£æ ·æ¯æ¬¡éƒ½ä»rootèŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ‰€ä»¥åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œhashçš„æŸ¥æ‰¾æ•ˆç‡è¦æ¯”BTé«˜ã€‚&lt;/p&gt;
&lt;p&gt;hashçš„ç¼ºé™·ï¼š&lt;/p&gt;
&lt;h6 id=&quot;1
      
    
    </summary>
    
    
      <category term="Java" scheme="http://luxiaowan.github.io/categories/Java/"/>
    
    
      <category term="JavaåŸºç¡€çŸ¥è¯†" scheme="http://luxiaowan.github.io/tags/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>Charå’Œvarcharç®€å•ä»‹ç»</title>
    <link href="http://luxiaowan.github.io/2019/10/12/char%E4%B8%8Evarchar%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/"/>
    <id>http://luxiaowan.github.io/2019/10/12/charä¸varcharç®€å•ä»‹ç»/</id>
    <published>2019-10-12T04:10:43.000Z</published>
    <updated>2019-10-21T16:19:50.476Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æ•°æ®é•¿åº¦"><a class="markdownIt-Anchor" href="#1-æ•°æ®é•¿åº¦"></a> 1. æ•°æ®é•¿åº¦</h2><h3 id="1-charæœ€å¤§é•¿åº¦255ä¸ªå­—èŠ‚"><a class="markdownIt-Anchor" href="#1-charæœ€å¤§é•¿åº¦255ä¸ªå­—èŠ‚"></a> 1) char(<code>æœ€å¤§é•¿åº¦255ä¸ªå­—èŠ‚</code>)</h3><p>é•¿åº¦å›ºå®šï¼ˆå­—æ®µå­˜å…¥æ•°æ®é•¿åº¦å§‹ç»ˆç­‰äºå­—æ®µé•¿åº¦ï¼‰</p><h3 id="2-varcharæœ€å¤§é•¿åº¦65535ä¸ªå­—èŠ‚"><a class="markdownIt-Anchor" href="#2-varcharæœ€å¤§é•¿åº¦65535ä¸ªå­—èŠ‚"></a> 2) varchar(<code>æœ€å¤§é•¿åº¦65535ä¸ªå­—èŠ‚</code>)</h3><p>å¯å˜é•¿åº¦ï¼Œå­˜å…¥æ•°æ®é•¿åº¦ä¸ºNä¸ªå­—èŠ‚ï¼Œåˆ™å®é™…ä½¿ç”¨äº†N+1(255ä»¥ä¸Šé•¿åº¦åˆ™+2)ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œå¤šå‡ºæ¥çš„1å­—èŠ‚æ˜¯ç”¨æ¥å­˜å‚¨æ•°æ®å®é™…é•¿åº¦ã€‚</p><ul><li>å­˜å…¥æ•°æ®å¯¹æ¯”<ul><li>å­˜å…¥<code>&quot;ab&quot;</code><ul><li>charæŸ¥è¯¢å‡º<code>&quot;ab&quot;</code></li><li>varcharæŸ¥è¯¢å‡º<code>&quot;ab&quot;</code></li></ul></li><li>å­˜å…¥<code>&quot;ab &quot;</code>ï¼Œ<code>ab</code>åé¢æœ‰ä¸¤ä¸ªç©ºæ ¼ï¼Œ<ul><li>charæŸ¥è¯¢å‡º<code>&quot;ab&quot;</code></li><li>varcharæŸ¥è¯¢å‡º<code>&quot;ab &quot;</code></li></ul></li></ul></li></ul><hr><blockquote><p>è§£æï¼š</p></blockquote><p>â€‹åœ¨å…¥åº“æ—¶ï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨åœ¨abåé¢æ·»åŠ ä¸¤ä½ç©ºæ ¼ï¼Œè®©å…¥åº“çš„æ•°æ®é•¿åº¦ä¿è¯ç­‰äº4 <em><code>char(4)</code></em> ï¼Œè¿™ç§æ“ä½œå¾ˆå®¹æ˜“ç†è§£ï¼Œä½†æ˜¯å¦‚æœä½ å»æ•°æ®è¡¨é‡Œé¢å»æŸ¥è¿™æ¡æ•°æ®ï¼Œä¼šå‘ç°è¡¨ä¸­æ•°æ®å¹¶æ²¡æœ‰ç©ºæ ¼ï¼Œæ‰€ä»¥å¯ä»¥æ¨æ–­å‡ºè¿™é‡Œæ˜¯é€»è¾‘è¿½åŠ ï¼Œæ‰€ä»¥åœ¨æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ä¼šå¹¶ä¸ä¼šå‡ºç°å¼•æ“è‡ªåŠ¨æ·»åŠ çš„ç©ºæ ¼ã€‚</p><hr><h2 id="2-å®æ“æŠ€æœ¯ä¸€å®šè¦font-colorredå®æ“font"><a class="markdownIt-Anchor" href="#2-å®æ“æŠ€æœ¯ä¸€å®šè¦font-colorredå®æ“font"></a> 2. å®æ“(æŠ€æœ¯ä¸€å®šè¦**<font color="red">å®æ“</font>**)</h2><h4 id="1æ— ç©ºæ ¼æ•°æ®"><a class="markdownIt-Anchor" href="#1æ— ç©ºæ ¼æ•°æ®"></a> 1ï¼‰æ— ç©ºæ ¼æ•°æ®</h4><blockquote><p>å…ˆåˆ›å»ºä¸€å¼ è¡¨</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table cv(c char(4), v varchar(4));</span><br></pre></td></tr></table></figure><blockquote><p>æ’å…¥æ•°æ®</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into cv values(&quot;ab&quot;, &quot;ab&quot;);</span><br></pre></td></tr></table></figure><blockquote><p>æŸ¥è¯¢æ•°æ®</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select concat(&apos;(&apos;, c, &apos;)&apos;) AS c, concat(&apos;(&apos;, v, &apos;)&apos;) AS v from cv;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src="/images/image-20191012152503483.png" alt="image-20191012152503483"></p><blockquote><blockquote><p>ç»“æœä¸­charå’Œvarcharå‡æŸ¥å‡ºæ¥ä¸ºæ— ç©ºæ ¼çš„ab</p></blockquote></blockquote><p>####2ï¼‰æœ‰ç©ºæ ¼æ•°æ®</p><blockquote><p>æ’å…¥æ•°æ®</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into cv values(&quot;ab  &quot;, &quot;ab  &quot;);</span><br></pre></td></tr></table></figure><blockquote><p>æŸ¥è¯¢æ•°æ®</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select concat(&apos;(&apos;, c, &apos;)&apos;) AS c, concat(&apos;(&apos;, v, &apos;)&apos;) AS v from cv;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src="/images/image-20191012152809508.png" alt="image-20191012152809508"></p><blockquote><blockquote><p>ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œcharç±»å‹å°†æ•°æ®åé¢çš„ç©ºæ ¼è‡ªåŠ¨å»æ‰äº†ï¼Œvarcharåˆ™ä¿ç•™äº†æ‰€æœ‰çš„ç©ºæ ¼</p></blockquote></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-æ•°æ®é•¿åº¦&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-æ•°æ®é•¿åº¦&quot;&gt;&lt;/a&gt; 1. æ•°æ®é•¿åº¦&lt;/h2&gt;
&lt;h3 id=&quot;1-charæœ€å¤§é•¿åº¦255ä¸ªå­—èŠ‚&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#
      
    
    </summary>
    
    
      <category term="MySQL" scheme="http://luxiaowan.github.io/categories/MySQL/"/>
    
    
  </entry>
  
  <entry>
    <title>MySQLä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</title>
    <link href="http://luxiaowan.github.io/2019/10/11/MySQL%E4%BD%BF%E7%94%A8%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%AD%98/"/>
    <id>http://luxiaowan.github.io/2019/10/11/MySQLä½¿ç”¨æŸ¥è¯¢ç¼“å­˜/</id>
    <published>2019-10-11T05:01:23.000Z</published>
    <updated>2019-10-21T15:48:59.282Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>æŸ¥è¯¢æœåŠ¡æ˜¯å¦å·²å¼€å¯ç¼“å­˜</p><blockquote><p>æ‰§è¡Œ<code>show variables like '%query_cache%';</code>æŸ¥çœ‹ç¼“å­˜çŠ¶æ€</p></blockquote><blockquote><blockquote><p><img src="/images/image-20191011131957961.png" alt="image-20191011131957961"></p></blockquote></blockquote><p>Variable_name: query_cache_typeä¸ºç¼“å­˜çŠ¶æ€ï¼ŒONè¡¨ç¤ºå¼€å¯ï¼ŒOFFè¡¨ç¤ºå…³é—­</p></li><li><p>å¼€å¯/å…³é—­ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</p><blockquote><p>ä¿®æ”¹my.cnfæ–‡ä»¶è¿›è¡Œå¼€å¯å’Œå…³é—­</p></blockquote><p>[mysqld]ä¸­æ·»åŠ /ä¿®æ”¹ï¼š<br>query_cache_size = 20M<br>query_cache_type = ON/OFF</p><blockquote><p>**ä¿®æ”¹å®Œæˆåé‡å¯MySQLæœåŠ¡ï¼š<code>service mysql restart/systemctl mysql restart</code> **</p></blockquote></li><li><p>æŸ¥è¯¢ç¼“å­˜ä½¿ç”¨æƒ…å†µ</p><blockquote><p>æ‰§è¡Œ<code>show status like 'qcache%';</code>æŸ¥è¯¢ç¼“å­˜ä½¿ç”¨æƒ…å†µ</p><blockquote><p><img src="/images/image-20191011132634921.png" alt="image-20191011132634921"></p></blockquote></blockquote><p>å› ä¸ºæœ¬æœºMySQLæœªå¼€å¯æŸ¥è¯¢ç¼“å­˜ï¼Œæ‰€ä»¥æ­¤å¤„å’Œä½¿ç”¨ç›¸å…³çš„å±æ€§å‡ä¸º0</p><hr><p><em><strong>å±æ€§è§£é‡Š:</strong></em></p><table><thead><tr><th>å±æ€§</th><th>é‡Šä¹‰</th></tr></thead><tbody><tr><td>Qcache_free_blocks</td><td>ç¼“å­˜ä¸­ç›¸é‚»å†…å­˜å—çš„ä¸ªæ•°ã€‚æ•°ç›®å¤§è¯´æ˜å¯èƒ½æœ‰ç¢ç‰‡ã€‚FLUSH QUERY CACHEä¼šå¯¹ç¼“å­˜ä¸­çš„ç¢ç‰‡è¿›è¡Œæ•´ç†ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªç©ºé—²å—ã€‚</td></tr><tr><td>Qcache_free_memory</td><td>ç¼“å­˜ä¸­ç©ºé—²å†…å­˜å¤§å°</td></tr><tr><td>Qcache_hits</td><td>ç¼“å­˜å‘½ä¸­æ¬¡æ•°ï¼Œå‘½ä¸­ä¸€æ¬¡å°±+1</td></tr><tr><td>Qcache_inserts</td><td>æŸ¥è¯¢æ¬¡æ•°ï¼Œå‘½ä¸­æ¬¡æ•°/æŸ¥è¯¢æ¬¡æ•°=ç¼“å­˜å‘½ä¸­ç‡</td></tr><tr><td>Qcache_lowmem_prunes</td><td>ç¼“å­˜å‡ºç°å†…å­˜ä¸è¶³å¹¶ä¸”å¿…é¡»è¦è¿›è¡Œæ¸…ç†ä»¥ä¾¿ä¸ºæ›´å¤šæŸ¥è¯¢æä¾›ç©ºé—´çš„æ¬¡æ•°ï¼Œå¦‚æœæ•°å­—ä¸æ–­å¢é•¿ï¼Œå°±å¯èƒ½ç¢ç‰‡éå¸¸ä¸¥é‡ï¼Œæˆ–è€…å†…å­˜å¾ˆå°‘ï¼Œé€šè¿‡Qcache_free_blocksã€Qcache_free_memoryæ¥åˆ†æå…·ä½“æƒ…å†µ</td></tr><tr><td>Qcache_not_cached</td><td>ä¸é€‚åˆè¿›è¡Œç¼“å­˜çš„æŸ¥è¯¢çš„æ•°é‡</td></tr><tr><td>Qcache_queries_in_cache</td><td>å½“å‰ç¼“å­˜çš„æŸ¥è¯¢(å’Œå“åº”)çš„æ•°é‡</td></tr><tr><td>Qcache_total_blocks</td><td>ç¼“å­˜ä¸­å—çš„æ•°é‡</td></tr></tbody></table></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥è¯¢æœåŠ¡æ˜¯å¦å·²å¼€å¯ç¼“å­˜&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ‰§è¡Œ&lt;code&gt;show variables like &#39;%query_cache%&#39;;&lt;/code&gt;æŸ¥çœ‹ç¼“å­˜çŠ¶æ€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;block
      
    
    </summary>
    
    
      <category term="MySQL" scheme="http://luxiaowan.github.io/categories/MySQL/"/>
    
    
  </entry>
  
  <entry>
    <title>JavaåŸºç¡€é¢è¯•é¢˜</title>
    <link href="http://luxiaowan.github.io/2019/10/10/%E8%9A%82%E8%9A%81Java%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <id>http://luxiaowan.github.io/2019/10/10/èš‚èšJavaåŸºç¡€é¢è¯•é¢˜/</id>
    <published>2019-10-10T15:21:56.000Z</published>
    <updated>2019-10-21T15:49:27.313Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€"><a class="markdownIt-Anchor" href="#ä¸€"></a> ä¸€</h3><ol start="2"><li><p>mapæ€ä¹ˆå®ç°hashcodeå’Œequals,ä¸ºä»€ä¹ˆé‡å†™equalså¿…é¡»é‡å†™hashcode</p></li><li><p>ä½¿ç”¨è¿‡concurrentåŒ…ä¸‹çš„å“ªäº›ç±»ï¼Œä½¿ç”¨åœºæ™¯ç­‰ç­‰ã€‚</p></li><li><p>concurrentHashMapæ€ä¹ˆå®ç°ï¼Ÿconcurrenthashmapåœ¨1.8å’Œ1.7é‡Œé¢æœ‰ä»€ä¹ˆåŒºåˆ«</p></li><li><p>CountDownLatchã€LinkedHashMapã€AQSå®ç°åŸç†</p></li><li><p>çº¿ç¨‹æ± æœ‰å“ªäº›RejectedExecutionHandler,åˆ†åˆ«å¯¹åº”çš„ä½¿ç”¨åœºæ™¯</p></li><li><p>å¤šçº¿ç¨‹çš„é”ï¼Ÿæ€ä¹ˆä¼˜åŒ–çš„ï¼Ÿåå‘é”ã€è½»é‡çº§é”ã€é‡é‡çº§é”ï¼Ÿ</p></li><li><p>ç»„åˆç´¢å¼•ï¼ŸB+æ ‘å¦‚ä½•å­˜å‚¨çš„ï¼Ÿ</p></li><li><p>ä¸ºä»€ä¹ˆç¼“å­˜æ›´æ–°ç­–ç•¥æ˜¯å…ˆæ›´æ–°æ•°æ®åº“ååˆ é™¤ç¼“å­˜</p></li><li><p>OOMè¯´ä¸€ä¸‹ï¼Ÿæ€ä¹ˆæ’æŸ¥ï¼Ÿå“ªäº›ä¼šå¯¼è‡´OOM?</p></li><li><p><code>OSIä¸ƒå±‚ç»“æ„</code>ï¼Œæ¯å±‚ç»“æ„éƒ½æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ</p></li><li><p>javaçš„çº¿ç¨‹å®‰å…¨queueéœ€è¦æ³¨æ„çš„ç‚¹</p></li><li><p>æ­»é”çš„åŸå› ï¼Œå¦‚ä½•é¿å…</p></li></ol><h3 id="äºŒ"><a class="markdownIt-Anchor" href="#äºŒ"></a> äºŒ</h3><ol><li><p>jvmè™šæ‹Ÿæœºè€å¹´ä»£ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‘ç”Ÿgcï¼Œç»™ä½ ä¸€ä¸ªåœºæ™¯ï¼Œä¸€å°4æ ¸8Gçš„æœåŠ¡å™¨ï¼Œæ¯éš”ä¸¤ä¸ªå°æ—¶å°±è¦å‡ºç°ä¸€æ¬¡è€å¹´ä»£gcï¼Œç°åœ¨æœ‰æ—¥å¿—ï¼Œæ€ä¹ˆåˆ†ææ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜</p></li><li><p>æ•°æ®åº“ç´¢å¼•æœ‰å“ªäº›ï¼Ÿåº•å±‚æ€ä¹ˆå®ç°çš„ï¼Ÿæ•°æ®åº“æ€ä¹ˆä¼˜åŒ–ï¼Ÿ</p></li><li><p>æ•°æ®åº“çš„äº‹åŠ¡ï¼Œå››ä¸ªæ€§è´¨è¯´ä¸€ä¸‹ï¼Œåˆ†åˆ«æœ‰ä»€ä¹ˆç”¨ï¼Œæ€ä¹ˆå®ç°çš„ï¼Ÿ</p></li><li><p>æœåŠ¡å™¨å¦‚ä½•è´Ÿè½½å‡è¡¡ï¼Œæœ‰å“ªäº›ç®—æ³•ï¼Œå“ªä¸ªæ¯”è¾ƒå¥½ï¼Œä¸€è‡´æ€§å“ˆå¸ŒåŸç†ï¼Œæ€ä¹ˆé¿å…DDOSæ”»å‡»è¯·æ±‚æ‰“åˆ°å°‘æ•°æœºå™¨</p></li><li><p>volatileè®²è®²</p></li><li><p>å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿè£…é¥°å™¨ã€ä»£ç†è®²è®²ï¼Ÿ</p></li><li><p>redisé›†ç¾¤ä¼šå—ï¼Ÿ</p></li><li><p>mysqlå­˜å‚¨å¼•æ“</p></li><li><p>äº‹åŠ¡éš”ç¦»çº§åˆ«</p></li><li><p>ä¸å¯é‡å¤åº¦å’Œå¹»è¯»ï¼Œæ€ä¹ˆé¿å…ï¼Œåº•å±‚æ€ä¹ˆå®ç°ï¼ˆè¡Œé”è¡¨é”ï¼‰</p></li></ol><h3 id="ä¸‰"><a class="markdownIt-Anchor" href="#ä¸‰"></a> ä¸‰</h3><ol><li><p>é¡¹ç›®ä»‹ç»</p></li><li><p>åˆ†å¸ƒå¼é”æ˜¯æ€ä¹ˆå®ç°çš„</p></li><li><p>MySQLæœ‰å“ªå‡ ç§joinæ–¹å¼ï¼Œåº•å±‚åŸç†æ˜¯ä»€ä¹ˆ</p></li><li><p>Redisæœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿåº•å±‚çš„ç¼–ç æœ‰å“ªäº›ï¼Ÿæœ‰åºé“¾è¡¨é‡‡ç”¨äº†å“ªäº›ä¸åŒçš„ç¼–ç ï¼Ÿ</p></li><li><p>Redisæ‰©å®¹ï¼Œå¤±æ•ˆkeyæ¸…ç†ç­–ç•¥</p></li><li><p>Redisçš„æŒä¹…åŒ–æ€ä¹ˆåšï¼Œaofå’Œrdbï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ã€‚</p></li><li><p>MySQLæ•°æ®åº“æ€ä¹ˆå®ç°åˆ†åº“åˆ†è¡¨ï¼Œä»¥åŠæ•°æ®åŒæ­¥ï¼Ÿ</p></li><li><p>å•ç‚¹ç™»å½•å¦‚ä½•æ˜¯å®ç°ï¼Ÿ</p></li><li><p>è°ˆè°ˆSpringBootå’ŒSpringCloudçš„ç†è§£</p></li><li><p>æœªæ¥çš„æŠ€æœ¯èŒä¸šæ€ä¹ˆè§„åˆ’ï¼Ÿ</p></li><li><p>ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬å…¬å¸ï¼Ÿ</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ä¸€&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ä¸€&quot;&gt;&lt;/a&gt; ä¸€&lt;/h3&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;
&lt;p&gt;mapæ€ä¹ˆå®ç°hashcodeå’Œequals,ä¸ºä»€ä¹ˆé‡å†™equalså¿…é¡»é‡å†™hashcode&lt;/p&gt;
&lt;/li
      
    
    </summary>
    
    
      <category term="Java" scheme="http://luxiaowan.github.io/categories/Java/"/>
    
    
      <category term="é¢è¯•" scheme="http://luxiaowan.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="é˜¿é‡Œ" scheme="http://luxiaowan.github.io/tags/%E9%98%BF%E9%87%8C/"/>
    
  </entry>
  
</feed>
